import{r,a6 as e,h}from"./vendor-DrKzkH4x.js";import{d as E,a as P,u as z,t as M}from"./index-CCWWoMiH.js";import{a as H}from"./router-CNLU_KyZ.js";import{al as L,a4 as O,ay as T,R,y as G,au as U,ak as $,a3 as W,o as q,az as V,v as K,M as X}from"./icons-BtUkkwGS.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";import"./state-72d44OIA.js";const J="_teamPage_we559_1",Q="_fadeIn_we559_1",Y="_backButton_we559_5",Z="_header_we559_35",ee="_headerLeft_we559_42",se="_headerActions_we559_54",ae="_primaryBtn_we559_59",ne="_secondaryBtn_we559_73",te="_section_we559_87",oe="_sectionHeader_we559_91",re="_count_we559_104",ie="_membersGrid_we559_110",le="_memberCard_we559_116",ce="_memberAvatar_we559_131",de="_memberInfo_we559_144",me="_roleBadge_we559_162",_e="_owner_we559_170",ue="_admin_we559_175",pe="_attorney_we559_180",he="_paralegal_we559_185",xe="_staff_we559_190",je="_menuWrapper_we559_195",ve="_menuBtn_we559_199",we="_dropdown_we559_213",fe="_dropdownFadeIn_we559_1",ge="_dropdownItem_we559_238",Ne="_danger_we559_258",be="_dropdownDivider_we559_266",ye="_groupsGrid_we559_273",Ce="_groupCard_we559_279",Be="_groupHeader_we559_287",ke="_groupColor_we559_294",Se="_groupDesc_we559_306",Ie="_groupMeta_we559_312",Me="_memberCount_we559_320",Ge="_permCount_we559_321",Ae="_groupActions_we559_329",Fe="_deleteBtn_we559_352",De="_modalOverlay_we559_358",Ee="_modal_we559_358",Pe="_modalHeader_we559_378",ze="_closeBtn_we559_393",He="_modalForm_we559_401",Le="_formGroup_we559_408",Oe="_colorPicker_we559_489",Te="_colorOption_we559_494",Re="_selected_we559_503",Ue="_modalActions_we559_508",$e="_cancelBtn_we559_516",We="_saveBtn_we559_526",qe="_loadingState_we559_546",Ve="_emptyState_we559_555",Ke="_errorMessage_we559_580",Xe="_refreshBtn_we559_608",Je="_spinning_we559_633",Qe="_spin_we559_633",Ye="_inactive_we559_643",Ze="_slideUpMobile_we559_1",s={teamPage:J,fadeIn:Q,backButton:Y,header:Z,headerLeft:ee,headerActions:se,primaryBtn:ae,secondaryBtn:ne,section:te,sectionHeader:oe,count:re,membersGrid:ie,memberCard:le,memberAvatar:ce,memberInfo:de,roleBadge:me,owner:_e,admin:ue,attorney:pe,paralegal:he,staff:xe,menuWrapper:je,menuBtn:ve,dropdown:we,dropdownFadeIn:fe,dropdownItem:ge,danger:Ne,dropdownDivider:be,groupsGrid:ye,groupCard:Ce,groupHeader:Be,groupColor:ke,groupDesc:Se,groupMeta:Ie,memberCount:Me,permCount:Ge,groupActions:Ae,deleteBtn:Fe,modalOverlay:De,modal:Ee,modalHeader:Pe,closeBtn:ze,modalForm:He,formGroup:Le,colorPicker:Oe,colorOption:Te,selected:Re,modalActions:Ue,cancelBtn:$e,saveBtn:We,loadingState:qe,emptyState:Ve,errorMessage:Ke,refreshBtn:Xe,spinning:Je,spin:Qe,inactive:Ye,slideUpMobile:Ze};function ds(){const n=H();E();const{groups:i,addGroup:c,updateGroup:d,deleteGroup:t,fetchGroups:l}=P(),{user:m}=z(),[j,o]=r.useState(!1),[F,v]=r.useState(!1),[w,f]=r.useState(null),[g,_]=r.useState(null),N=r.useRef(null),[x,b]=r.useState([]),[y,C]=r.useState(!0),[B,k]=r.useState(null),u=r.useCallback(async()=>{try{C(!0),k(null);const a=await M.getMembers();a.teamMembers?b(a.teamMembers):a.success&&a.data?b(a.data):Array.isArray(a)&&b(a)}catch(a){console.error("Failed to fetch team members:",a),k("Failed to load team members")}finally{C(!1)}},[]);return r.useEffect(()=>{u(),l==null||l()},[u,l]),r.useEffect(()=>{function a(p){N.current&&!N.current.contains(p.target)&&_(null)}return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]),e.jsxs("div",{className:s.teamPage,children:[e.jsxs("button",{className:s.backButton,onClick:()=>n("/app/settings"),children:[e.jsx(L,{size:16}),"Back to Settings"]}),e.jsxs("div",{className:s.header,children:[e.jsxs("div",{className:s.headerLeft,children:[e.jsx("h1",{children:"Team & Groups"}),e.jsx("p",{children:"Manage your firm's team members and groups"})]}),e.jsxs("div",{className:s.headerActions,children:[e.jsxs("button",{className:s.secondaryBtn,onClick:()=>v(!0),children:[e.jsx(O,{size:18}),"New Group"]}),e.jsxs("button",{className:s.primaryBtn,onClick:()=>o(!0),children:[e.jsx(T,{size:18}),"Invite Member"]})]})]}),e.jsxs("section",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx("h2",{children:"Team Members"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsxs("span",{className:s.count,children:[x.length," members"]}),e.jsx("button",{onClick:u,className:s.refreshBtn,disabled:y,title:"Refresh team members",children:e.jsx(R,{size:14,className:y?s.spinning:""})})]})]}),B&&e.jsxs("div",{className:s.errorMessage,children:[B,e.jsx("button",{onClick:u,children:"Try again"})]}),y&&x.length===0?e.jsx("div",{className:s.loadingState,children:"Loading team members..."}):x.length===0?e.jsxs("div",{className:s.emptyState,children:[e.jsx(G,{size:48}),e.jsx("h3",{children:"No team members yet"}),e.jsx("p",{children:"Invite your first team member to get started"})]}):e.jsx("div",{className:s.membersGrid,children:x.map(a=>{var S,I;const p=`${a.firstName||""} ${a.lastName||""}`.trim()||a.email,D=a.firstName&&a.lastName?`${a.firstName[0]}${a.lastName[0]}`:((I=(S=a.email)==null?void 0:S[0])==null?void 0:I.toUpperCase())||"?";return e.jsxs("div",{className:h(s.memberCard,!a.isActive&&s.inactive),children:[e.jsx("div",{className:s.memberAvatar,children:a.avatarUrl?e.jsx("img",{src:a.avatarUrl,alt:p}):D}),e.jsxs("div",{className:s.memberInfo,children:[e.jsx("h3",{children:p}),e.jsx("p",{children:a.email}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center",flexWrap:"wrap"},children:[e.jsx("span",{className:h(s.roleBadge,s[a.role]),children:a.role}),!a.isActive&&e.jsx("span",{className:h(s.roleBadge,s.inactive),children:"Inactive"})]})]}),e.jsxs("div",{className:s.menuWrapper,ref:g===a.id?N:null,children:[e.jsx("button",{className:s.menuBtn,onClick:()=>_(g===a.id?null:a.id),children:e.jsx(U,{size:18})}),g===a.id&&e.jsxs("div",{className:s.dropdown,children:[e.jsxs("button",{className:s.dropdownItem,onClick:()=>{_(null),n(`/app/settings/team/${a.id}`)},children:[e.jsx($,{size:14}),"View Profile"]}),e.jsxs("button",{className:s.dropdownItem,onClick:()=>{_(null),n(`/app/settings/team/${a.id}/permissions`)},children:[e.jsx(W,{size:14}),"Edit Permissions"]}),a.role!=="owner"&&a.id!==(m==null?void 0:m.id)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:s.dropdownDivider}),e.jsxs("button",{className:h(s.dropdownItem,s.danger),onClick:async()=>{if(confirm(`Are you sure you want to remove ${p} from the team?`))try{await M.removeMember(a.id),u(),_(null)}catch{alert("Failed to remove team member")}},children:[e.jsx(q,{size:14}),"Remove from Team"]})]})]})]})]},a.id)})})]}),e.jsxs("section",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx("h2",{children:"Groups"}),e.jsxs("span",{className:s.count,children:[i.length," groups"]})]}),e.jsx("div",{className:s.groupsGrid,children:i.map(a=>e.jsxs("div",{className:s.groupCard,style:{borderLeftColor:a.color},children:[e.jsxs("div",{className:s.groupHeader,children:[e.jsx("div",{className:s.groupColor,style:{background:a.color}}),e.jsx("h3",{children:a.name})]}),e.jsx("p",{className:s.groupDesc,children:a.description}),e.jsxs("div",{className:s.groupMeta,children:[e.jsxs("span",{className:s.memberCount,children:[e.jsx(G,{size:14}),a.memberIds.length," members"]}),e.jsxs("span",{className:s.permCount,children:[a.permissions.length," permissions"]})]}),e.jsxs("div",{className:s.groupActions,children:[e.jsxs("button",{onClick:()=>f(a),children:[e.jsx(V,{size:14})," Edit"]}),e.jsx("button",{className:s.deleteBtn,onClick:()=>{confirm(`Are you sure you want to delete the group "${a.name}"?`)&&t(a.id)},children:e.jsx(K,{size:14})})]})]},a.id))})]}),j&&e.jsx(es,{onClose:()=>o(!1)}),F&&e.jsx(A,{onClose:()=>v(!1),onSave:a=>{c(a),v(!1)}}),w&&e.jsx(A,{group:w,onClose:()=>f(null),onSave:a=>{d(w.id,a),f(null)}})]})}function es({onClose:n}){const[i,c]=r.useState({email:"",role:"attorney",groups:[]}),d=t=>{t.preventDefault(),n()};return e.jsx("div",{className:s.modalOverlay,onClick:n,children:e.jsxs("div",{className:s.modal,onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:s.modalHeader,children:[e.jsx("h2",{children:"Invite Team Member"}),e.jsx("button",{onClick:n,className:s.closeBtn,children:"×"})]}),e.jsxs("form",{onSubmit:d,className:s.modalForm,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Email Address"}),e.jsx("input",{type:"email",value:i.email,onChange:t=>c({...i,email:t.target.value}),placeholder:"colleague@lawfirm.com",required:!0})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Role"}),e.jsxs("select",{value:i.role,onChange:t=>c({...i,role:t.target.value}),children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"attorney",children:"Attorney"}),e.jsx("option",{value:"paralegal",children:"Paralegal"}),e.jsx("option",{value:"staff",children:"Staff"})]})]}),e.jsxs("div",{className:s.modalActions,children:[e.jsx("button",{type:"button",onClick:n,className:s.cancelBtn,children:"Cancel"}),e.jsxs("button",{type:"submit",className:s.saveBtn,children:[e.jsx(X,{size:16}),"Send Invitation"]})]})]})]})})}function A({group:n,onClose:i,onSave:c}){const d=!!n,[t,l]=r.useState({name:(n==null?void 0:n.name)||"",description:(n==null?void 0:n.description)||"",color:(n==null?void 0:n.color)||"#3B82F6",memberIds:(n==null?void 0:n.memberIds)||[],permissions:(n==null?void 0:n.permissions)||["matters:view","documents:view"]}),m=["#EF4444","#F59E0B","#10B981","#3B82F6","#8B5CF6","#EC4899"],j=o=>{o.preventDefault(),c(t)};return e.jsx("div",{className:s.modalOverlay,onClick:i,children:e.jsxs("div",{className:s.modal,onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{className:s.modalHeader,children:[e.jsx("h2",{children:d?"Edit Group":"Create Group"}),e.jsx("button",{onClick:i,className:s.closeBtn,children:"×"})]}),e.jsxs("form",{onSubmit:j,className:s.modalForm,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Group Name"}),e.jsx("input",{type:"text",value:t.name,onChange:o=>l({...t,name:o.target.value}),placeholder:"e.g., Litigation Team",required:!0})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{value:t.description,onChange:o=>l({...t,description:o.target.value}),placeholder:"Brief description of this group",rows:2})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Color"}),e.jsx("div",{className:s.colorPicker,children:m.map(o=>e.jsx("button",{type:"button",className:h(s.colorOption,t.color===o&&s.selected),style:{background:o},onClick:()=>l({...t,color:o})},o))})]}),e.jsxs("div",{className:s.modalActions,children:[e.jsx("button",{type:"button",onClick:i,className:s.cancelBtn,children:"Cancel"}),e.jsx("button",{type:"submit",className:s.saveBtn,children:d?"Save Changes":"Create Group"})]})]})]})})}export{ds as TeamPage};
