import{r as c,a6 as e}from"./vendor-DrKzkH4x.js";import{i as u}from"./index-CCWWoMiH.js";import{s as n}from"./IntegrationDataPage.module-DQ8gf-9T.js";import{a as B,e as D}from"./router-CNLU_KyZ.js";import{K as p,a7 as o,al as T,R as N,ao as $,E,k as O,a5 as A,j as G,F as R}from"./icons-BtUkkwGS.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";import"./state-72d44OIA.js";const U={onedrive:{name:"OneDrive",icon:o,syncFn:()=>u.syncOneDrive()},"google-drive":{name:"Google Drive",icon:p,syncFn:()=>u.syncGoogleDrive()},dropbox:{name:"Dropbox",icon:p,syncFn:()=>u.syncDropbox()}};function Q(){const w=B(),{provider:h}=D(),r=U[h||"onedrive"],[d,f]=c.useState([]),[z,j]=c.useState(!0),[m,g]=c.useState(!1),[v,F]=c.useState(""),[x,l]=c.useState(null);c.useEffect(()=>{r&&S()},[h]);const S=async()=>{try{j(!0);const s=await r.syncFn();f(s.files||[])}catch(s){l({type:"error",message:s.message||"Failed to load files"})}finally{j(!1)}},b=async()=>{g(!0);try{const s=await r.syncFn();f(s.files||[]),l({type:"success",message:s.message||`${r.name} synced successfully`})}catch(s){l({type:"error",message:s.message||"Sync failed"})}finally{g(!1)}},C=s=>{if(!s)return"";const i=["B","KB","MB","GB"];let a=s,t=0;for(;a>=1024&&t<i.length-1;)a/=1024,t++;return`${a.toFixed(1)} ${i[t]}`},I=s=>{var t;if(s.folder)return"folder";const i=((t=s.name.split(".").pop())==null?void 0:t.toLowerCase())||"",a=s.mimeType||"";return i==="pdf"||a.includes("pdf")?"pdf":["doc","docx"].includes(i)||a.includes("document")||a.includes("word")?"word":["xls","xlsx"].includes(i)||a.includes("spreadsheet")||a.includes("excel")?"excel":["jpg","jpeg","png","gif","webp"].includes(i)||a.includes("image")?"image":["mp4","mov","avi"].includes(i)||a.includes("video")?"video":"other"},L=s=>{switch(s){case"folder":return e.jsx(p,{size:20});case"pdf":return e.jsx(R,{size:20});case"image":return e.jsx(G,{size:20});case"video":return e.jsx(A,{size:20});default:return e.jsx(O,{size:20})}},y=d.filter(s=>{var i;return(i=s.name)==null?void 0:i.toLowerCase().includes(v.toLowerCase())}),k=(r==null?void 0:r.icon)||o;return r?e.jsxs("div",{className:n.container,children:[x&&e.jsxs("div",{className:`${n.notification} ${n[x.type]}`,children:[x.message,e.jsx("button",{onClick:()=>l(null),children:"Ã—"})]}),e.jsxs("div",{className:n.header,children:[e.jsxs("div",{className:n.headerLeft,children:[e.jsx("button",{className:n.backBtn,onClick:()=>w(-1),children:e.jsx(T,{size:20})}),e.jsx("div",{className:n.headerIcon,children:e.jsx(k,{size:28})}),e.jsxs("div",{children:[e.jsx("h1",{children:r.name}),e.jsxs("p",{children:["View and sync files from ",r.name]})]})]}),e.jsx("div",{className:n.headerActions,children:e.jsxs("button",{className:n.syncBtn,onClick:b,disabled:m,children:[e.jsx(N,{size:18,className:m?n.spinning:""}),m?"Syncing...":"Sync to Documents"]})})]}),e.jsxs("div",{className:n.toolbar,children:[e.jsxs("div",{className:n.searchBox,children:[e.jsx($,{size:18}),e.jsx("input",{type:"text",placeholder:"Search files...",value:v,onChange:s=>F(s.target.value)})]}),e.jsxs("div",{className:n.stats,children:[e.jsxs("span",{children:[d.filter(s=>!s.folder).length," files"]}),e.jsxs("span",{children:[d.filter(s=>s.folder).length," folders"]})]})]}),z?e.jsxs("div",{className:n.loading,children:[e.jsx(N,{size:24,className:n.spinning}),e.jsx("span",{children:"Loading files..."})]}):e.jsx("div",{className:n.dataList,children:y.length===0?e.jsxs("div",{className:n.empty,children:[e.jsx(o,{size:48}),e.jsx("h3",{children:"No files found"}),e.jsxs("p",{children:["Your ",r.name," files will appear here"]})]}):y.map(s=>{const i=I(s);return e.jsxs("div",{className:n.fileItem,children:[e.jsx("div",{className:`${n.fileIcon} ${n[i]}`,children:L(i)}),e.jsxs("div",{className:n.fileInfo,children:[e.jsx("span",{className:n.fileName,children:s.name}),e.jsx("span",{className:n.fileSize,children:s.folder?"Folder":C(s.size)})]}),s.webUrl&&e.jsxs("a",{href:s.webUrl,target:"_blank",rel:"noopener noreferrer",className:n.openBtn,children:[e.jsx(E,{size:14}),"Open"]})]},s.id)})})]}):e.jsx("div",{className:n.container,children:e.jsxs("div",{className:n.empty,children:[e.jsx(o,{size:48}),e.jsx("h3",{children:"Unknown provider"}),e.jsx("p",{children:"This cloud storage provider is not supported"})]})})}export{Q as CloudStorageIntegrationPage};
