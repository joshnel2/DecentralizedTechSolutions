import{r as o,a6 as e}from"./vendor-DrKzkH4x.js";import{d as A,a as P,u as I}from"./index-CCWWoMiH.js";import{a as K}from"./router-CNLU_KyZ.js";import{al as w,R as S,as as f,a as M,a3 as u,aj as L,ak as z,am as R,aX as G,v as H}from"./icons-BtUkkwGS.js";import{f as b,p as N}from"./date-utils-BkNAU8cl.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";import"./state-72d44OIA.js";const D="_apiKeysPage_52m78_1",F="_backButton_52m78_6",O="_header_52m78_36",E="_headerLeft_52m78_43",T="_primaryBtn_52m78_55",W="_infoBanner_52m78_76",V="_keysList_52m78_100",U="_keyCard_52m78_106",q="_keyHeader_52m78_113",X="_keyIcon_52m78_120",Y="_keyInfo_52m78_132",J="_keyMeta_52m78_139",Q="_keyValue_52m78_146",Z="_keyActions_52m78_163",$="_copied_52m78_183",ee="_deleteBtn_52m78_187",se="_keyPermissions_52m78_192",ae="_permLabel_52m78_199",te="_permBadge_52m78_204",ne="_emptyState_52m78_214",ie="_modalOverlay_52m78_248",le="_modal_52m78_248",oe="_modalHeader_52m78_268",re="_closeBtn_52m78_283",ce="_modalForm_52m78_291",de="_formGroup_52m78_298",me="_hint_52m78_325",_e="_permissionsGrid_52m78_330",ye="_permissionItem_52m78_336",he="_modalActions_52m78_362",ue="_cancelBtn_52m78_370",pe="_saveBtn_52m78_380",xe="_headerActions_52m78_400",je="_secondaryBtn_52m78_405",ve="_spinning_52m78_429",s={apiKeysPage:D,backButton:F,header:O,headerLeft:E,primaryBtn:T,infoBanner:W,keysList:V,keyCard:U,keyHeader:q,keyIcon:X,keyInfo:Y,keyMeta:J,keyValue:Q,keyActions:Z,copied:$,deleteBtn:ee,keyPermissions:se,permLabel:ae,permBadge:te,emptyState:ne,modalOverlay:ie,modal:le,modalHeader:oe,closeBtn:re,modalForm:ce,formGroup:de,hint:me,permissionsGrid:_e,permissionItem:ye,modalActions:he,cancelBtn:ue,saveBtn:pe,headerActions:xe,secondaryBtn:je,spinning:ve};function Ke(){A();const r=K(),{apiKeys:c,fetchAPIKeys:n,addAPIKey:d,deleteAPIKey:_}=P(),{user:p}=I(),[y,t]=o.useState(!1),[i,h]=o.useState(new Set),[x,j]=o.useState(null),[v,k]=o.useState(!0);o.useEffect(()=>{(async()=>{k(!0),await n(),k(!1)})()},[n]);const g=a=>{h(l=>{const m=new Set(l);return m.has(a)?m.delete(a):m.add(a),m})},B=async(a,l)=>{await navigator.clipboard.writeText(a),j(l),setTimeout(()=>j(null),2e3)},C=a=>a.slice(0,12)+"••••••••••••••••••••";return e.jsxs("div",{className:s.apiKeysPage,children:[e.jsxs("button",{className:s.backButton,onClick:()=>r("/app/settings"),children:[e.jsx(w,{size:16}),"Back to Settings"]}),e.jsxs("div",{className:s.header,children:[e.jsxs("div",{className:s.headerLeft,children:[e.jsx("h1",{children:"API Keys"}),e.jsx("p",{children:"Manage API keys for external integrations"})]}),e.jsxs("div",{className:s.headerActions,children:[e.jsx("button",{className:s.secondaryBtn,onClick:()=>n(),disabled:v,children:e.jsx(S,{size:16,className:v?s.spinning:""})}),e.jsxs("button",{className:s.primaryBtn,onClick:()=>t(!0),children:[e.jsx(f,{size:18}),"Create New Key"]})]})]}),e.jsxs("div",{className:s.infoBanner,children:[e.jsx(M,{size:20}),e.jsxs("div",{children:[e.jsx("strong",{children:"Keep your API keys secure"}),e.jsx("p",{children:"API keys provide full access to your Apex account. Never share them publicly or commit them to version control."})]})]}),e.jsxs("div",{className:s.keysList,children:[c.map(a=>e.jsxs("div",{className:s.keyCard,children:[e.jsxs("div",{className:s.keyHeader,children:[e.jsx("div",{className:s.keyIcon,children:e.jsx(u,{size:20})}),e.jsxs("div",{className:s.keyInfo,children:[e.jsx("h3",{children:a.name}),e.jsxs("div",{className:s.keyMeta,children:[e.jsxs("span",{children:["Created ",b(N(a.createdAt),"MMM d, yyyy")]}),a.lastUsed&&e.jsxs("span",{children:["Last used ",b(N(a.lastUsed),"MMM d, yyyy h:mm a")]})]})]})]}),e.jsxs("div",{className:s.keyValue,children:[e.jsx("code",{children:i.has(a.id)?a.key:C(a.key)}),e.jsxs("div",{className:s.keyActions,children:[e.jsx("button",{onClick:()=>g(a.id),title:i.has(a.id)?"Hide":"Reveal",children:i.has(a.id)?e.jsx(L,{size:16}):e.jsx(z,{size:16})}),e.jsx("button",{onClick:()=>B(a.key,a.id),title:"Copy to clipboard",className:x===a.id?s.copied:"",children:x===a.id?e.jsx(R,{size:16}):e.jsx(G,{size:16})}),e.jsx("button",{onClick:()=>_(a.id),title:"Revoke key",className:s.deleteBtn,children:e.jsx(H,{size:16})})]})]}),e.jsxs("div",{className:s.keyPermissions,children:[e.jsx("span",{className:s.permLabel,children:"Permissions:"}),a.permissions.map(l=>e.jsx("span",{className:s.permBadge,children:l},l))]})]},a.id)),c.length===0&&e.jsxs("div",{className:s.emptyState,children:[e.jsx(u,{size:48}),e.jsx("h3",{children:"No API Keys"}),e.jsx("p",{children:"Create an API key to integrate with external services"}),e.jsxs("button",{onClick:()=>t(!0),children:[e.jsx(f,{size:16}),"Create Your First Key"]})]})]}),y&&e.jsx(ke,{onClose:()=>t(!1),onCreate:async a=>{try{await d(a),t(!1),n()}catch{alert("Failed to create API key")}}})]})}function ke({onClose:r,onCreate:c}){const[n,d]=o.useState({name:"",permissions:["matters:read","clients:read","documents:read"]}),_=[{value:"matters:read",label:"Read Matters"},{value:"matters:write",label:"Write Matters"},{value:"clients:read",label:"Read Clients"},{value:"clients:write",label:"Write Clients"},{value:"documents:read",label:"Read Documents"},{value:"documents:write",label:"Write Documents"},{value:"calendar:read",label:"Read Calendar"},{value:"calendar:write",label:"Write Calendar"},{value:"billing:read",label:"Read Billing"},{value:"billing:write",label:"Write Billing"}],p=t=>{d(i=>({...i,permissions:i.permissions.includes(t)?i.permissions.filter(h=>h!==t):[...i.permissions,t]}))},y=t=>{t.preventDefault(),c(n)};return e.jsx("div",{className:s.modalOverlay,onClick:r,children:e.jsxs("div",{className:s.modal,onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:s.modalHeader,children:[e.jsx("h2",{children:"Create API Key"}),e.jsx("button",{onClick:r,className:s.closeBtn,children:"×"})]}),e.jsxs("form",{onSubmit:y,className:s.modalForm,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Key Name"}),e.jsx("input",{type:"text",value:n.name,onChange:t=>d({...n,name:t.target.value}),placeholder:"e.g., Document Sync Integration",required:!0}),e.jsx("span",{className:s.hint,children:"A descriptive name to identify this key"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Permissions"}),e.jsx("div",{className:s.permissionsGrid,children:_.map(t=>e.jsxs("label",{className:s.permissionItem,children:[e.jsx("input",{type:"checkbox",checked:n.permissions.includes(t.value),onChange:()=>p(t.value)}),e.jsx("span",{children:t.label})]},t.value))})]}),e.jsxs("div",{className:s.modalActions,children:[e.jsx("button",{type:"button",onClick:r,className:s.cancelBtn,children:"Cancel"}),e.jsxs("button",{type:"submit",className:s.saveBtn,children:[e.jsx(u,{size:16}),"Create Key"]})]})]})]})})}export{Ke as APIKeysPage};
