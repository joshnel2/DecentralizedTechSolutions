import{r,a6 as e}from"./vendor-DrKzkH4x.js";import{a as B}from"./router-CNLU_KyZ.js";import{a4 as E,$ as P,A as L,aj as T,ak as $}from"./icons-BtUkkwGS.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";const z="_container_5nonm_1",M="_securityBadge_5nonm_25",O="_loginCard_5nonm_40",U="_header_5nonm_53",G="_lockIcon_5nonm_58",W="_error_5nonm_85",F="_form_5nonm_98",R="_inputGroup_5nonm_104",q="_passwordWrapper_5nonm_141",H="_eyeButton_5nonm_150",J="_submitButton_5nonm_170",K="_spinner_5nonm_199",Q="_footer_5nonm_212",V="_warning_5nonm_226",n={container:z,securityBadge:M,loginCard:O,header:U,lockIcon:G,error:W,form:F,inputGroup:R,passwordWrapper:q,eyeButton:H,submitButton:J,spinner:K,footer:Q,warning:V},o={};function ne(){const[u,y]=r.useState(""),[p,I]=r.useState(""),[h,A]=r.useState(!1),[j,l]=r.useState(""),[d,v]=r.useState(!1),[c,f]=r.useState(!1),[m,g]=r.useState(0),_=B();r.useEffect(()=>{const s=sessionStorage.getItem("_sap_auth");if(s)try{JSON.parse(atob(s)).exp>Date.now()?_("/rx760819/dashboard"):sessionStorage.removeItem("_sap_auth")}catch{sessionStorage.removeItem("_sap_auth")}},[_]),r.useEffect(()=>{if(m>0){const s=setInterval(()=>{g(t=>t<=1?(f(!1),0):t-1)},1e3);return()=>clearInterval(s)}},[m]);const b=()=>{const s=document.createElement("canvas"),t=s.getContext("2d");return t==null||t.fillText("fingerprint",10,10),btoa(navigator.userAgent+screen.width+screen.height+s.toDataURL())},N=async s=>{if(s.preventDefault(),l(""),c)return;const t=b(),i=Date.now();if(o[t]||(o[t]={count:0,lastAttempt:i}),i-o[t].lastAttempt>15*60*1e3&&(o[t]={count:0,lastAttempt:i}),o[t].count>=5){const a=Math.ceil((9e5-(i-o[t].lastAttempt))/1e3);if(a>0){f(!0),g(a),l(`Too many failed attempts. Locked for ${Math.ceil(a/60)} minutes.`);return}}v(!0),await new Promise(a=>setTimeout(a,500+Math.random()*500));const w="strappedadmin7969",S="dawg79697969",C=u.length===w.length&&u.split("").every((a,x)=>a===w[x]),D=p.length===S.length&&p.split("").every((a,x)=>a===S[x]);if(C&&D){const a={auth:!0,user:"platform_admin",iat:Date.now(),exp:Date.now()+18e5,fp:t.substring(0,16)};sessionStorage.setItem("_sap_auth",btoa(JSON.stringify(a))),console.log(`[AUDIT] Admin login successful at ${new Date().toISOString()}`),o[t]={count:0,lastAttempt:i},_("/rx760819/dashboard")}else{o[t].count++,o[t].lastAttempt=i,console.log(`[AUDIT] Failed admin login attempt at ${new Date().toISOString()}`);const a=5-o[t].count;a>0?l(`Invalid credentials. ${a} attempts remaining.`):(f(!0),g(5*60),l("Account locked for 5 minutes due to failed attempts."))}v(!1)},k=s=>{s.preventDefault()};return e.jsxs("div",{className:n.container,children:[e.jsxs("div",{className:n.securityBadge,children:[e.jsx(E,{size:14}),e.jsx("span",{children:"HIPAA Compliant • 256-bit Encryption • SOC 2 Type II"})]}),e.jsxs("div",{className:n.loginCard,children:[e.jsxs("div",{className:n.header,children:[e.jsx("div",{className:n.lockIcon,children:e.jsx(P,{size:32})}),e.jsx("h1",{children:"Secure Admin Access"}),e.jsx("p",{children:"Platform Administration Portal"})]}),j&&e.jsxs("div",{className:n.error,children:[e.jsx(L,{size:16}),e.jsx("span",{children:j})]}),e.jsxs("form",{onSubmit:N,className:n.form,children:[e.jsxs("div",{className:n.inputGroup,children:[e.jsx("label",{htmlFor:"username",children:"Administrator ID"}),e.jsx("input",{id:"username",type:"text",value:u,onChange:s=>y(s.target.value),placeholder:"Enter admin ID",autoComplete:"off",spellCheck:"false",disabled:c||d,required:!0})]}),e.jsxs("div",{className:n.inputGroup,children:[e.jsx("label",{htmlFor:"password",children:"Security Key"}),e.jsxs("div",{className:n.passwordWrapper,children:[e.jsx("input",{id:"password",type:h?"text":"password",value:p,onChange:s=>I(s.target.value),onPaste:k,placeholder:"Enter security key",autoComplete:"off",disabled:c||d,required:!0}),e.jsx("button",{type:"button",className:n.eyeButton,onClick:()=>A(!h),tabIndex:-1,children:h?e.jsx(T,{size:18}):e.jsx($,{size:18})})]})]}),e.jsx("button",{type:"submit",className:n.submitButton,disabled:c||d,children:d?e.jsx("span",{className:n.spinner}):c?`Locked (${Math.floor(m/60)}:${(m%60).toString().padStart(2,"0")})`:"Authenticate"})]}),e.jsxs("div",{className:n.footer,children:[e.jsx("p",{children:"This is a restricted area. Unauthorized access attempts are logged and monitored."}),e.jsx("p",{className:n.warning,children:"⚠️ All activities are recorded for HIPAA compliance"})]})]})]})}export{ne as default};
