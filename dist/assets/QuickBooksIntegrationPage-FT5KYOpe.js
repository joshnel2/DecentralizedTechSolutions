import{r as c,a6 as s}from"./vendor-DrKzkH4x.js";import{i as v}from"./index-CCWWoMiH.js";import{s as e}from"./IntegrationDataPage.module-DQ8gf-9T.js";import{a as Q}from"./router-CNLU_KyZ.js";import{al as T,a8 as N,R as p,D as z,Q as D,F as L,ao as A}from"./icons-BtUkkwGS.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";import"./state-72d44OIA.js";function _(){const g=Q(),[I,F]=c.useState("invoices"),[r,m]=c.useState([]),[H,M]=c.useState([]),[y,u]=c.useState(!0),[n,h]=c.useState(!1),[l,f]=c.useState(""),[d,t]=c.useState(null);c.useEffect(()=>{k()},[]);const k=async()=>{try{u(!0);const a=await v.syncQuickBooks();m(a.invoices||[])}catch(a){t({type:"error",message:a.message||"Failed to load QuickBooks data"})}finally{u(!1)}},S=async()=>{h(!0);try{const a=await v.syncQuickBooks();m(a.invoices||[]),t({type:"success",message:a.message||"QuickBooks synced successfully"})}catch(a){t({type:"error",message:a.message||"Sync failed"})}finally{h(!1)}},o=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a),C=a=>a?new Date(a).toLocaleDateString():"",x=r.filter(a=>{var i,j;return((i=a.customerName)==null?void 0:i.toLowerCase().includes(l.toLowerCase()))||((j=a.number)==null?void 0:j.toLowerCase().includes(l.toLowerCase()))}),b=r.reduce((a,i)=>a+(i.balance||0),0),B=r.filter(a=>a.balance===0).length,w=r.filter(a=>a.status==="overdue").length;return s.jsxs("div",{className:e.container,children:[d&&s.jsxs("div",{className:`${e.notification} ${e[d.type]}`,children:[d.message,s.jsx("button",{onClick:()=>t(null),children:"Ã—"})]}),s.jsxs("div",{className:e.header,children:[s.jsxs("div",{className:e.headerLeft,children:[s.jsx("button",{className:e.backBtn,onClick:()=>g(-1),children:s.jsx(T,{size:20})}),s.jsx("div",{className:e.headerIcon,children:s.jsx(N,{size:28})}),s.jsxs("div",{children:[s.jsx("h1",{children:"QuickBooks"}),s.jsx("p",{children:"View invoices and customers from QuickBooks"})]})]}),s.jsx("div",{className:e.headerActions,children:s.jsxs("button",{className:e.syncBtn,onClick:S,disabled:n,children:[s.jsx(p,{size:18,className:n?e.spinning:""}),n?"Syncing...":"Sync"]})})]}),s.jsxs("div",{className:e.dataGrid,style:{marginBottom:"var(--spacing-lg)"},children:[s.jsxs("div",{className:e.dataCard,children:[s.jsxs("div",{className:e.cardHeader,children:[s.jsx("span",{className:e.cardTitle,children:"Outstanding"}),s.jsx(z,{size:20,style:{color:"var(--gold-primary)"}})]}),s.jsx("div",{className:e.cardAmount,children:o(b)}),s.jsxs("div",{className:e.cardMeta,children:[r.length," invoices"]})]}),s.jsxs("div",{className:e.dataCard,children:[s.jsxs("div",{className:e.cardHeader,children:[s.jsx("span",{className:e.cardTitle,children:"Paid"}),s.jsx(D,{size:20,style:{color:"var(--success)"}})]}),s.jsx("div",{className:e.cardAmount,children:B}),s.jsx("div",{className:e.cardMeta,children:"invoices paid"})]}),s.jsxs("div",{className:e.dataCard,children:[s.jsxs("div",{className:e.cardHeader,children:[s.jsx("span",{className:e.cardTitle,children:"Overdue"}),s.jsx(L,{size:20,style:{color:"var(--error)"}})]}),s.jsx("div",{className:e.cardAmount,children:w}),s.jsx("div",{className:e.cardMeta,children:"need attention"})]})]}),s.jsx("div",{className:e.toolbar,children:s.jsxs("div",{className:e.searchBox,children:[s.jsx(A,{size:18}),s.jsx("input",{type:"text",placeholder:"Search invoices...",value:l,onChange:a=>f(a.target.value)})]})}),y?s.jsxs("div",{className:e.loading,children:[s.jsx(p,{size:24,className:e.spinning}),s.jsx("span",{children:"Loading QuickBooks data..."})]}):s.jsx("div",{className:e.dataGrid,children:x.length===0?s.jsxs("div",{className:e.empty,children:[s.jsx(N,{size:48}),s.jsx("h3",{children:"No invoices found"}),s.jsx("p",{children:"Your QuickBooks invoices will appear here"})]}):x.map(a=>s.jsxs("div",{className:e.dataCard,children:[s.jsxs("div",{className:e.cardHeader,children:[s.jsxs("span",{className:e.cardTitle,children:["#",a.number]}),s.jsx("span",{className:`${e.cardBadge} ${e[a.status]}`,children:a.status})]}),s.jsx("div",{className:e.cardAmount,children:o(a.total)}),s.jsxs("div",{className:e.cardMeta,children:[s.jsx("div",{children:a.customerName}),s.jsxs("div",{children:["Due: ",C(a.dueDate)]}),a.balance>0&&s.jsxs("div",{style:{color:"var(--gold-primary)"},children:["Balance: ",o(a.balance)]})]})]},a.id))})]})}export{_ as QuickBooksIntegrationPage};
