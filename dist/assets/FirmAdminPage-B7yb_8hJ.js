import{r as u,a6 as e,h as E}from"./vendor-DrKzkH4x.js";import{d as me,u as ue,a as pe,r as w}from"./index-CCWWoMiH.js";import{a as he}from"./router-CNLU_KyZ.js";import{A as xe,al as _e,aB as V,y as R,a4 as F,$ as ge,aJ as G,x as U,bh as je,bi as q,ao as W,ay as ye,az as C,bf as ve,R as Ne,X as A,as as z,v as X,am as ke,o as be,F as Ce,J,I as ze,aX as fe,t as Y,M as K,z as we}from"./icons-BtUkkwGS.js";import{a as H,p as f,f as Ae}from"./date-utils-BkNAU8cl.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";import"./state-72d44OIA.js";const Be="_firmAdminPage_yzkga_3",Ie="_backButton_yzkga_9",De="_noAccess_yzkga_39",Se="_header_yzkga_55",Pe="_headerLeft_yzkga_63",Le="_headerActions_yzkga_76",Te="_primaryBtn_yzkga_82",Me="_secondaryBtn_yzkga_101",Ee="_addBtn_yzkga_119",Re="_textBtn_yzkga_138",Fe="_textBtnDanger_yzkga_155 _textBtn_yzkga_138",Ge="_tabs_yzkga_164",Ue="_tab_yzkga_164",He="_active_yzkga_194",$e="_tabContent_yzkga_200",Oe="_toolbar_yzkga_205",Ve="_searchBox_yzkga_212",qe="_tableContainer_yzkga_237",We="_table_yzkga_237",Xe="_userCell_yzkga_271",Je="_userAvatar_yzkga_277",Qe="_userInfo_yzkga_291",Ye="_userName_yzkga_296",Ke="_userEmail_yzkga_301",Ze="_roleBadge_yzkga_307",es="_statusBadge_yzkga_317",ss="_statusDot_yzkga_332",as="_groupTags_yzkga_340",ts="_groupTag_yzkga_340",is="_moreGroups_yzkga_355",ns="_lastActive_yzkga_360",os="_actions_yzkga_366",rs="_iconBtn_yzkga_371",ls="_iconBtnDanger_yzkga_390 _iconBtn_yzkga_371",cs="_invitationsSection_yzkga_400",ds="_invitationsList_yzkga_411",ms="_invitationItem_yzkga_417",us="_invitationInfo_yzkga_427",ps="_invitationEmail_yzkga_431",hs="_invitationMeta_yzkga_437",xs="_invitationActions_yzkga_442",_s="_twoColumn_yzkga_448",gs="_column_yzkga_460",js="_columnHeader_yzkga_467",ys="_hint_yzkga_480",vs="_groupsList_yzkga_486",Ns="_groupCard_yzkga_492",ks="_groupColor_yzkga_506",bs="_groupContent_yzkga_512",Cs="_groupHeader_yzkga_517",zs="_groupName_yzkga_523",fs="_memberCount_yzkga_528",ws="_groupDesc_yzkga_533",As="_groupPermissions_yzkga_539",Bs="_permTag_yzkga_545",Is="_groupActions_yzkga_554",Ds="_rolesList_yzkga_561",Ss="_roleCard_yzkga_567",Ps="_roleColor_yzkga_577",Ls="_roleContent_yzkga_583",Ts="_roleName_yzkga_587",Ms="_roleDesc_yzkga_593",Es="_roleStats_yzkga_599",Rs="_permissionsHeader_yzkga_605",Fs="_permissionsMatrix_yzkga_621",Gs="_matrixTable_yzkga_628",Us="_categoryHeader_yzkga_642",Hs="_categoryRow_yzkga_647",$s="_categoryName_yzkga_655",Os="_permName_yzkga_665",Vs="_permDesc_yzkga_675",qs="_permCell_yzkga_680",Ws="_hasPermission_yzkga_684",Xs="_noPermission_yzkga_688",Js="_auditHeader_yzkga_693",Qs="_auditFilters_yzkga_700",Ys="_auditList_yzkga_748",Ks="_auditItem_yzkga_754",Zs="_auditIcon_yzkga_769",ea="_auditContent_yzkga_780",sa="_auditAction_yzkga_784",aa="_auditUser_yzkga_792",ta="_auditVerb_yzkga_797",ia="_auditResource_yzkga_802",na="_auditMeta_yzkga_807",oa="_detailsBtn_yzkga_820",ra="_templatesGrid_yzkga_840",la="_templateCard_yzkga_846",ca="_templateHeader_yzkga_859",da="_practiceArea_yzkga_867",ma="_templateName_yzkga_875",ua="_templateMeta_yzkga_882",pa="_templateStages_yzkga_890",ha="_stageStep_yzkga_897",xa="_stageNumber_yzkga_903",_a="_stageName_yzkga_916",ga="_templateActions_yzkga_921",ja="_entityTabs_yzkga_929",ya="_entityTab_yzkga_929",va="_fieldsTable_yzkga_956",Na="_fieldName_yzkga_963",ka="_entityBadge_yzkga_967",ba="_typeCell_yzkga_975",Ca="_checkIcon_yzkga_980",za="_xIcon_yzkga_984",fa="_optionsPreview_yzkga_988",wa="_noOptions_yzkga_993",Aa="_workflowsIntro_yzkga_998",Ba="_workflowExamples_yzkga_1018",Ia="_workflowGrid_yzkga_1028",Da="_workflowCard_yzkga_1040",Sa="_workflowIcon_yzkga_1054",Pa="_modalOverlay_yzkga_1078",La="_modal_yzkga_1078",Ta="_modalHeader_yzkga_1104",Ma="_closeBtn_yzkga_1118",Ea="_modalForm_yzkga_1137",Ra="_formGroup_yzkga_1144",Fa="_formRow_yzkga_1225",Ga="_checkboxGroup_yzkga_1232",Ua="_checkboxLabel_yzkga_1238",Ha="_userPreview_yzkga_1269",$a="_permissionsPreview_yzkga_1286",Oa="_permissionsList_yzkga_1299",Va="_permissionItem_yzkga_1305",qa="_morePerms_yzkga_1316",Wa="_modalActions_yzkga_1321",Xa="_cancelBtn_yzkga_1330",s={firmAdminPage:Be,backButton:Ie,noAccess:De,header:Se,headerLeft:Pe,headerActions:Le,primaryBtn:Te,secondaryBtn:Me,addBtn:Ee,textBtn:Re,textBtnDanger:Fe,tabs:Ge,tab:Ue,active:He,tabContent:$e,toolbar:Oe,searchBox:Ve,tableContainer:qe,table:We,userCell:Xe,userAvatar:Je,userInfo:Qe,userName:Ye,userEmail:Ke,roleBadge:Ze,statusBadge:es,statusDot:ss,groupTags:as,groupTag:ts,moreGroups:is,lastActive:ns,actions:os,iconBtn:rs,iconBtnDanger:ls,invitationsSection:cs,invitationsList:ds,invitationItem:ms,invitationInfo:us,invitationEmail:ps,invitationMeta:hs,invitationActions:xs,twoColumn:_s,column:gs,columnHeader:js,hint:ys,groupsList:vs,groupCard:Ns,groupColor:ks,groupContent:bs,groupHeader:Cs,groupName:zs,memberCount:fs,groupDesc:ws,groupPermissions:As,permTag:Bs,groupActions:Is,rolesList:Ds,roleCard:Ss,roleColor:Ps,roleContent:Ls,roleName:Ts,roleDesc:Ms,roleStats:Es,permissionsHeader:Rs,permissionsMatrix:Fs,matrixTable:Gs,categoryHeader:Us,categoryRow:Hs,categoryName:$s,permName:Os,permDesc:Vs,permCell:qs,hasPermission:Ws,noPermission:Xs,auditHeader:Js,auditFilters:Qs,auditList:Ys,auditItem:Ks,auditIcon:Zs,auditContent:ea,auditAction:sa,auditUser:aa,auditVerb:ta,auditResource:ia,auditMeta:na,detailsBtn:oa,templatesGrid:ra,templateCard:la,templateHeader:ca,practiceArea:da,templateName:ma,templateMeta:ua,templateStages:pa,stageStep:ha,stageNumber:xa,stageName:_a,templateActions:ga,entityTabs:ja,entityTab:ya,fieldsTable:va,fieldName:Na,entityBadge:ka,typeCell:ba,checkIcon:Ca,xIcon:za,optionsPreview:fa,noOptions:wa,workflowsIntro:Aa,workflowExamples:Ba,workflowGrid:Ia,workflowCard:Da,workflowIcon:Sa,modalOverlay:Pa,modal:La,modalHeader:Ta,closeBtn:Ma,modalForm:Ea,formGroup:Ra,formRow:Fa,checkboxGroup:Ga,checkboxLabel:Ua,userPreview:Ha,permissionsPreview:$a,permissionsList:Oa,permissionItem:Va,morePerms:qa,modalActions:Wa,cancelBtn:Xa},Ja=[{id:"matters",name:"Matters",permissions:[{id:"matters:create",name:"Create",desc:"Create new matters"},{id:"matters:view",name:"View",desc:"View matter details"},{id:"matters:edit",name:"Edit",desc:"Edit matter information"},{id:"matters:delete",name:"Delete",desc:"Delete matters"},{id:"matters:assign",name:"Assign",desc:"Assign team members"}]},{id:"clients",name:"Clients",permissions:[{id:"clients:create",name:"Create",desc:"Create new clients"},{id:"clients:view",name:"View",desc:"View client details"},{id:"clients:edit",name:"Edit",desc:"Edit client information"},{id:"clients:delete",name:"Delete",desc:"Delete clients"}]},{id:"billing",name:"Billing",permissions:[{id:"billing:create",name:"Create",desc:"Create invoices/entries"},{id:"billing:view",name:"View",desc:"View billing information"},{id:"billing:edit",name:"Edit",desc:"Edit billing entries"},{id:"billing:delete",name:"Delete",desc:"Delete billing entries"},{id:"billing:approve",name:"Approve",desc:"Approve time & expenses"}]},{id:"documents",name:"Documents",permissions:[{id:"documents:upload",name:"Upload",desc:"Upload documents"},{id:"documents:view",name:"View",desc:"View documents"},{id:"documents:edit",name:"Edit",desc:"Edit documents"},{id:"documents:delete",name:"Delete",desc:"Delete documents"}]},{id:"calendar",name:"Calendar",permissions:[{id:"calendar:create",name:"Create",desc:"Create events"},{id:"calendar:view",name:"View",desc:"View calendar"},{id:"calendar:edit",name:"Edit",desc:"Edit events"},{id:"calendar:delete",name:"Delete",desc:"Delete events"}]},{id:"reports",name:"Reports",permissions:[{id:"reports:view",name:"View",desc:"View reports"},{id:"reports:create",name:"Create",desc:"Create custom reports"},{id:"reports:export",name:"Export",desc:"Export report data"}]},{id:"admin",name:"Administration",permissions:[{id:"firm:manage",name:"Firm Settings",desc:"Manage firm settings"},{id:"firm:billing",name:"Firm Billing",desc:"Manage firm billing"},{id:"users:invite",name:"Invite Users",desc:"Invite new users"},{id:"users:manage",name:"Manage Users",desc:"Edit user permissions"},{id:"users:delete",name:"Delete Users",desc:"Remove users"},{id:"groups:manage",name:"Manage Groups",desc:"Manage groups"},{id:"integrations:manage",name:"Integrations",desc:"Manage integrations"},{id:"audit:view",name:"Audit Logs",desc:"View audit logs"}]}],v=[{id:"owner",name:"Owner",color:"#F59E0B",desc:"Full access to all features"},{id:"admin",name:"Admin",color:"#8B5CF6",desc:"Administrative access"},{id:"attorney",name:"Attorney",color:"#3B82F6",desc:"Standard attorney access"},{id:"paralegal",name:"Paralegal",color:"#10B981",desc:"Paralegal access"},{id:"staff",name:"Staff",color:"#64748B",desc:"Limited access"},{id:"billing",name:"Billing",color:"#EC4899",desc:"Billing-focused access"},{id:"readonly",name:"Read Only",color:"#94A3B8",desc:"View-only access"}],Q=[],Qa=[{id:"1",name:"Personal Injury",practiceArea:"Litigation",stages:["Intake","Investigation","Discovery","Settlement/Trial","Closing"],tasks:12,documents:8},{id:"2",name:"Corporate Formation",practiceArea:"Corporate",stages:["Consultation","Documentation","Filing","Post-Formation"],tasks:8,documents:15},{id:"3",name:"Real Estate Closing",practiceArea:"Real Estate",stages:["Contract","Due Diligence","Title Review","Closing","Post-Closing"],tasks:15,documents:20},{id:"4",name:"Estate Planning",practiceArea:"Estate Planning",stages:["Consultation","Drafting","Review","Signing","Funding"],tasks:10,documents:12}],Ya=[{id:"1",name:"SSN/Tax ID",entity:"Client",type:"text",required:!0},{id:"2",name:"Date of Birth",entity:"Client",type:"date",required:!1},{id:"3",name:"Referral Source",entity:"Client",type:"select",options:["Website","Referral","Advertisement","Other"],required:!0},{id:"4",name:"Case Value",entity:"Matter",type:"currency",required:!1},{id:"5",name:"Court Deadline",entity:"Matter",type:"date",required:!1},{id:"6",name:"Document Category",entity:"Document",type:"select",options:["Pleading","Discovery","Correspondence","Contract","Other"],required:!0}];function ut(){const d=he(),l=me(),{user:p,firm:c,teamMembers:n,invitations:x,getAuditLog:i,inviteUser:g,updateTeamMember:j,removeTeamMember:o,revokeInvitation:B,resendInvitation:I}=ue(),{groups:k,addGroup:Z,updateGroup:ee,deleteGroup:se}=pe(),[_,ae]=u.useState("users"),[b,te]=u.useState(""),[ie,D]=u.useState(!1),[ne,S]=u.useState(!1),[et,oe]=u.useState(!1),[st,re]=u.useState(!1),[P,L]=u.useState(null),[y,T]=u.useState({action:"all",user:"all",dateRange:"week"}),le=[{id:"users",name:"Users",icon:R},{id:"groups",name:"Groups & Roles",icon:F},{id:"permissions",name:"Permissions",icon:ge},{id:"audit",name:"Audit Log",icon:G},{id:"templates",name:"Matter Templates",icon:U},{id:"custom-fields",name:"Custom Fields",icon:je},{id:"workflows",name:"Workflows",icon:q}],$=u.useMemo(()=>n.filter(a=>`${a.firstName} ${a.lastName}`.toLowerCase().includes(b.toLowerCase())||a.email.toLowerCase().includes(b.toLowerCase())),[n,b]),N=a=>{var t;return((t=v.find(r=>r.id===a))==null?void 0:t.color)||"#64748B"},ce=(a,t)=>(w[a]||[]).includes(t);return(p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="owner"?e.jsxs("div",{className:s.firmAdminPage,children:[e.jsxs("button",{className:s.backButton,onClick:()=>d("/app/settings"),children:[e.jsx(_e,{size:16}),"Back to Settings"]}),e.jsxs("div",{className:s.header,children:[e.jsxs("div",{className:s.headerLeft,children:[e.jsx("h1",{children:"Firm Administration"}),e.jsx("p",{children:"Manage users, permissions, and firm-wide settings"})]}),e.jsx("div",{className:s.headerActions,children:e.jsxs("button",{className:s.secondaryBtn,onClick:()=>{const a=$.map(m=>`${m.firstName} ${m.lastName},${m.email},${m.role}`).join(`
`),t=new Blob([`Name,Email,Role
${a}`],{type:"text/csv"}),r=URL.createObjectURL(t),h=document.createElement("a");h.href=r,h.download="firm-users.csv",h.click(),URL.revokeObjectURL(r)},children:[e.jsx(V,{size:18}),"Export"]})})]}),e.jsx("div",{className:s.tabs,children:le.map(a=>e.jsxs("button",{className:E(s.tab,_===a.id&&s.active),onClick:()=>ae(a.id),children:[e.jsx(a.icon,{size:18}),a.name]},a.id))}),_==="users"&&e.jsxs("div",{className:s.tabContent,children:[e.jsxs("div",{className:s.toolbar,children:[e.jsxs("div",{className:s.searchBox,children:[e.jsx(W,{size:18}),e.jsx("input",{type:"text",placeholder:"Search users...",value:b,onChange:a=>te(a.target.value)})]}),e.jsxs("button",{className:s.primaryBtn,onClick:()=>D(!0),children:[e.jsx(ye,{size:18}),"Invite User"]})]}),e.jsx("div",{className:s.tableContainer,children:e.jsxs("table",{className:s.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Groups"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Last Active"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:$.map(a=>{var t,r,h,m;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:s.userCell,children:[e.jsxs("div",{className:s.userAvatar,style:{borderColor:N(a.role)},children:[(t=a.firstName)==null?void 0:t[0],(r=a.lastName)==null?void 0:r[0]]}),e.jsxs("div",{className:s.userInfo,children:[e.jsxs("span",{className:s.userName,children:[a.firstName," ",a.lastName]}),e.jsx("span",{className:s.userEmail,children:a.email})]})]})}),e.jsx("td",{children:e.jsx("span",{className:s.roleBadge,style:{background:`${N(a.role)}20`,color:N(a.role)},children:a.role})}),e.jsx("td",{children:e.jsxs("div",{className:s.groupTags,children:[(h=a.groupIds)==null?void 0:h.slice(0,2).map(O=>{const M=k.find(de=>de.id===O);return M?e.jsx("span",{className:s.groupTag,style:{borderColor:M.color},children:M.name},O):null}),(((m=a.groupIds)==null?void 0:m.length)||0)>2&&e.jsxs("span",{className:s.moreGroups,children:["+",a.groupIds.length-2]})]})}),e.jsx("td",{children:e.jsxs("span",{className:E(s.statusBadge,s.active),children:[e.jsx("span",{className:s.statusDot}),"Active"]})}),e.jsx("td",{className:s.lastActive,children:a.lastLoginAt?H(f(a.lastLoginAt),{addSuffix:!0}):"Never"}),e.jsx("td",{children:e.jsxs("div",{className:s.actions,children:[e.jsx("button",{className:s.iconBtn,title:"Edit",onClick:()=>{L(a),S(!0)},children:e.jsx(C,{size:16})}),a.role!=="owner"&&e.jsx("button",{className:s.iconBtnDanger,title:"Remove",onClick:()=>o(a.id),children:e.jsx(ve,{size:16})})]})})]},a.id)})})]})}),x.filter(a=>a.status==="pending").length>0&&e.jsxs("div",{className:s.invitationsSection,children:[e.jsx("h3",{children:"Pending Invitations"}),e.jsx("div",{className:s.invitationsList,children:x.filter(a=>a.status==="pending").map(a=>e.jsxs("div",{className:s.invitationItem,children:[e.jsxs("div",{className:s.invitationInfo,children:[e.jsx("span",{className:s.invitationEmail,children:a.email}),e.jsxs("span",{className:s.invitationMeta,children:["Invited ",H(f(a.invitedAt),{addSuffix:!0})," • Expires ",Ae(f(a.expiresAt),"MMM d, yyyy")]})]}),e.jsx("span",{className:s.roleBadge,style:{background:`${N(a.role)}20`,color:N(a.role)},children:a.role}),e.jsxs("div",{className:s.invitationActions,children:[e.jsxs("button",{className:s.textBtn,onClick:()=>I(a.id),children:[e.jsx(Ne,{size:14}),"Resend"]}),e.jsxs("button",{className:s.textBtnDanger,onClick:()=>B(a.id),children:[e.jsx(A,{size:14}),"Revoke"]})]})]},a.id))})]})]}),_==="groups"&&e.jsx("div",{className:s.tabContent,children:e.jsxs("div",{className:s.twoColumn,children:[e.jsxs("div",{className:s.column,children:[e.jsxs("div",{className:s.columnHeader,children:[e.jsx("h3",{children:"Groups"}),e.jsxs("button",{className:s.addBtn,onClick:()=>Z({name:"New Group",description:"",memberIds:[],permissions:[],color:"#3B82F6",updatedAt:new Date().toISOString()}),children:[e.jsx(z,{size:16}),"Add Group"]})]}),e.jsx("div",{className:s.groupsList,children:k.map(a=>e.jsxs("div",{className:s.groupCard,children:[e.jsx("div",{className:s.groupColor,style:{background:a.color}}),e.jsxs("div",{className:s.groupContent,children:[e.jsxs("div",{className:s.groupHeader,children:[e.jsx("span",{className:s.groupName,children:a.name}),e.jsxs("span",{className:s.memberCount,children:[a.memberIds.length," members"]})]}),e.jsx("p",{className:s.groupDesc,children:a.description||"No description"}),e.jsxs("div",{className:s.groupPermissions,children:[a.permissions.slice(0,3).map(t=>e.jsx("span",{className:s.permTag,children:t.split(":")[0]},t)),a.permissions.length>3&&e.jsxs("span",{className:s.permTag,children:["+",a.permissions.length-3]})]})]}),e.jsxs("div",{className:s.groupActions,children:[e.jsx("button",{className:s.iconBtn,onClick:()=>{const t=prompt(`Edit group "${a.name}":`,a.name);t&&t!==a.name&&(ee(a.id,{name:t}),l.success("Group renamed",`Renamed to "${t}"`))},children:e.jsx(C,{size:16})}),e.jsx("button",{className:s.iconBtnDanger,onClick:()=>se(a.id),children:e.jsx(X,{size:16})})]})]},a.id))})]}),e.jsxs("div",{className:s.column,children:[e.jsxs("div",{className:s.columnHeader,children:[e.jsx("h3",{children:"Roles"}),e.jsx("span",{className:s.hint,children:"System-defined roles"})]}),e.jsx("div",{className:s.rolesList,children:v.map(a=>e.jsxs("div",{className:s.roleCard,children:[e.jsx("div",{className:s.roleColor,style:{background:a.color}}),e.jsxs("div",{className:s.roleContent,children:[e.jsx("span",{className:s.roleName,children:a.name}),e.jsx("span",{className:s.roleDesc,children:a.desc})]}),e.jsx("div",{className:s.roleStats,children:e.jsxs("span",{children:[n.filter(t=>t.role===a.id).length," users"]})})]},a.id))})]})]})}),_==="permissions"&&e.jsxs("div",{className:s.tabContent,children:[e.jsxs("div",{className:s.permissionsHeader,children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Permissions Matrix"}),e.jsx("p",{children:"View and compare permissions across roles"})]}),e.jsxs("button",{className:s.primaryBtn,onClick:()=>d("/app/admin/permissions"),children:[e.jsx(F,{size:16}),"Advanced Permission Settings"]})]}),e.jsx("div",{className:s.permissionsMatrix,children:e.jsxs("table",{className:s.matrixTable,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:s.categoryHeader,children:"Permission"}),v.filter(a=>a.id!=="readonly").map(a=>e.jsx("th",{style:{color:a.color},children:a.name},a.id))]})}),e.jsx("tbody",{children:Ja.map(a=>e.jsxs(e.Fragment,{children:[e.jsx("tr",{className:s.categoryRow,children:e.jsx("td",{colSpan:7,className:s.categoryName,children:a.name})},a.id),a.permissions.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:s.permName,children:[e.jsx("span",{children:t.name}),e.jsx("span",{className:s.permDesc,children:t.desc})]}),v.filter(r=>r.id!=="readonly").map(r=>e.jsx("td",{className:s.permCell,children:ce(r.id,t.id)?e.jsx(ke,{size:18,className:s.hasPermission}):e.jsx(be,{size:18,className:s.noPermission})},r.id))]},t.id))]}))})]})})]}),_==="audit"&&e.jsxs("div",{className:s.tabContent,children:[e.jsxs("div",{className:s.auditHeader,children:[e.jsxs("div",{className:s.auditFilters,children:[e.jsxs("select",{value:y.action,onChange:a=>T({...y,action:a.target.value}),children:[e.jsx("option",{value:"all",children:"All Actions"}),e.jsx("option",{value:"user",children:"User Actions"}),e.jsx("option",{value:"matter",children:"Matter Actions"}),e.jsx("option",{value:"document",children:"Document Actions"}),e.jsx("option",{value:"billing",children:"Billing Actions"})]}),e.jsxs("select",{value:y.user,onChange:a=>T({...y,user:a.target.value}),children:[e.jsx("option",{value:"all",children:"All Users"}),n.map(a=>e.jsxs("option",{value:a.id,children:[a.firstName," ",a.lastName]},a.id))]}),e.jsxs("select",{value:y.dateRange,onChange:a=>T({...y,dateRange:a.target.value}),children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"Last 7 Days"}),e.jsx("option",{value:"month",children:"Last 30 Days"}),e.jsx("option",{value:"quarter",children:"Last 90 Days"})]})]}),e.jsxs("button",{className:s.secondaryBtn,onClick:()=>{const a=Q.map(m=>`${m.timestamp},${m.user},${m.action},${m.ip}`).join(`
`),t=new Blob([`Timestamp,User,Action,IP
${a}`],{type:"text/csv"}),r=URL.createObjectURL(t),h=document.createElement("a");h.href=r,h.download="audit-log.csv",h.click(),URL.revokeObjectURL(r)},children:[e.jsx(V,{size:16}),"Export Log"]})]}),e.jsx("div",{className:s.auditList,children:Q.map(a=>e.jsxs("div",{className:s.auditItem,children:[e.jsxs("div",{className:s.auditIcon,children:[a.action.includes("user")&&e.jsx(R,{size:18}),a.action.includes("matter")&&e.jsx(U,{size:18}),a.action.includes("document")&&e.jsx(Ce,{size:18}),a.action.includes("invoice")&&e.jsx(G,{size:18}),a.action.includes("client")&&e.jsx(R,{size:18}),a.action.includes("time")&&e.jsx(J,{size:18}),a.action.includes("group")&&e.jsx(F,{size:18})]}),e.jsxs("div",{className:s.auditContent,children:[e.jsxs("div",{className:s.auditAction,children:[e.jsx("span",{className:s.auditUser,children:a.user}),e.jsx("span",{className:s.auditVerb,children:a.action.replace("."," ").replace("_"," ")}),a.resourceId&&e.jsx("span",{className:s.auditResource,children:a.resourceId})]}),e.jsxs("div",{className:s.auditMeta,children:[e.jsxs("span",{children:[e.jsx(J,{size:12})," ",H(f(a.timestamp),{addSuffix:!0})]}),e.jsxs("span",{children:["IP: ",a.ip]})]})]}),e.jsx("button",{className:s.detailsBtn,onClick:()=>l.info("Audit Log Details",`User: ${a.user} | Action: ${a.action} | IP: ${a.ip}`),children:e.jsx(ze,{size:16})})]},a.id))})]}),_==="templates"&&e.jsxs("div",{className:s.tabContent,children:[e.jsxs("div",{className:s.toolbar,children:[e.jsxs("div",{className:s.searchBox,children:[e.jsx(W,{size:18}),e.jsx("input",{type:"text",placeholder:"Search templates..."})]}),e.jsxs("button",{className:s.primaryBtn,onClick:()=>oe(!0),children:[e.jsx(z,{size:18}),"New Template"]})]}),e.jsx("div",{className:s.templatesGrid,children:Qa.map(a=>e.jsxs("div",{className:s.templateCard,children:[e.jsxs("div",{className:s.templateHeader,children:[e.jsx(U,{size:24}),e.jsx("span",{className:s.practiceArea,children:a.practiceArea})]}),e.jsx("h3",{className:s.templateName,children:a.name}),e.jsxs("div",{className:s.templateMeta,children:[e.jsxs("span",{children:[a.stages.length," stages"]}),e.jsxs("span",{children:[a.tasks," tasks"]}),e.jsxs("span",{children:[a.documents," docs"]})]}),e.jsx("div",{className:s.templateStages,children:a.stages.map((t,r)=>e.jsxs("div",{className:s.stageStep,children:[e.jsx("span",{className:s.stageNumber,children:r+1}),e.jsx("span",{className:s.stageName,children:t})]},r))}),e.jsxs("div",{className:s.templateActions,children:[e.jsxs("button",{className:s.textBtn,onClick:()=>l.info("Edit Template",`Opening editor for: ${a.name}`),children:[e.jsx(C,{size:14})," Edit"]}),e.jsxs("button",{className:s.textBtn,onClick:()=>l.success("Template Duplicated",`Created: ${a.name} (Copy)`),children:[e.jsx(fe,{size:14})," Duplicate"]})]})]},a.id))})]}),_==="custom-fields"&&e.jsxs("div",{className:s.tabContent,children:[e.jsxs("div",{className:s.toolbar,children:[e.jsxs("div",{className:s.entityTabs,children:[e.jsx("button",{className:E(s.entityTab,s.active),onClick:()=>l.info("Filter Applied","Showing all custom fields"),children:"All"}),e.jsx("button",{className:s.entityTab,onClick:()=>l.info("Filter Applied","Showing Client fields"),children:"Client"}),e.jsx("button",{className:s.entityTab,onClick:()=>l.info("Filter Applied","Showing Matter fields"),children:"Matter"}),e.jsx("button",{className:s.entityTab,onClick:()=>l.info("Filter Applied","Showing Document fields"),children:"Document"})]}),e.jsxs("button",{className:s.primaryBtn,onClick:()=>re(!0),children:[e.jsx(z,{size:18}),"Add Field"]})]}),e.jsx("div",{className:s.fieldsTable,children:e.jsxs("table",{className:s.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Field Name"}),e.jsx("th",{children:"Entity"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Required"}),e.jsx("th",{children:"Options"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:Ya.map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:s.fieldName,children:a.name})}),e.jsx("td",{children:e.jsx("span",{className:s.entityBadge,children:a.entity})}),e.jsx("td",{className:s.typeCell,children:a.type}),e.jsx("td",{children:a.required?e.jsx(Y,{size:16,className:s.checkIcon}):e.jsx(A,{size:16,className:s.xIcon})}),e.jsx("td",{children:a.options?e.jsxs("span",{className:s.optionsPreview,children:[a.options.slice(0,2).join(", "),a.options.length>2?`, +${a.options.length-2}`:""]}):e.jsx("span",{className:s.noOptions,children:"—"})}),e.jsx("td",{children:e.jsxs("div",{className:s.actions,children:[e.jsx("button",{className:s.iconBtn,onClick:()=>l.info("Edit Field",`Editing: ${a.name} (${a.type})`),children:e.jsx(C,{size:16})}),e.jsx("button",{className:s.iconBtnDanger,onClick:()=>{confirm(`Delete custom field "${a.name}"?`)&&l.success("Field Deleted",`${a.name} has been removed`)},children:e.jsx(X,{size:16})})]})})]},a.id))})]})})]}),_==="workflows"&&e.jsxs("div",{className:s.tabContent,children:[e.jsxs("div",{className:s.workflowsIntro,children:[e.jsx(q,{size:48}),e.jsx("h3",{children:"Workflow Automation"}),e.jsx("p",{children:"Create automated workflows to streamline your practice"}),e.jsxs("button",{className:s.primaryBtn,onClick:()=>l.info("Coming Soon","Workflow builder is under development"),children:[e.jsx(z,{size:18}),"Create Workflow"]})]}),e.jsxs("div",{className:s.workflowExamples,children:[e.jsx("h4",{children:"Example Workflows"}),e.jsxs("div",{className:s.workflowGrid,children:[e.jsxs("div",{className:s.workflowCard,children:[e.jsx("div",{className:s.workflowIcon,children:e.jsx(K,{size:24})}),e.jsx("h5",{children:"Client Intake"}),e.jsx("p",{children:"Automatically send welcome emails and create tasks when a new client is added"})]}),e.jsxs("div",{className:s.workflowCard,children:[e.jsx("div",{className:s.workflowIcon,children:e.jsx(we,{size:24})}),e.jsx("h5",{children:"Deadline Reminders"}),e.jsx("p",{children:"Send automated reminders before court deadlines and statute of limitations"})]}),e.jsxs("div",{className:s.workflowCard,children:[e.jsx("div",{className:s.workflowIcon,children:e.jsx(G,{size:24})}),e.jsx("h5",{children:"Invoice Follow-up"}),e.jsx("p",{children:"Automatically send payment reminders for overdue invoices"})]})]})]})]}),ie&&e.jsx(Ka,{onClose:()=>D(!1),onInvite:a=>{g(a),D(!1)},groups:k}),ne&&P&&e.jsx(Za,{user:P,onClose:()=>{S(!1),L(null)},onSave:a=>{j(P.id,a),S(!1),L(null)},groups:k})]}):e.jsxs("div",{className:s.noAccess,children:[e.jsx(xe,{size:48}),e.jsx("h2",{children:"Access Denied"}),e.jsx("p",{children:"You need administrator privileges to access firm administration."})]})}function Ka({onClose:d,onInvite:l,groups:p}){const[c,n]=u.useState({email:"",firstName:"",lastName:"",role:"attorney",groupIds:[]}),x=i=>{i.preventDefault(),l(c)};return e.jsx("div",{className:s.modalOverlay,onClick:d,children:e.jsxs("div",{className:s.modal,onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:s.modalHeader,children:[e.jsx("h2",{children:"Invite Team Member"}),e.jsx("button",{onClick:d,className:s.closeBtn,children:e.jsx(A,{size:20})})]}),e.jsxs("form",{onSubmit:x,className:s.modalForm,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Email Address *"}),e.jsx("input",{type:"email",value:c.email,onChange:i=>n({...c,email:i.target.value}),placeholder:"colleague@lawfirm.com",required:!0})]}),e.jsxs("div",{className:s.formRow,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"First Name *"}),e.jsx("input",{type:"text",value:c.firstName,onChange:i=>n({...c,firstName:i.target.value}),required:!0})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Last Name *"}),e.jsx("input",{type:"text",value:c.lastName,onChange:i=>n({...c,lastName:i.target.value}),required:!0})]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Role *"}),e.jsx("select",{value:c.role,onChange:i=>n({...c,role:i.target.value}),children:v.filter(i=>i.id!=="owner").map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Groups"}),e.jsx("div",{className:s.checkboxGroup,children:p.map(i=>e.jsxs("label",{className:s.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:c.groupIds.includes(i.id),onChange:g=>{g.target.checked?n({...c,groupIds:[...c.groupIds,i.id]}):n({...c,groupIds:c.groupIds.filter(j=>j!==i.id)})}}),e.jsx("span",{style:{borderColor:i.color},children:i.name})]},i.id))})]}),e.jsxs("div",{className:s.modalActions,children:[e.jsx("button",{type:"button",onClick:d,className:s.cancelBtn,children:"Cancel"}),e.jsxs("button",{type:"submit",className:s.primaryBtn,children:[e.jsx(K,{size:16}),"Send Invitation"]})]})]})]})})}function Za({user:d,onClose:l,onSave:p,groups:c}){var g,j;const[n,x]=u.useState({role:d.role,groupIds:d.groupIds||[]}),i=o=>{o.preventDefault(),p(n)};return e.jsx("div",{className:s.modalOverlay,onClick:l,children:e.jsxs("div",{className:s.modal,onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{className:s.modalHeader,children:[e.jsx("h2",{children:"Edit User Permissions"}),e.jsx("button",{onClick:l,className:s.closeBtn,children:e.jsx(A,{size:20})})]}),e.jsxs("form",{onSubmit:i,className:s.modalForm,children:[e.jsxs("div",{className:s.userPreview,children:[e.jsxs("div",{className:s.userAvatar,children:[(g=d.firstName)==null?void 0:g[0],(j=d.lastName)==null?void 0:j[0]]}),e.jsxs("div",{children:[e.jsxs("span",{className:s.userName,children:[d.firstName," ",d.lastName]}),e.jsx("span",{className:s.userEmail,children:d.email})]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Role"}),e.jsx("select",{value:n.role,onChange:o=>x({...n,role:o.target.value}),disabled:d.role==="owner",children:v.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Groups"}),e.jsx("div",{className:s.checkboxGroup,children:c.map(o=>e.jsxs("label",{className:s.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:n.groupIds.includes(o.id),onChange:B=>{B.target.checked?x({...n,groupIds:[...n.groupIds,o.id]}):x({...n,groupIds:n.groupIds.filter(I=>I!==o.id)})}}),e.jsx("span",{style:{borderColor:o.color},children:o.name})]},o.id))})]}),e.jsxs("div",{className:s.permissionsPreview,children:[e.jsx("h4",{children:"Current Permissions"}),e.jsxs("div",{className:s.permissionsList,children:[(w[n.role]||[]).slice(0,8).map(o=>e.jsxs("span",{className:s.permissionItem,children:[e.jsx(Y,{size:12})," ",o]},o)),(w[n.role]||[]).length>8&&e.jsxs("span",{className:s.morePerms,children:["+",(w[n.role]||[]).length-8," more"]})]})]}),e.jsxs("div",{className:s.modalActions,children:[e.jsx("button",{type:"button",onClick:l,className:s.cancelBtn,children:"Cancel"}),e.jsx("button",{type:"submit",className:s.primaryBtn,children:"Save Changes"})]})]})]})})}export{ut as FirmAdminPage};
