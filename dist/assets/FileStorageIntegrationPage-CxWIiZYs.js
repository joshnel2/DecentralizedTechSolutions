import{r as n,a6 as e}from"./vendor-DrKzkH4x.js";import{h as f,m as H}from"./index-CCWWoMiH.js";import{a as K}from"./router-CNLU_KyZ.js";import{t as q,a as J,al as Q,a6 as D,R as V,as as P,ao as X,a7 as h,E as I,L as A,K as Z,v as ee,a2 as se,F as te}from"./icons-BtUkkwGS.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";import"./state-72d44OIA.js";const ae="_container_1if8x_1",ie="_notification_1if8x_8",ne="_slideIn_1if8x_1",oe="_success_1if8x_22",le="_error_1if8x_27",re="_header_1if8x_47",ce="_headerLeft_1if8x_54",de="_backBtn_1if8x_60",me="_headerIcon_1if8x_79",xe="_headerActions_1if8x_102",fe="_refreshBtn_1if8x_107",he="_addBtn_1if8x_126",pe="_toolbar_1if8x_145",_e="_searchBox_1if8x_155",ue="_stats_1if8x_183",ve="_content_1if8x_189",je="_storageTypes_1if8x_196",ge="_storageGrid_1if8x_208",Ne="_storageCard_1if8x_214",ke="_filesSection_1if8x_230",ye="_loading_1if8x_242",Le="_empty_1if8x_252",be="_filesList_1if8x_295",Se="_fileItem_1if8x_301",Ce="_fileIcon_1if8x_316",we="_fileInfo_1if8x_328",Be="_fileName_1if8x_333",Te="_filePath_1if8x_339",Pe="_fileMeta_1if8x_349",Ae="_fileType_1if8x_356",De="_fileMatter_1if8x_365",Ie="_fileDate_1if8x_369",Fe="_fileActions_1if8x_373",ze="_deleteBtn_1if8x_397",Me="_modalOverlay_1if8x_403",Ge="_modal_1if8x_403",Oe="_modalDesc_1if8x_432",Re="_formGroup_1if8x_438",Ee="_storageTypeSelect_1if8x_465",Ue="_storageOption_1if8x_471",$e="_active_1if8x_491",We="_modalActions_1if8x_497",Ye="_cancelBtn_1if8x_504",He="_confirmBtn_1if8x_505",Ke="_spinning_1if8x_543",qe="_spin_1if8x_543",t={container:ae,notification:ie,slideIn:ne,success:oe,error:le,header:re,headerLeft:ce,backBtn:de,headerIcon:me,headerActions:xe,refreshBtn:fe,addBtn:he,toolbar:pe,searchBox:_e,stats:ue,content:ve,storageTypes:je,storageGrid:ge,storageCard:Ne,filesSection:ke,loading:ye,empty:Le,filesList:be,fileItem:Se,fileIcon:Ce,fileInfo:we,fileName:Be,filePath:Te,fileMeta:Pe,fileType:Ae,fileMatter:De,fileDate:Ie,fileActions:Fe,deleteBtn:ze,modalOverlay:Me,modal:Ge,modalDesc:Oe,formGroup:Re,storageTypeSelect:Ee,storageOption:Ue,active:$e,modalActions:We,cancelBtn:Ye,confirmBtn:He,spinning:Ke,spin:qe},p=[{value:"local_path",label:"Local/Network Path",icon:D,description:"Link to files on your computer or network drive"},{value:"google_drive",label:"Google Drive",icon:h,description:"Link to files stored in Google Drive"},{value:"onedrive",label:"OneDrive",icon:h,description:"Link to files stored in Microsoft OneDrive"},{value:"dropbox",label:"Dropbox",icon:h,description:"Link to files stored in Dropbox"},{value:"sharepoint",label:"SharePoint",icon:h,description:"Link to files stored in SharePoint"},{value:"url",label:"Web URL",icon:I,description:"Link to any file accessible via URL"}];function as(){const F=K(),[_,g]=n.useState([]),[z,M]=n.useState([]),[u,N]=n.useState(!0),[m,G]=n.useState(""),[O,d]=n.useState(!1),[o,k]=n.useState("local_path"),[c,y]=n.useState(""),[L,b]=n.useState(""),[S,C]=n.useState(""),[v,w]=n.useState(!1),[x,l]=n.useState(null);n.useEffect(()=>{j()},[]);const j=async()=>{N(!0);try{const[s,a]=await Promise.all([f.getAll(),H.getAll()]),r=(s.documents||[]).filter(i=>i.externalPath);g(r.map(i=>({id:i.id,name:i.name,externalPath:i.externalPath,externalType:i.externalType||"url",matterId:i.matterId,matterName:i.matterName,size:i.size,uploadedAt:i.uploadedAt}))),M(a.matters||[])}catch(s){console.error("Failed to load data:",s)}finally{N(!1)}},R=async()=>{if(!c.trim()){l({type:"error",message:"Please enter a file path or URL"});return}w(!0);try{const s=L.trim()||c.split("/").pop()||c.split("\\").pop()||"Linked File",a=new Blob(["External file link"],{type:"text/plain"}),r=new File([a],`${s}.link`,{type:"text/plain"}),i=await f.upload(r,{matterId:S||void 0,tags:["external-link"]});await f.update(i.document.id,{name:s,externalPath:c,externalType:o}),l({type:"success",message:"File linked successfully"}),d(!1),B(),j()}catch(s){l({type:"error",message:s.message||"Failed to link file"})}finally{w(!1)}},E=async s=>{if(confirm("Remove this file link?"))try{await f.delete(s),g(_.filter(a=>a.id!==s)),l({type:"success",message:"Link removed"})}catch{l({type:"error",message:"Failed to remove link"})}},U=s=>{s.externalType==="url"||s.externalPath.startsWith("http")?window.open(s.externalPath,"_blank"):(navigator.clipboard.writeText(s.externalPath),l({type:"success",message:"Path copied to clipboard"}))},B=()=>{k("local_path"),y(""),b(""),C("")},$=s=>{const a=p.find(i=>i.value===s),r=(a==null?void 0:a.icon)||te;return e.jsx(r,{size:18})},W=s=>{var a;return((a=p.find(r=>r.value===s))==null?void 0:a.label)||s},T=_.filter(s=>{var a;return s.name.toLowerCase().includes(m.toLowerCase())||s.externalPath.toLowerCase().includes(m.toLowerCase())||((a=s.matterName)==null?void 0:a.toLowerCase().includes(m.toLowerCase()))}),Y=s=>new Date(s).toLocaleDateString([],{month:"short",day:"numeric",year:"numeric"});return e.jsxs("div",{className:t.container,children:[x&&e.jsxs("div",{className:`${t.notification} ${t[x.type]}`,children:[x.type==="success"?e.jsx(q,{size:16}):e.jsx(J,{size:16}),x.message,e.jsx("button",{onClick:()=>l(null),children:"Ã—"})]}),e.jsxs("div",{className:t.header,children:[e.jsxs("div",{className:t.headerLeft,children:[e.jsx("button",{className:t.backBtn,onClick:()=>F("/app/integrations"),children:e.jsx(Q,{size:20})}),e.jsx("div",{className:t.headerIcon,children:e.jsx(D,{size:28})}),e.jsxs("div",{children:[e.jsx("h1",{children:"File Storage"}),e.jsx("p",{children:"Link documents from your computer or cloud storage"})]})]}),e.jsxs("div",{className:t.headerActions,children:[e.jsx("button",{className:t.refreshBtn,onClick:j,disabled:u,children:e.jsx(V,{size:18,className:u?t.spinning:""})}),e.jsxs("button",{className:t.addBtn,onClick:()=>d(!0),children:[e.jsx(P,{size:18}),"Link File"]})]})]}),e.jsxs("div",{className:t.toolbar,children:[e.jsxs("div",{className:t.searchBox,children:[e.jsx(X,{size:18}),e.jsx("input",{type:"text",placeholder:"Search linked files...",value:m,onChange:s=>G(s.target.value)})]}),e.jsx("div",{className:t.stats,children:e.jsxs("span",{children:[_.length," linked files"]})})]}),e.jsxs("div",{className:t.content,children:[e.jsxs("div",{className:t.storageTypes,children:[e.jsx("h3",{children:"Supported Storage Locations"}),e.jsx("div",{className:t.storageGrid,children:p.map(s=>e.jsxs("div",{className:t.storageCard,children:[e.jsx(s.icon,{size:24}),e.jsx("span",{children:s.label})]},s.value))})]}),e.jsxs("div",{className:t.filesSection,children:[e.jsx("h3",{children:"Linked Files"}),u?e.jsxs("div",{className:t.loading,children:[e.jsx(A,{size:24,className:t.spinning}),e.jsx("span",{children:"Loading..."})]}):T.length===0?e.jsxs("div",{className:t.empty,children:[e.jsx(Z,{size:48}),e.jsx("h4",{children:"No linked files yet"}),e.jsx("p",{children:"Link files from your computer or cloud storage to access them here"}),e.jsxs("button",{onClick:()=>d(!0),children:[e.jsx(P,{size:18}),"Link Your First File"]})]}):e.jsx("div",{className:t.filesList,children:T.map(s=>e.jsxs("div",{className:t.fileItem,children:[e.jsx("div",{className:t.fileIcon,children:$(s.externalType)}),e.jsxs("div",{className:t.fileInfo,children:[e.jsx("div",{className:t.fileName,children:s.name}),e.jsx("div",{className:t.filePath,children:s.externalPath}),e.jsxs("div",{className:t.fileMeta,children:[e.jsx("span",{className:t.fileType,children:W(s.externalType)}),s.matterName&&e.jsx("span",{className:t.fileMatter,children:s.matterName}),e.jsx("span",{className:t.fileDate,children:Y(s.uploadedAt)})]})]}),e.jsxs("div",{className:t.fileActions,children:[e.jsx("button",{onClick:()=>U(s),title:"Open / Copy Path",children:e.jsx(I,{size:16})}),e.jsx("button",{onClick:()=>E(s.id),title:"Remove Link",className:t.deleteBtn,children:e.jsx(ee,{size:16})})]})]},s.id))})]})]}),O&&e.jsx("div",{className:t.modalOverlay,onClick:()=>d(!1),children:e.jsxs("div",{className:t.modal,onClick:s=>s.stopPropagation(),children:[e.jsx("h2",{children:"Link External File"}),e.jsx("p",{className:t.modalDesc,children:"Connect a file from your computer or cloud storage"}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Storage Type"}),e.jsx("div",{className:t.storageTypeSelect,children:p.map(s=>e.jsxs("button",{className:`${t.storageOption} ${o===s.value?t.active:""}`,onClick:()=>k(s.value),children:[e.jsx(s.icon,{size:20}),e.jsx("span",{children:s.label})]},s.value))})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"File Path / URL"}),e.jsx("input",{type:"text",value:c,onChange:s=>y(s.target.value),placeholder:o==="local_path"?"C:\\Documents\\contract.pdf or /Users/name/Documents/file.pdf":o==="google_drive"?"https://drive.google.com/file/d/...":o==="onedrive"?"https://onedrive.live.com/...":o==="dropbox"?"https://www.dropbox.com/...":o==="sharepoint"?"https://company.sharepoint.com/...":"https://example.com/document.pdf"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Display Name (optional)"}),e.jsx("input",{type:"text",value:L,onChange:s=>b(s.target.value),placeholder:"My Contract Document"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Link to Matter (optional)"}),e.jsxs("select",{value:S,onChange:s=>C(s.target.value),children:[e.jsx("option",{value:"",children:"No matter selected"}),z.map(s=>e.jsxs("option",{value:s.id,children:[s.number," - ",s.name]},s.id))]})]}),e.jsxs("div",{className:t.modalActions,children:[e.jsx("button",{className:t.cancelBtn,onClick:()=>{d(!1),B()},children:"Cancel"}),e.jsxs("button",{className:t.confirmBtn,onClick:R,disabled:v||!c.trim(),children:[v?e.jsx(A,{size:16,className:t.spinning}):e.jsx(se,{size:16}),v?"Linking...":"Link File"]})]})]})})]})}export{as as FileStorageIntegrationPage};
