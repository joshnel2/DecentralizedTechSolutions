import{r,a6 as e,h as y}from"./vendor-DrKzkH4x.js";import{d as ee,x as b}from"./index-CCWWoMiH.js";import{a as Cs}from"./router-CNLU_KyZ.js";import{a4 as Xe,al as ys,O as Ss,a0 as Y,y as G,a2 as ks,F as Ye,J as ws,ao as es,as as ss,bk as ts,L as as,bC as ns,s as is,v as ls,am as K,a as W,X as D,ap as rs,n as Is,ar as Bs,aU as Fs,R as Ms,aj as zs,ak as As}from"./icons-BtUkkwGS.js";import{f as R,p as H}from"./date-utils-BkNAU8cl.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";import"./state-72d44OIA.js";const Es="_adminPage_1fch2_1",Gs="_fadeIn_1fch2_1",Rs="_backButton_1fch2_5",Hs="_header_1fch2_35",Ds="_headerLeft_1fch2_42",Ls="_loading_1fch2_67",Us="_error_1fch2_67",Ts="_spinner_1fch2_86",qs="_spin_1fch2_86",Os="_tabs_1fch2_100",Vs="_tab_1fch2_100",$s="_active_1fch2_127",Qs="_overview_1fch2_134",Ks="_statsGrid_1fch2_138",Ws="_statCard_1fch2_144",Js="_statInfo_1fch2_158",Ps="_statValue_1fch2_163",Zs="_statLabel_1fch2_169",Xs="_section_1fch2_175",Ys="_sectionHeader_1fch2_182",et="_searchBox_1fch2_190",st="_firmFilter_1fch2_219",tt="_addBtn_1fch2_228",at="_table_1fch2_247",nt="_firmName_1fch2_280",it="_contact_1fch2_292",lt="_actions_1fch2_299",rt="_deleteBtn_1fch2_319",ct="_roleBadge_1fch2_326",ot="_owner_1fch2_335",dt="_admin_1fch2_1",ht="_attorney_1fch2_345",ut="_paralegal_1fch2_350",mt="_staff_1fch2_355",xt="_billing_1fch2_360",pt="_readonly_1fch2_365",jt="_statusBadge_1fch2_370",_t="_inactive_1fch2_383",vt="_modalOverlay_1fch2_389",gt="_modal_1fch2_389",ft="_modalHeader_1fch2_413",Nt="_formGrid_1fch2_445",bt="_formGroup_1fch2_451",Ct="_fullWidth_1fch2_457",yt="_passwordInput_1fch2_528",St="_modalActions_1fch2_554",kt="_cancelBtn_1fch2_563",wt="_saveBtn_1fch2_578",It="_integrationsHeader_1fch2_604",Bt="_integrationCard_1fch2_618",Ft="_integrationCardHeader_1fch2_626",Mt="_integrationIcon_1fch2_633",zt="_integrationFields_1fch2_656",At="_integrationActions_1fch2_690",Et="_integrationMessage_1fch2_702",Gt="_success_1fch2_712",Rt="_scanModal_1fch2_725",Ht="_modalSlide_1fch2_1",Dt="_scanModalHeader_1fch2_746",Lt="_scanModeBadge_1fch2_764",Ut="_scanModalBody_1fch2_774",Tt="_scanPhase_1fch2_781",qt="_phaseLabel_1fch2_788",Ot="_phaseValue_1fch2_792",Vt="_phaseRunning_1fch2_800",$t="_phaseCompleted_1fch2_804",Qt="_phaseError_1fch2_808",Kt="_phaseCancelled_1fch2_812",Wt="_spinnerSmall_1fch2_816",Jt="_progressContainer_1fch2_820",Pt="_progressBar_1fch2_826",Zt="_progressFill_1fch2_834",Xt="_progressPercent_1fch2_841",Yt="_scanStats_1fch2_849",ea="_scanStat_1fch2_849",sa="_scanError_1fch2_875",ta="_scanTiming_1fch2_892",aa="_scanModalFooter_1fch2_901",na="_cancelScanBtn_1fch2_910",ia="_resetScanBtn_1fch2_911",la="_closeScanBtn_1fch2_912",ra="_settingsModal_1fch2_955",ca="_settingsContent_1fch2_968",oa="_settingsSection_1fch2_977",da="_settingRow_1fch2_993",ha="_checkboxLabel_1fch2_1024",ua="_settingHint_1fch2_1037",ma="_historySection_1fch2_1045",xa="_historyHeader_1fch2_1051",pa="_refreshHistoryBtn_1fch2_1068",ja="_noHistory_1fch2_1088",_a="_historyTable_1fch2_1096",va="_historyStatus_1fch2_1120",ga="_statusCompleted_1fch2_1129",fa="_statusError_1fch2_1134",Na="_statusCancelled_1fch2_1139",s={adminPage:Es,fadeIn:Gs,backButton:Rs,header:Hs,headerLeft:Ds,loading:Ls,error:Us,spinner:Ts,spin:qs,tabs:Os,tab:Vs,active:$s,overview:Qs,statsGrid:Ks,statCard:Ws,statInfo:Js,statValue:Ps,statLabel:Zs,section:Xs,sectionHeader:Ys,searchBox:et,firmFilter:st,addBtn:tt,table:at,firmName:nt,contact:it,actions:lt,deleteBtn:rt,roleBadge:ct,owner:ot,admin:dt,attorney:ht,paralegal:ut,staff:mt,billing:xt,readonly:pt,statusBadge:jt,inactive:_t,modalOverlay:vt,modal:gt,modalHeader:ft,formGrid:Nt,formGroup:bt,fullWidth:Ct,passwordInput:yt,modalActions:St,cancelBtn:kt,saveBtn:wt,integrationsHeader:It,integrationCard:Bt,integrationCardHeader:Ft,integrationIcon:Mt,integrationFields:zt,integrationActions:At,integrationMessage:Et,success:Gt,scanModal:Rt,modalSlide:Ht,scanModalHeader:Dt,scanModeBadge:Lt,scanModalBody:Ut,scanPhase:Tt,phaseLabel:qt,phaseValue:Ot,phaseRunning:Vt,phaseCompleted:$t,phaseError:Qt,phaseCancelled:Kt,spinnerSmall:Wt,progressContainer:Jt,progressBar:Pt,progressFill:Zt,progressPercent:Xt,scanStats:Yt,scanStat:ea,scanError:sa,scanTiming:ta,scanModalFooter:aa,cancelScanBtn:na,resetScanBtn:ia,closeScanBtn:la,settingsModal:ra,settingsContent:ca,settingsSection:oa,settingRow:da,checkboxLabel:ha,settingHint:ua,historySection:ma,historyHeader:xa,refreshHistoryBtn:pa,noHistory:ja,historyTable:_a,historyStatus:va,statusCompleted:ga,statusError:fa,statusCancelled:Na},ba=()=>localStorage.getItem("secureAdminSession")||"",C=async(n,g={})=>{const _=await fetch(`https://apexai-api.azurewebsites.net/api/secure-admin${n}`,{...g,headers:{"Content-Type":"application/json","X-Admin-Auth":ba(),...g.headers}});if(!_.ok){const h=await _.json();throw new Error(h.error||"Request failed")}return _.json()};function Ea(){var he,ue,me,xe,pe,je,_e,ve,ge,fe,Ne,be,Ce,ye,Se,ke,we,Ie,Be,Fe,Me,ze,Ae,Ee,Ge,Re,He,De,Le,Ue,Te,qe,Oe,Ve,$e,Qe,Ke,We,Je,Pe,Ze;const n=Cs(),g=ee(),[x,_]=r.useState("overview"),[h,c]=r.useState([]),[p,S]=r.useState([]),[v,u]=r.useState(null),[M,L]=r.useState(!0),[z,o]=r.useState(null),[j,se]=r.useState(""),[k,J]=r.useState(null),[cs,U]=r.useState(!1),[os,T]=r.useState(!1),[P,te]=r.useState(null),[Z,ae]=r.useState(null),[l,ne]=r.useState({}),[ie,le]=r.useState(!1),[q,X]=r.useState(null),[w,O]=r.useState(null),[I,V]=r.useState(null),[ds,A]=r.useState(!1),[a,$]=r.useState(null),B=r.useRef(null),[N,Q]=r.useState({autoSyncEnabled:!1,syncInterval:10,permissionMode:"matter"}),[re,hs]=r.useState([]),[us,E]=r.useState(!1);r.useEffect(()=>{F()},[]);const ce=r.useCallback(async t=>{var i,m;try{const f=await C(`/firms/${t}/scan-status`);$(f),(f.status==="completed"||f.status==="error"||f.status==="cancelled")&&(B.current&&(clearInterval(B.current),B.current=null),O(null),V({firmId:t,message:f.status==="completed"?`Scan completed: ${((i=f.progress)==null?void 0:i.created)||0} files created, ${((m=f.progress)==null?void 0:m.matched)||0} matched`:f.error||"Scan failed",success:f.status==="completed"}),F())}catch(f){console.error("Failed to poll scan status:",f)}},[]);r.useEffect(()=>()=>{B.current&&clearInterval(B.current)},[]);const F=async()=>{L(!0),o(null);try{const[t,i,m]=await Promise.all([b.getStats(),b.getFirms(),b.getUsers()]);u(t),c(i.firms||[]),S(m.users||[])}catch(t){o(t.message||"Failed to load admin data. You may not have admin access.")}finally{L(!1)}},oe=async()=>{try{const t=await C("/platform-settings");ne(t)}catch(t){console.error("Failed to load integration settings:",t)}},ms=async()=>{le(!0),X(null);try{const t={};Object.entries(l).forEach(([i,m])=>{typeof m=="object"&&m.value!==void 0?t[i]=m.value:typeof m=="string"&&(t[i]=m)}),await C("/platform-settings",{method:"PUT",body:JSON.stringify(t)}),X({type:"success",text:"Integration settings saved successfully!"}),oe()}catch(t){X({type:"error",text:t.message||"Failed to save settings"})}finally{le(!1)}},d=(t,i)=>{ne(m=>({...m,[t]:{...m[t],value:i}}))},xs=h.filter(t=>{var i;return t.name.toLowerCase().includes(j.toLowerCase())||((i=t.email)==null?void 0:i.toLowerCase().includes(j.toLowerCase()))}),ps=p.filter(t=>{const i=t.email.toLowerCase().includes(j.toLowerCase())||`${t.firstName} ${t.lastName}`.toLowerCase().includes(j.toLowerCase()),m=!k||t.firmId===k;return i&&m});if(M)return e.jsxs("div",{className:s.loading,children:[e.jsx("div",{className:s.spinner}),e.jsx("p",{children:"Loading admin portal..."})]});if(z)return e.jsxs("div",{className:s.error,children:[e.jsx(Xe,{size:48}),e.jsx("h2",{children:"Access Denied"}),e.jsx("p",{children:z})]});return e.jsxs("div",{className:s.adminPage,children:[e.jsxs("button",{className:s.backButton,onClick:()=>n("/app/settings"),children:[e.jsx(ys,{size:16}),"Back to Settings"]}),e.jsx("div",{className:s.header,children:e.jsxs("div",{className:s.headerLeft,children:[e.jsx(Xe,{size:28}),e.jsxs("div",{children:[e.jsx("h1",{children:"Admin Portal"}),e.jsx("p",{children:"Manage firms and users across the platform"})]})]})}),e.jsxs("div",{className:s.tabs,children:[e.jsxs("button",{className:y(s.tab,x==="overview"&&s.active),onClick:()=>_("overview"),children:[e.jsx(Ss,{size:18}),"Overview"]}),e.jsxs("button",{className:y(s.tab,x==="firms"&&s.active),onClick:()=>_("firms"),children:[e.jsx(Y,{size:18}),"Firms (",h.length,")"]}),e.jsxs("button",{className:y(s.tab,x==="users"&&s.active),onClick:()=>_("users"),children:[e.jsx(G,{size:18}),"Users (",p.length,")"]}),e.jsxs("button",{className:y(s.tab,x==="integrations"&&s.active),onClick:()=>{_("integrations"),oe()},children:[e.jsx(ks,{size:18}),"Integrations"]})]}),x==="overview"&&v&&e.jsx("div",{className:s.overview,children:e.jsxs("div",{className:s.statsGrid,children:[e.jsxs("div",{className:s.statCard,children:[e.jsx(Y,{size:24}),e.jsxs("div",{className:s.statInfo,children:[e.jsx("span",{className:s.statValue,children:v.total_firms}),e.jsx("span",{className:s.statLabel,children:"Total Firms"})]})]}),e.jsxs("div",{className:s.statCard,children:[e.jsx(G,{size:24}),e.jsxs("div",{className:s.statInfo,children:[e.jsx("span",{className:s.statValue,children:v.total_users}),e.jsx("span",{className:s.statLabel,children:"Total Users"})]})]}),e.jsxs("div",{className:s.statCard,children:[e.jsx(G,{size:24}),e.jsxs("div",{className:s.statInfo,children:[e.jsx("span",{className:s.statValue,children:v.active_users}),e.jsx("span",{className:s.statLabel,children:"Active Users"})]})]}),e.jsxs("div",{className:s.statCard,children:[e.jsx(Ye,{size:24}),e.jsxs("div",{className:s.statInfo,children:[e.jsx("span",{className:s.statValue,children:v.total_matters}),e.jsx("span",{className:s.statLabel,children:"Total Matters"})]})]}),e.jsxs("div",{className:s.statCard,children:[e.jsx(G,{size:24}),e.jsxs("div",{className:s.statInfo,children:[e.jsx("span",{className:s.statValue,children:v.total_clients}),e.jsx("span",{className:s.statLabel,children:"Total Clients"})]})]}),e.jsxs("div",{className:s.statCard,children:[e.jsx(Ye,{size:24}),e.jsxs("div",{className:s.statInfo,children:[e.jsx("span",{className:s.statValue,children:v.total_documents}),e.jsx("span",{className:s.statLabel,children:"Documents"})]})]}),e.jsxs("div",{className:s.statCard,children:[e.jsx(ws,{size:24}),e.jsxs("div",{className:s.statInfo,children:[e.jsx("span",{className:s.statValue,children:v.total_time_entries}),e.jsx("span",{className:s.statLabel,children:"Time Entries"})]})]})]})}),x==="firms"&&e.jsxs("div",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsxs("div",{className:s.searchBox,children:[e.jsx(es,{size:18}),e.jsx("input",{type:"text",placeholder:"Search firms...",value:j,onChange:t=>se(t.target.value)})]}),e.jsxs("button",{className:s.addBtn,onClick:()=>{te(null),U(!0)},children:[e.jsx(ss,{size:18}),"Add Firm"]})]}),e.jsx("div",{className:s.table,children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Firm Name"}),e.jsx("th",{children:"Contact"}),e.jsx("th",{children:"Users"}),e.jsx("th",{children:"Matters"}),e.jsx("th",{children:"Clients"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:xs.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:s.firmName,children:[e.jsx(Y,{size:16}),e.jsx("span",{children:t.name})]})}),e.jsx("td",{children:e.jsxs("div",{className:s.contact,children:[t.email&&e.jsx("span",{children:t.email}),t.phone&&e.jsx("span",{children:t.phone})]})}),e.jsx("td",{children:t.userCount}),e.jsx("td",{children:t.matterCount}),e.jsx("td",{children:t.clientCount}),e.jsx("td",{children:R(H(t.createdAt),"MMM d, yyyy")}),e.jsx("td",{children:e.jsxs("div",{className:s.actions,children:[e.jsx("button",{onClick:()=>{te(t),U(!0)},title:"Edit",children:e.jsx(ts,{size:16})}),e.jsx("button",{onClick:()=>{J(t.id),_("users")},title:"View Users",children:e.jsx(G,{size:16})}),e.jsx("button",{onClick:()=>vs(t.id),disabled:w===t.id,title:"Scan Documents & Set Permissions",style:{color:w===t.id?"#888":"#10B981"},children:w===t.id?e.jsx(as,{size:16,className:s.spinnerSmall}):e.jsx(ns,{size:16})}),e.jsx("button",{onClick:()=>de(t.id),title:"Scan Settings & History",style:{color:"#6366F1"},children:e.jsx(is,{size:16})}),e.jsx("button",{className:s.deleteBtn,onClick:()=>_s(t.id),title:"Delete",children:e.jsx(ls,{size:16})})]})})]},t.id))})]})}),I&&e.jsx("div",{style:{marginTop:"16px",padding:"12px 16px",borderRadius:"8px",background:I.success?"rgba(16, 185, 129, 0.1)":"rgba(239, 68, 68, 0.1)",border:`1px solid ${I.success?"#10B981":"#EF4444"}`,color:I.success?"#10B981":"#EF4444"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[I.success?e.jsx(K,{size:18}):e.jsx(W,{size:18}),e.jsx("span",{children:I.message}),e.jsx("button",{onClick:()=>V(null),style:{marginLeft:"auto",background:"none",border:"none",cursor:"pointer",color:"inherit"},children:e.jsx(D,{size:16})})]})})]}),x==="users"&&e.jsxs("div",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsxs("div",{className:s.searchBox,children:[e.jsx(es,{size:18}),e.jsx("input",{type:"text",placeholder:"Search users...",value:j,onChange:t=>se(t.target.value)})]}),e.jsxs("select",{value:k||"",onChange:t=>J(t.target.value||null),className:s.firmFilter,children:[e.jsx("option",{value:"",children:"All Firms"}),h.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("button",{className:s.addBtn,onClick:()=>{ae(null),T(!0)},children:[e.jsx(ss,{size:18}),"Add User"]})]}),e.jsx("div",{className:s.table,children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Firm"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:ps.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{children:[t.firstName," ",t.lastName]}),e.jsx("td",{children:t.email}),e.jsx("td",{children:t.firmName}),e.jsx("td",{children:e.jsx("span",{className:y(s.roleBadge,s[t.role]),children:t.role})}),e.jsx("td",{children:e.jsx("span",{className:y(s.statusBadge,t.isActive?s.active:s.inactive),children:t.isActive?"Active":"Inactive"})}),e.jsx("td",{children:R(H(t.createdAt),"MMM d, yyyy")}),e.jsx("td",{children:e.jsxs("div",{className:s.actions,children:[e.jsx("button",{onClick:()=>{ae(t),T(!0)},title:"Edit",children:e.jsx(ts,{size:16})}),e.jsx("button",{className:s.deleteBtn,onClick:()=>bs(t.id),title:"Delete",children:e.jsx(ls,{size:16})})]})})]},t.id))})]})})]}),x==="integrations"&&e.jsxs("div",{className:s.section,children:[e.jsxs("div",{className:s.integrationsHeader,children:[e.jsx("h2",{children:"Integration Credentials"}),e.jsx("p",{children:"Configure OAuth credentials for Outlook, QuickBooks, and Google integrations. Users will be able to connect their accounts once these are set up."})]}),q&&e.jsxs("div",{className:`${s.integrationMessage} ${s[q.type]}`,children:[q.type==="success"?e.jsx(K,{size:18}):e.jsx(W,{size:18}),q.text]}),e.jsxs("div",{className:s.integrationCard,children:[e.jsxs("div",{className:s.integrationCardHeader,children:[e.jsx("span",{className:s.integrationIcon,children:"ðŸ“§"}),e.jsxs("div",{children:[e.jsx("h3",{children:"Microsoft Outlook"}),e.jsxs("p",{children:["Email and Calendar integration. ",e.jsx("a",{href:"https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade",target:"_blank",rel:"noopener noreferrer",children:"Register app in Azure Portal â†’"})]})]})]}),e.jsxs("div",{className:s.integrationFields,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Client ID"}),e.jsx("input",{type:"text",value:((he=l.microsoft_client_id)==null?void 0:he.value)||"",onChange:t=>d("microsoft_client_id",t.target.value),placeholder:"Enter Microsoft Client ID"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Client Secret"}),e.jsx("input",{type:"password",value:((ue=l.microsoft_client_secret)==null?void 0:ue.value)||"",onChange:t=>d("microsoft_client_secret",t.target.value),placeholder:(me=l.microsoft_client_secret)!=null&&me.isConfigured?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢":"Enter Client Secret"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Redirect URI"}),e.jsx("input",{type:"text",value:((xe=l.microsoft_redirect_uri)==null?void 0:xe.value)||"",onChange:t=>d("microsoft_redirect_uri",t.target.value),placeholder:"https://your-api.com/api/integrations/outlook/callback"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Tenant"}),e.jsx("input",{type:"text",value:((pe=l.microsoft_tenant)==null?void 0:pe.value)||"common",onChange:t=>d("microsoft_tenant",t.target.value),placeholder:"common"})]})]})]}),e.jsxs("div",{className:s.integrationCard,children:[e.jsxs("div",{className:s.integrationCardHeader,children:[e.jsx("span",{className:s.integrationIcon,children:"ðŸ“Š"}),e.jsxs("div",{children:[e.jsx("h3",{children:"QuickBooks Online"}),e.jsxs("p",{children:["Accounting and invoicing. ",e.jsx("a",{href:"https://developer.intuit.com/app/developer/dashboard",target:"_blank",rel:"noopener noreferrer",children:"Register app in Intuit Developer â†’"})]})]})]}),e.jsxs("div",{className:s.integrationFields,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Client ID"}),e.jsx("input",{type:"text",value:((je=l.quickbooks_client_id)==null?void 0:je.value)||"",onChange:t=>d("quickbooks_client_id",t.target.value),placeholder:"Enter QuickBooks Client ID"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Client Secret"}),e.jsx("input",{type:"password",value:((_e=l.quickbooks_client_secret)==null?void 0:_e.value)||"",onChange:t=>d("quickbooks_client_secret",t.target.value),placeholder:(ve=l.quickbooks_client_secret)!=null&&ve.isConfigured?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢":"Enter Client Secret"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Redirect URI"}),e.jsx("input",{type:"text",value:((ge=l.quickbooks_redirect_uri)==null?void 0:ge.value)||"",onChange:t=>d("quickbooks_redirect_uri",t.target.value),placeholder:"https://your-api.com/api/integrations/quickbooks/callback"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Environment"}),e.jsxs("select",{value:((fe=l.quickbooks_environment)==null?void 0:fe.value)||"sandbox",onChange:t=>d("quickbooks_environment",t.target.value),children:[e.jsx("option",{value:"sandbox",children:"Sandbox (Testing)"}),e.jsx("option",{value:"production",children:"Production"})]})]})]})]}),e.jsxs("div",{className:s.integrationCard,children:[e.jsxs("div",{className:s.integrationCardHeader,children:[e.jsx("span",{className:s.integrationIcon,children:"ðŸ“…"}),e.jsxs("div",{children:[e.jsx("h3",{children:"Google Calendar & Drive"}),e.jsxs("p",{children:["Calendar sync and file storage. ",e.jsx("a",{href:"https://console.cloud.google.com/apis/credentials",target:"_blank",rel:"noopener noreferrer",children:"Create credentials in Google Cloud â†’"})]})]})]}),e.jsxs("div",{className:s.integrationFields,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Client ID"}),e.jsx("input",{type:"text",value:((Ne=l.google_client_id)==null?void 0:Ne.value)||"",onChange:t=>d("google_client_id",t.target.value),placeholder:"Enter Google Client ID"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Client Secret"}),e.jsx("input",{type:"password",value:((be=l.google_client_secret)==null?void 0:be.value)||"",onChange:t=>d("google_client_secret",t.target.value),placeholder:(Ce=l.google_client_secret)!=null&&Ce.isConfigured?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢":"Enter Client Secret"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Redirect URI"}),e.jsx("input",{type:"text",value:((ye=l.google_redirect_uri)==null?void 0:ye.value)||"",onChange:t=>d("google_redirect_uri",t.target.value),placeholder:"https://your-api.com/api/integrations/google/callback"})]})]})]}),e.jsxs("div",{className:s.integrationCard,children:[e.jsxs("div",{className:s.integrationCardHeader,children:[e.jsx("span",{className:s.integrationIcon,children:"ðŸ“¦"}),e.jsxs("div",{children:[e.jsx("h3",{children:"Dropbox"}),e.jsxs("p",{children:["Cloud file storage. ",e.jsx("a",{href:"https://www.dropbox.com/developers/apps",target:"_blank",rel:"noopener noreferrer",children:"Create app in Dropbox App Console â†’"})]})]})]}),e.jsxs("div",{className:s.integrationFields,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Client ID (App Key)"}),e.jsx("input",{type:"text",value:((Se=l.dropbox_client_id)==null?void 0:Se.value)||"",onChange:t=>d("dropbox_client_id",t.target.value),placeholder:"Enter Dropbox App Key"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Client Secret (App Secret)"}),e.jsx("input",{type:"password",value:((ke=l.dropbox_client_secret)==null?void 0:ke.value)||"",onChange:t=>d("dropbox_client_secret",t.target.value),placeholder:(we=l.dropbox_client_secret)!=null&&we.isConfigured?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢":"Enter App Secret"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Redirect URI"}),e.jsx("input",{type:"text",value:((Ie=l.dropbox_redirect_uri)==null?void 0:Ie.value)||"",onChange:t=>d("dropbox_redirect_uri",t.target.value),placeholder:"https://your-api.com/api/integrations/dropbox/callback"})]})]})]}),e.jsxs("div",{className:s.integrationCard,children:[e.jsxs("div",{className:s.integrationCardHeader,children:[e.jsx("span",{className:s.integrationIcon,children:"âœï¸"}),e.jsxs("div",{children:[e.jsx("h3",{children:"DocuSign"}),e.jsxs("p",{children:["E-signatures and document signing. ",e.jsx("a",{href:"https://admindemo.docusign.com/apps-and-keys",target:"_blank",rel:"noopener noreferrer",children:"Get keys from DocuSign Admin â†’"})]})]})]}),e.jsxs("div",{className:s.integrationFields,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Integration Key (Client ID)"}),e.jsx("input",{type:"text",value:((Be=l.docusign_client_id)==null?void 0:Be.value)||"",onChange:t=>d("docusign_client_id",t.target.value),placeholder:"Enter DocuSign Integration Key"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Secret Key"}),e.jsx("input",{type:"password",value:((Fe=l.docusign_client_secret)==null?void 0:Fe.value)||"",onChange:t=>d("docusign_client_secret",t.target.value),placeholder:(Me=l.docusign_client_secret)!=null&&Me.isConfigured?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢":"Enter Secret Key"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Redirect URI"}),e.jsx("input",{type:"text",value:((ze=l.docusign_redirect_uri)==null?void 0:ze.value)||"",onChange:t=>d("docusign_redirect_uri",t.target.value),placeholder:"https://your-api.com/api/integrations/docusign/callback"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Environment"}),e.jsxs("select",{value:((Ae=l.docusign_environment)==null?void 0:Ae.value)||"demo",onChange:t=>d("docusign_environment",t.target.value),children:[e.jsx("option",{value:"demo",children:"Demo (Testing)"}),e.jsx("option",{value:"production",children:"Production"})]})]})]})]}),e.jsxs("div",{className:s.integrationCard,children:[e.jsxs("div",{className:s.integrationCardHeader,children:[e.jsx("span",{className:s.integrationIcon,children:"ðŸ’¬"}),e.jsxs("div",{children:[e.jsx("h3",{children:"Slack"}),e.jsxs("p",{children:["Team notifications and messaging. ",e.jsx("a",{href:"https://api.slack.com/apps",target:"_blank",rel:"noopener noreferrer",children:"Create app in Slack API â†’"})]})]})]}),e.jsxs("div",{className:s.integrationFields,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Client ID"}),e.jsx("input",{type:"text",value:((Ee=l.slack_client_id)==null?void 0:Ee.value)||"",onChange:t=>d("slack_client_id",t.target.value),placeholder:"Enter Slack Client ID"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Client Secret"}),e.jsx("input",{type:"password",value:((Ge=l.slack_client_secret)==null?void 0:Ge.value)||"",onChange:t=>d("slack_client_secret",t.target.value),placeholder:(Re=l.slack_client_secret)!=null&&Re.isConfigured?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢":"Enter Client Secret"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Redirect URI"}),e.jsx("input",{type:"text",value:((He=l.slack_redirect_uri)==null?void 0:He.value)||"",onChange:t=>d("slack_redirect_uri",t.target.value),placeholder:"https://your-api.com/api/integrations/slack/callback"})]})]})]}),e.jsxs("div",{className:s.integrationCard,children:[e.jsxs("div",{className:s.integrationCardHeader,children:[e.jsx("span",{className:s.integrationIcon,children:"ðŸ“¹"}),e.jsxs("div",{children:[e.jsx("h3",{children:"Zoom"}),e.jsxs("p",{children:["Video meetings. ",e.jsx("a",{href:"https://marketplace.zoom.us/develop/create",target:"_blank",rel:"noopener noreferrer",children:"Create app in Zoom Marketplace â†’"})]})]})]}),e.jsxs("div",{className:s.integrationFields,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Client ID"}),e.jsx("input",{type:"text",value:((De=l.zoom_client_id)==null?void 0:De.value)||"",onChange:t=>d("zoom_client_id",t.target.value),placeholder:"Enter Zoom Client ID"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Client Secret"}),e.jsx("input",{type:"password",value:((Le=l.zoom_client_secret)==null?void 0:Le.value)||"",onChange:t=>d("zoom_client_secret",t.target.value),placeholder:(Ue=l.zoom_client_secret)!=null&&Ue.isConfigured?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢":"Enter Client Secret"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Redirect URI"}),e.jsx("input",{type:"text",value:((Te=l.zoom_redirect_uri)==null?void 0:Te.value)||"",onChange:t=>d("zoom_redirect_uri",t.target.value),placeholder:"https://your-api.com/api/integrations/zoom/callback"})]})]})]}),e.jsxs("div",{className:s.integrationCard,children:[e.jsxs("div",{className:s.integrationCardHeader,children:[e.jsx("span",{className:s.integrationIcon,children:"ðŸ’°"}),e.jsxs("div",{children:[e.jsx("h3",{children:"Quicken"}),e.jsxs("p",{children:["Personal finance and accounting. ",e.jsx("a",{href:"https://developer.intuit.com/",target:"_blank",rel:"noopener noreferrer",children:"Register via Intuit Developer â†’"})]})]})]}),e.jsxs("div",{className:s.integrationFields,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Client ID"}),e.jsx("input",{type:"text",value:((qe=l.quicken_client_id)==null?void 0:qe.value)||"",onChange:t=>d("quicken_client_id",t.target.value),placeholder:"Enter Quicken Client ID"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Client Secret"}),e.jsx("input",{type:"password",value:((Oe=l.quicken_client_secret)==null?void 0:Oe.value)||"",onChange:t=>d("quicken_client_secret",t.target.value),placeholder:(Ve=l.quicken_client_secret)!=null&&Ve.isConfigured?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢":"Enter Client Secret"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Redirect URI"}),e.jsx("input",{type:"text",value:(($e=l.quicken_redirect_uri)==null?void 0:$e.value)||"",onChange:t=>d("quicken_redirect_uri",t.target.value),placeholder:"https://your-api.com/api/integrations/quicken/callback"})]})]})]}),e.jsx("div",{className:s.integrationActions,children:e.jsxs("button",{className:s.saveBtn,onClick:ms,disabled:ie,children:[e.jsx(rs,{size:18}),ie?"Saving...":"Save All Settings"]})})]}),cs&&e.jsx(Ca,{firm:P,onClose:()=>U(!1),onSave:async t=>{P?await b.updateFirm(P.id,t):await b.createFirm(t),F(),U(!1)}}),os&&e.jsx(ya,{user:Z,firms:h,onClose:()=>T(!1),onSave:async t=>{Z?await b.updateUser(Z.id,t):await b.createUser(t),F(),T(!1)}}),ds&&w&&e.jsx("div",{className:s.modalOverlay,onClick:()=>{(a==null?void 0:a.status)!=="running"&&A(!1)},children:e.jsxs("div",{className:s.scanModal,onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:s.scanModalHeader,children:[e.jsxs("h3",{children:[e.jsx(ns,{size:20}),"Document Scan",(a==null?void 0:a.scanMode)&&e.jsx("span",{className:s.scanModeBadge,children:a.scanMode==="manifest"?"API Migration":"Folder Scan"})]}),(a==null?void 0:a.status)!=="running"&&e.jsx("button",{className:s.modalClose,onClick:()=>A(!1),children:e.jsx(D,{size:18})})]}),e.jsxs("div",{className:s.scanModalBody,children:[e.jsxs("div",{className:s.scanPhase,children:[e.jsx("span",{className:s.phaseLabel,children:"Status:"}),e.jsxs("span",{className:y(s.phaseValue,{[s.phaseRunning]:(a==null?void 0:a.status)==="running",[s.phaseCompleted]:(a==null?void 0:a.status)==="completed",[s.phaseError]:(a==null?void 0:a.status)==="error",[s.phaseCancelled]:(a==null?void 0:a.status)==="cancelled"}),children:[(a==null?void 0:a.status)==="running"&&e.jsx(as,{size:14,className:s.spinnerSmall}),(a==null?void 0:a.status)==="completed"&&e.jsx(K,{size:14}),(a==null?void 0:a.status)==="error"&&e.jsx(W,{size:14}),js((a==null?void 0:a.phase)||(a==null?void 0:a.status)||"initializing")]})]}),e.jsxs("div",{className:s.progressContainer,children:[e.jsx("div",{className:s.progressBar,children:e.jsx("div",{className:s.progressFill,style:{width:`${((Qe=a==null?void 0:a.progress)==null?void 0:Qe.percent)||0}%`}})}),e.jsxs("span",{className:s.progressPercent,children:[Math.round(((Ke=a==null?void 0:a.progress)==null?void 0:Ke.percent)||0),"%"]})]}),e.jsxs("div",{className:s.scanStats,children:[e.jsxs("div",{className:s.scanStat,children:[e.jsx("span",{className:s.statLabel,children:"Files Processed"}),e.jsx("span",{className:s.statValue,children:((We=a==null?void 0:a.progress)==null?void 0:We.processed)||0})]}),e.jsxs("div",{className:s.scanStat,children:[e.jsx("span",{className:s.statLabel,children:"Matched to Matters"}),e.jsx("span",{className:s.statValue,children:((Je=a==null?void 0:a.progress)==null?void 0:Je.matched)||0})]}),e.jsxs("div",{className:s.scanStat,children:[e.jsx("span",{className:s.statLabel,children:"Records Created"}),e.jsx("span",{className:s.statValue,children:((Pe=a==null?void 0:a.progress)==null?void 0:Pe.created)||0})]}),e.jsxs("div",{className:s.scanStat,children:[e.jsx("span",{className:s.statLabel,children:"Total Found"}),e.jsx("span",{className:s.statValue,children:((Ze=a==null?void 0:a.progress)==null?void 0:Ze.total)||0})]})]}),(a==null?void 0:a.error)&&e.jsxs("div",{className:s.scanError,children:[e.jsx(W,{size:16}),a.error]}),e.jsxs("div",{className:s.scanTiming,children:[e.jsxs("span",{children:["Started: ",a!=null&&a.startedAt?R(H(a.startedAt),"h:mm:ss a"):"-"]}),(a==null?void 0:a.completedAt)&&e.jsxs("span",{children:["Completed: ",R(H(a.completedAt),"h:mm:ss a")]})]})]}),e.jsxs("div",{className:s.scanModalFooter,children:[(a==null?void 0:a.status)==="running"&&e.jsxs("button",{className:s.cancelScanBtn,onClick:()=>gs(w),children:[e.jsx(Is,{size:16}),"Cancel Scan"]}),((a==null?void 0:a.status)==="error"||(a==null?void 0:a.status)==="cancelled")&&e.jsxs("button",{className:s.resetScanBtn,onClick:()=>fs(w),children:[e.jsx(Bs,{size:16}),"Reset & Try Again"]}),(a==null?void 0:a.status)==="completed"&&e.jsxs("button",{className:s.closeScanBtn,onClick:()=>A(!1),children:[e.jsx(K,{size:16}),"Done"]})]})]})}),us&&k&&e.jsx("div",{className:s.modalOverlay,onClick:()=>E(!1),children:e.jsxs("div",{className:s.settingsModal,onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:s.scanModalHeader,children:[e.jsxs("h3",{children:[e.jsx(is,{size:20}),"Scan Settings & History"]}),e.jsx("button",{className:s.modalClose,onClick:()=>E(!1),children:e.jsx(D,{size:18})})]}),e.jsxs("div",{className:s.settingsContent,children:[e.jsxs("div",{className:s.settingsSection,children:[e.jsx("h4",{children:"Auto-Sync Settings"}),e.jsx("div",{className:s.settingRow,children:e.jsxs("label",{className:s.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:N.autoSyncEnabled,onChange:t=>Q(i=>({...i,autoSyncEnabled:t.target.checked}))}),e.jsx("span",{children:"Enable automatic sync"})]})}),e.jsxs("div",{className:s.settingRow,children:[e.jsx("label",{children:"Sync Interval"}),e.jsxs("select",{value:N.syncInterval,onChange:t=>Q(i=>({...i,syncInterval:parseInt(t.target.value)})),disabled:!N.autoSyncEnabled,children:[e.jsx("option",{value:5,children:"Every 5 minutes"}),e.jsx("option",{value:10,children:"Every 10 minutes"}),e.jsx("option",{value:30,children:"Every 30 minutes"}),e.jsx("option",{value:60,children:"Every hour"}),e.jsx("option",{value:360,children:"Every 6 hours"}),e.jsx("option",{value:1440,children:"Daily"})]})]})]}),e.jsxs("div",{className:s.settingsSection,children:[e.jsx("h4",{children:"Permission Settings"}),e.jsxs("div",{className:s.settingRow,children:[e.jsx("label",{children:"Permission Mode"}),e.jsxs("select",{value:N.permissionMode,onChange:t=>Q(i=>({...i,permissionMode:t.target.value})),children:[e.jsx("option",{value:"inherit",children:"Inherit from folder"}),e.jsx("option",{value:"matter",children:"Based on matter assignments"}),e.jsx("option",{value:"strict",children:"Strict - owner only"})]})]}),e.jsxs("p",{className:s.settingHint,children:[N.permissionMode==="inherit"&&"Documents inherit permissions from their parent folder.",N.permissionMode==="matter"&&"Documents are accessible by users assigned to the matter.",N.permissionMode==="strict"&&"Only the document owner and admins can access."]})]}),e.jsxs("div",{className:s.historySection,children:[e.jsxs("div",{className:s.historyHeader,children:[e.jsxs("h4",{children:[e.jsx(Fs,{size:16}),"Scan History"]}),e.jsx("button",{className:s.refreshHistoryBtn,onClick:()=>de(k),children:e.jsx(Ms,{size:14})})]}),re.length===0?e.jsx("p",{className:s.noHistory,children:"No scan history available"}):e.jsx("div",{className:s.historyTable,children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Mode"}),e.jsx("th",{children:"Processed"}),e.jsx("th",{children:"Created"})]})}),e.jsx("tbody",{children:re.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:R(H(t.startedAt),"MMM d, h:mm a")}),e.jsx("td",{children:e.jsx("span",{className:y(s.historyStatus,{[s.statusCompleted]:t.status==="completed",[s.statusError]:t.status==="error",[s.statusCancelled]:t.status==="cancelled"}),children:t.status})}),e.jsx("td",{children:t.scanMode}),e.jsx("td",{children:t.filesProcessed}),e.jsx("td",{children:t.filesCreated})]},t.id))})]})})]})]}),e.jsxs("div",{className:s.scanModalFooter,children:[e.jsx("button",{className:s.cancelScanBtn,onClick:()=>E(!1),children:"Cancel"}),e.jsxs("button",{className:s.closeScanBtn,onClick:Ns,children:[e.jsx(rs,{size:14}),"Save Settings"]})]})]})})]});function js(t){return{initializing:"Initializing...",starting:"Starting scan...",checking_azure:"Checking Azure connection...",checking_manifest:"Checking for manifest data...",loading_matters:"Loading matters...",scanning_azure:"Scanning Azure files...",processing_manifest:"Processing manifest...",processing_files:"Processing files...",creating_records:"Creating database records...",setting_permissions:"Setting permissions...",completed:"Completed",error:"Error",cancelled:"Cancelled",running:"Running...",idle:"Idle"}[t]||t.replace(/_/g," ").replace(/\b\w/g,m=>m.toUpperCase())}async function _s(t){if(confirm("Are you sure you want to delete this firm? This will delete all users, matters, clients, and data associated with this firm."))try{await b.deleteFirm(t),F()}catch(i){g.error("Failed to delete firm",i.message)}}async function vs(t){O(t),V(null),A(!0),$({status:"starting",phase:"initializing",progress:{processed:0,matched:0,created:0,total:0,percent:0},results:null,error:null,startedAt:new Date().toISOString()});try{const i=await C(`/firms/${t}/scan-documents`,{method:"POST",body:JSON.stringify({dryRun:!1,mode:"auto"})});(i.status==="started"||i.status==="already_running")&&(B.current=setInterval(()=>ce(t),1e3),ce(t))}catch(i){$(m=>m?{...m,status:"error",error:i.message||"Failed to start scan"}:null),V({firmId:t,message:i.message||"Scan failed",success:!1}),O(null)}}async function gs(t){try{await C(`/firms/${t}/scan-cancel`,{method:"POST"})}catch(i){console.error("Failed to cancel scan:",i)}}async function fs(t){try{await C(`/firms/${t}/scan-reset`,{method:"POST"}),$(null),O(null),A(!1)}catch(i){console.error("Failed to reset scan:",i)}}async function de(t){J(t),E(!0);try{const[i,m]=await Promise.all([C(`/firms/${t}/scan-settings`),C(`/firms/${t}/scan-history?limit=10`)]);Q({autoSyncEnabled:i.autoSyncEnabled,syncInterval:i.syncIntervalMinutes,permissionMode:i.permissionMode}),hs(m.history||[])}catch(i){console.error("Failed to load scan settings:",i)}}async function Ns(){if(k)try{await C(`/firms/${k}/scan-settings`,{method:"PUT",body:JSON.stringify({autoSyncEnabled:N.autoSyncEnabled,syncIntervalMinutes:N.syncInterval,permissionMode:N.permissionMode})}),E(!1)}catch(t){console.error("Failed to save scan settings:",t),g.info("Failed to save settings: "+t.message)}}async function bs(t){if(confirm("Are you sure you want to delete this user?"))try{await b.deleteUser(t),F()}catch(i){g.error("Failed to delete user",i.message)}}}function Ca({firm:n,onClose:g,onSave:x}){const _=ee(),[h,c]=r.useState({name:(n==null?void 0:n.name)||"",email:(n==null?void 0:n.email)||"",phone:(n==null?void 0:n.phone)||"",address:(n==null?void 0:n.address)||"",city:(n==null?void 0:n.city)||"",state:(n==null?void 0:n.state)||"",zipCode:(n==null?void 0:n.zipCode)||"",website:(n==null?void 0:n.website)||""}),[p,S]=r.useState(!1),v=async u=>{u.preventDefault(),S(!0);try{await x(h)}catch(M){_.error("Failed to save firm",M.message)}finally{S(!1)}};return e.jsx("div",{className:s.modalOverlay,onClick:g,children:e.jsxs("div",{className:s.modal,onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:s.modalHeader,children:[e.jsx("h2",{children:n?"Edit Firm":"Add New Firm"}),e.jsx("button",{onClick:g,children:e.jsx(D,{size:20})})]}),e.jsxs("form",{onSubmit:v,children:[e.jsxs("div",{className:s.formGrid,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Firm Name *"}),e.jsx("input",{type:"text",value:h.name,onChange:u=>c({...h,name:u.target.value}),required:!0})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Email"}),e.jsx("input",{type:"email",value:h.email,onChange:u=>c({...h,email:u.target.value})})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Phone"}),e.jsx("input",{type:"text",value:h.phone,onChange:u=>c({...h,phone:u.target.value})})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Website"}),e.jsx("input",{type:"text",value:h.website,onChange:u=>c({...h,website:u.target.value})})]}),e.jsxs("div",{className:s.formGroup+" "+s.fullWidth,children:[e.jsx("label",{children:"Address"}),e.jsx("input",{type:"text",value:h.address,onChange:u=>c({...h,address:u.target.value})})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"City"}),e.jsx("input",{type:"text",value:h.city,onChange:u=>c({...h,city:u.target.value})})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"State"}),e.jsx("input",{type:"text",value:h.state,onChange:u=>c({...h,state:u.target.value})})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"ZIP Code"}),e.jsx("input",{type:"text",value:h.zipCode,onChange:u=>c({...h,zipCode:u.target.value})})]})]}),e.jsxs("div",{className:s.modalActions,children:[e.jsx("button",{type:"button",onClick:g,className:s.cancelBtn,children:"Cancel"}),e.jsx("button",{type:"submit",className:s.saveBtn,disabled:p,children:p?"Saving...":n?"Update Firm":"Create Firm"})]})]})]})})}function ya({user:n,firms:g,onClose:x,onSave:_}){var z;const h=ee(),[c,p]=r.useState({firmId:(n==null?void 0:n.firmId)||"",email:(n==null?void 0:n.email)||"",password:"",firstName:(n==null?void 0:n.firstName)||"",lastName:(n==null?void 0:n.lastName)||"",role:(n==null?void 0:n.role)||"staff",phone:(n==null?void 0:n.phone)||"",hourlyRate:((z=n==null?void 0:n.hourlyRate)==null?void 0:z.toString())||"",isActive:(n==null?void 0:n.isActive)??!0}),[S,v]=r.useState(!1),[u,M]=r.useState(!1),L=async o=>{o.preventDefault(),v(!0);try{const j={...c};j.hourlyRate&&(j.hourlyRate=parseFloat(j.hourlyRate)),j.password||delete j.password,await _(j)}catch(j){h.error("Failed to save user",j.message)}finally{v(!1)}};return e.jsx("div",{className:s.modalOverlay,onClick:x,children:e.jsxs("div",{className:s.modal,onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{className:s.modalHeader,children:[e.jsx("h2",{children:n?"Edit User":"Add New User"}),e.jsx("button",{onClick:x,children:e.jsx(D,{size:20})})]}),e.jsxs("form",{onSubmit:L,children:[e.jsxs("div",{className:s.formGrid,children:[e.jsxs("div",{className:s.formGroup+" "+s.fullWidth,children:[e.jsx("label",{children:"Firm *"}),e.jsxs("select",{value:c.firmId,onChange:o=>p({...c,firmId:o.target.value}),required:!0,disabled:!!n,children:[e.jsx("option",{value:"",children:"Select a firm"}),g.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"First Name *"}),e.jsx("input",{type:"text",value:c.firstName,onChange:o=>p({...c,firstName:o.target.value}),required:!0})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Last Name *"}),e.jsx("input",{type:"text",value:c.lastName,onChange:o=>p({...c,lastName:o.target.value}),required:!0})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Email *"}),e.jsx("input",{type:"email",value:c.email,onChange:o=>p({...c,email:o.target.value}),required:!0})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:n?"New Password (leave blank to keep)":"Password *"}),e.jsxs("div",{className:s.passwordInput,children:[e.jsx("input",{type:u?"text":"password",value:c.password,onChange:o=>p({...c,password:o.target.value}),required:!n}),e.jsx("button",{type:"button",onClick:()=>M(!u),children:u?e.jsx(zs,{size:16}):e.jsx(As,{size:16})})]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Role"}),e.jsxs("select",{value:c.role,onChange:o=>p({...c,role:o.target.value}),children:[e.jsx("option",{value:"owner",children:"Owner"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"attorney",children:"Attorney"}),e.jsx("option",{value:"paralegal",children:"Paralegal"}),e.jsx("option",{value:"staff",children:"Staff"}),e.jsx("option",{value:"billing",children:"Billing"}),e.jsx("option",{value:"readonly",children:"Read Only"})]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Phone"}),e.jsx("input",{type:"text",value:c.phone,onChange:o=>p({...c,phone:o.target.value})})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Hourly Rate"}),e.jsx("input",{type:"number",step:"0.01",value:c.hourlyRate,onChange:o=>p({...c,hourlyRate:o.target.value})})]}),n&&e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{value:c.isActive?"active":"inactive",onChange:o=>p({...c,isActive:o.target.value==="active"}),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:s.modalActions,children:[e.jsx("button",{type:"button",onClick:x,className:s.cancelBtn,children:"Cancel"}),e.jsx("button",{type:"submit",className:s.saveBtn,disabled:S,children:S?"Saving...":n?"Update User":"Create User"})]})]})]})})}export{Ea as AdminPortalPage};
