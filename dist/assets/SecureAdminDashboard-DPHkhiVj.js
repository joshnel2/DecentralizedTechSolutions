import{r as o,a6 as e}from"./vendor-DrKzkH4x.js";import{d as ea}from"./index-CCWWoMiH.js";import{a as sa}from"./router-CNLU_KyZ.js";import{C as ue,a as Ne,a4 as ta,$ as ra,J as re,R as E,af as ia,O as Gi,Z as we,s as Qs,a0 as Q,y as V,U as K,aJ as qe,a3 as ie,a6 as he,Q as Vi,bD as na,x as ws,F as Je,ay as Ks,am as ae,aX as O,o as xe,ao as ks,M as ke,aj as Qi,ak as Ki,c as aa,d as oa,bE as la,as as Qe,ag as ca,bC as Fs,az as Ys,v as qi,E as da,f as Ke,bF as Xs,aB as Zs,X as Is,A as zs,S as ma,bB as Ji}from"./icons-BtUkkwGS.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";import"./state-72d44OIA.js";const pa="_container_1nn15_1",ua="_notification_1nn15_10",ha="_slideIn_1nn15_1",xa="_success_1nn15_26",ga="_error_1nn15_32",ja="_header_1nn15_65",fa="_headerLeft_1nn15_77",va="_logo_1nn15_83",ya="_securityIndicator_1nn15_96",_a="_headerRight_1nn15_109",ba="_sessionTimer_1nn15_115",Sa="_refreshBtn_1nn15_128",Ca="_logoutBtn_1nn15_143",Na="_mainContainer_1nn15_163",wa="_sidebar_1nn15_169",ka="_sidebarNav_1nn15_177",Fa="_navItem_1nn15_184",Ia="_active_1nn15_206",za="_navBadge_1nn15_215",Ba="_navDivider_1nn15_229",Aa="_mainContent_1nn15_236",Ea="_pageTitle_1nn15_242",Ta="_pageSubtitle_1nn15_256",Da="_loading_1nn15_262",Ra="_spinner_1nn15_272",La="_spin_1nn15_272",Pa="_spinning_1nn15_276",$a="_storageTab_1nn15_285",Ua="_overviewTab_1nn15_290",Oa="_metricsGrid_1nn15_294",Ma="_metricCard_1nn15_301",Wa="_metricIcon_1nn15_311",Ha="_metricContent_1nn15_321",Ga="_metricValue_1nn15_327",Va="_metricLabel_1nn15_334",qa="_metricTrend_1nn15_339",Ja="_metricSubtext_1nn15_348",Qa="_secondaryStats_1nn15_354",Ka="_statItem_1nn15_364",Ya="_recentGrid_1nn15_376",Xa="_recentCard_1nn15_383",Za="_recentList_1nn15_397",eo="_recentItem_1nn15_403",so="_recentIcon_1nn15_412",to="_recentInfo_1nn15_423",ro="_recentName_1nn15_428",io="_recentMeta_1nn15_438",no="_recentDate_1nn15_444",ao="_topFirmsCard_1nn15_449",oo="_topFirmsList_1nn15_463",lo="_topFirmItem_1nn15_469",co="_topFirmRank_1nn15_478",mo="_topFirmName_1nn15_491",po="_topFirmCount_1nn15_497",uo="_quickOnboardTab_1nn15_503",ho="_onboardForm_1nn15_507",xo="_formSection_1nn15_514",go="_formGrid_1nn15_540",jo="_formActions_1nn15_546",fo="_resultCard_1nn15_552",vo="_resultDetails_1nn15_597",yo="_copyBtn_1nn15_614",_o="_accountToolsTab_1nn15_630",bo="_lookupSection_1nn15_634",So="_lookupInput_1nn15_638",Co="_lookupResult_1nn15_692",No="_userInfoCard_1nn15_698",wo="_userInfoHeader_1nn15_706",ko="_userAvatar_1nn15_714",Fo="_userBasicInfo_1nn15_728",Io="_userBadges_1nn15_741",zo="_badge_1nn15_747",Bo="_inactive_1nn15_763",Ao="_suspended_1nn15_763",Eo="_pending_1nn15_768",To="_role_1nn15_773",Do="_verified_1nn15_778",Ro="_unverified_1nn15_783",Lo="_userDetails_1nn15_788",Po="_detailRow_1nn15_794",$o="_detailLabel_1nn15_801",Uo="_detailValue_1nn15_806",Oo="_actionCards_1nn15_814",Mo="_actionCard_1nn15_814",Wo="_actionContent_1nn15_841",Ho="_statusVerified_1nn15_853",Go="_statusActive_1nn15_853",Vo="_statusUnverified_1nn15_858",qo="_statusInactive_1nn15_858",Jo="_passwordInputWrapper_1nn15_863",Qo="_actionBtn_1nn15_911",Ko="_danger_1nn15_932",Yo="_listTab_1nn15_943",Xo="_listHeader_1nn15_947",Zo="_listActions_1nn15_954",el="_searchBox_1nn15_959",sl="_addBtn_1nn15_990",tl="_primaryBtn_1nn15_1010",rl="_secondaryBtn_1nn15_1035",il="_tableWrapper_1nn15_1056",nl="_table_1nn15_1056",al="_firmName_1nn15_1090",ol="_userName_1nn15_1090",ll="_roleBadge_1nn15_1095",cl="_owner_1nn15_1106",dl="_admin_1nn15_1111",ml="_attorney_1nn15_1116",pl="_paralegal_1nn15_1121",ul="_staff_1nn15_1126",hl="_billing_1nn15_1131",xl="_readonly_1nn15_1136",gl="_actionBadge_1nn15_1141",jl="_ipAddress_1nn15_1151",fl="_actions_1nn15_1157",vl="_viewBtn_1nn15_1162",yl="_editBtn_1nn15_1162",_l="_deleteBtn_1nn15_1162",bl="_emptyState_1nn15_1190",Sl="_modalOverlay_1nn15_1197",Cl="_modal_1nn15_1197",Nl="_modalSubtitle_1nn15_1226",wl="_formGroup_1nn15_1232",kl="_formRow_1nn15_1289",Fl="_passwordInput_1nn15_863",Il="_modalActions_1nn15_1320",zl="_cancelBtn_1nn15_1329",Bl="_saveBtn_1nn15_1346",Al="_migrationContainer_1nn15_1364",El="_migrationSteps_1nn15_1368",Tl="_step_1nn15_1378",Dl="_stepNumber_1nn15_1392",Rl="_stepArrow_1nn15_1404",Ll="_activeStep_1nn15_1408",Pl="_completedStep_1nn15_1419",$l="_migrationInput_1nn15_1430",Ul="_migrationHeader_1nn15_1437",Ol="_templateDownload_1nn15_1455",Ml="_templateBtn_1nn15_1467",Wl="_templateHint_1nn15_1486",Hl="_uploadArea_1nn15_1491",Gl="_fileInput_1nn15_1496",Vl="_uploadLabel_1nn15_1508",ql="_orDivider_1nn15_1533",Jl="_jsonInput_1nn15_1551",Ql="_migrationActions_1nn15_1586",Kl="_aiModeToggle_1nn15_1593",Yl="_modeBtn_1nn15_1606",Xl="_activeMode_1nn15_1626",Zl="_aiLabel_1nn15_1631",ec="_aiTransformSection_1nn15_1643",sc="_aiHeader_1nn15_1647",tc="_aiInputGroup_1nn15_1678",rc="_formatSelect_1nn15_1696",ic="_aiActions_1nn15_1736",nc="_aiTransformBtn_1nn15_1742",ac="_aiFallbackBtn_1nn15_1771",oc="_parseHint_1nn15_1796",lc="_userAiButton_1nn15_1809",cc="_formatUsersBtn_1nn15_1816",dc="_formatHint_1nn15_1841",mc="_migrationSection_1nn15_1847",pc="_sectionHeader_1nn15_1855",uc="_sectionHint_1nn15_1873",hc="_sectionDescription_1nn15_1884",xc="_firmInputGrid_1nn15_1895",gc="_inputField_1nn15_1901",jc="_csvUploadArea_1nn15_1971",fc="_csvUploadLabel_1nn15_1977",vc="_clearBtn_1nn15_1997",yc="_csvPreview_1nn15_2011",_c="_credentialsSection_1nn15_2018",bc="_credentialsHeader_1nn15_2026",Sc="_copyAllBtn_1nn15_2045",Cc="_credentialsNote_1nn15_2064",Nc="_credentialsList_1nn15_2071",wc="_credentialCard_1nn15_2077",kc="_credentialName_1nn15_2084",Fc="_credentialRole_1nn15_2097",Ic="_credentialDetails_1nn15_2106",zc="_credentialRow_1nn15_2112",Bc="_clioConnect_1nn15_2154",Ac="_clioConnected_1nn15_2160",Ec="_connectedBadge_1nn15_2171",Tc="_clioProgress_1nn15_2182",Dc="_progressItem_1nn15_2188",Rc="_done_1nn15_2198",Lc="_running_1nn15_2203",Pc="_skipped_1nn15_2213",$c="_progressLabel_1nn15_2224",Uc="_progressStatus_1nn15_2229",Oc="_clioSummary_1nn15_2257",Mc="_transformResult_1nn15_2323",Wc="_transformHeader_1nn15_2339",Hc="_transformSummary_1nn15_2374",Gc="_summaryItem_1nn15_2381",Vc="_transformNote_1nn15_2392",qc="_jsonPreview_1nn15_2400",Jc="_previewHeader_1nn15_2408",Qc="_jsonPreviewText_1nn15_2443",Kc="_validationResults_1nn15_2461",Yc="_validationHeader_1nn15_2468",Xc="_valid_1nn15_2461",Zc="_invalid_1nn15_2490",ed="_summaryCard_1nn15_2515",sd="_summaryGrid_1nn15_2530",td="_summaryIcon_1nn15_2551",rd="_errorList_1nn15_2555",id="_warningList_1nn15_2555",nd="_importComplete_1nn15_2613",ad="_importHeader_1nn15_2620",od="_failed_1nn15_2644",ld="_importSummary_1nn15_2669",cd="_importGrid_1nn15_2685",dd="_importItem_1nn15_2691",md="_importCount_1nn15_2702",pd="_footer_1nn15_2714",ud="_hipaaNotice_1nn15_2720",hd="_clioDataSummary_1nn15_2730",xd="_dataEditorSection_1nn15_2748",t={container:pa,notification:ua,slideIn:ha,success:xa,error:ga,header:ja,headerLeft:fa,logo:va,securityIndicator:ya,headerRight:_a,sessionTimer:ba,refreshBtn:Sa,logoutBtn:Ca,mainContainer:Na,sidebar:wa,sidebarNav:ka,navItem:Fa,active:Ia,navBadge:za,navDivider:Ba,mainContent:Aa,pageTitle:Ea,pageSubtitle:Ta,loading:Da,spinner:Ra,spin:La,spinning:Pa,storageTab:$a,overviewTab:Ua,metricsGrid:Oa,metricCard:Ma,metricIcon:Wa,metricContent:Ha,metricValue:Ga,metricLabel:Va,metricTrend:qa,metricSubtext:Ja,secondaryStats:Qa,statItem:Ka,recentGrid:Ya,recentCard:Xa,recentList:Za,recentItem:eo,recentIcon:so,recentInfo:to,recentName:ro,recentMeta:io,recentDate:no,topFirmsCard:ao,topFirmsList:oo,topFirmItem:lo,topFirmRank:co,topFirmName:mo,topFirmCount:po,quickOnboardTab:uo,onboardForm:ho,formSection:xo,formGrid:go,formActions:jo,resultCard:fo,resultDetails:vo,copyBtn:yo,accountToolsTab:_o,lookupSection:bo,lookupInput:So,lookupResult:Co,userInfoCard:No,userInfoHeader:wo,userAvatar:ko,userBasicInfo:Fo,userBadges:Io,badge:zo,inactive:Bo,suspended:Ao,pending:Eo,role:To,verified:Do,unverified:Ro,userDetails:Lo,detailRow:Po,detailLabel:$o,detailValue:Uo,actionCards:Oo,actionCard:Mo,actionContent:Wo,statusVerified:Ho,statusActive:Go,statusUnverified:Vo,statusInactive:qo,passwordInputWrapper:Jo,actionBtn:Qo,danger:Ko,listTab:Yo,listHeader:Xo,listActions:Zo,searchBox:el,addBtn:sl,primaryBtn:tl,secondaryBtn:rl,tableWrapper:il,table:nl,firmName:al,userName:ol,roleBadge:ll,owner:cl,admin:dl,attorney:ml,paralegal:pl,staff:ul,billing:hl,readonly:xl,actionBadge:gl,ipAddress:jl,actions:fl,viewBtn:vl,editBtn:yl,deleteBtn:_l,emptyState:bl,modalOverlay:Sl,modal:Cl,modalSubtitle:Nl,formGroup:wl,formRow:kl,passwordInput:Fl,modalActions:Il,cancelBtn:zl,saveBtn:Bl,migrationContainer:Al,migrationSteps:El,step:Tl,stepNumber:Dl,stepArrow:Rl,activeStep:Ll,completedStep:Pl,migrationInput:$l,migrationHeader:Ul,templateDownload:Ol,templateBtn:Ml,templateHint:Wl,uploadArea:Hl,fileInput:Gl,uploadLabel:Vl,orDivider:ql,jsonInput:Jl,migrationActions:Ql,aiModeToggle:Kl,modeBtn:Yl,activeMode:Xl,aiLabel:Zl,aiTransformSection:ec,aiHeader:sc,aiInputGroup:tc,formatSelect:rc,aiActions:ic,aiTransformBtn:nc,aiFallbackBtn:ac,parseHint:oc,userAiButton:lc,formatUsersBtn:cc,formatHint:dc,migrationSection:mc,sectionHeader:pc,sectionHint:uc,sectionDescription:hc,firmInputGrid:xc,inputField:gc,csvUploadArea:jc,csvUploadLabel:fc,clearBtn:vc,csvPreview:yc,credentialsSection:_c,credentialsHeader:bc,copyAllBtn:Sc,credentialsNote:Cc,credentialsList:Nc,credentialCard:wc,credentialName:kc,credentialRole:Fc,credentialDetails:Ic,credentialRow:zc,clioConnect:Bc,clioConnected:Ac,connectedBadge:Ec,clioProgress:Tc,progressItem:Dc,done:Rc,running:Lc,skipped:Pc,progressLabel:$c,progressStatus:Uc,clioSummary:Oc,transformResult:Mc,transformHeader:Wc,transformSummary:Hc,summaryItem:Gc,transformNote:Vc,jsonPreview:qc,previewHeader:Jc,jsonPreviewText:Qc,validationResults:Kc,validationHeader:Yc,valid:Xc,invalid:Zc,summaryCard:ed,summaryGrid:sd,summaryIcon:td,errorList:rd,warningList:id,importComplete:nd,importHeader:ad,failed:od,importSummary:ld,importGrid:cd,importItem:dd,importCount:md,footer:pd,hipaaNotice:ud,clioDataSummary:hd,dataEditorSection:xd},p="https://apexai-api.azurewebsites.net/api",et=()=>sessionStorage.getItem("_sap_auth")||"";function Ed(){var Wt,Ht,Gt,Vt,qt,Jt,Qt,Kt,Yt,Xt,Zt,er,sr,tr,rr,ir,nr,ar,or,lr,cr,dr,mr,pr,ur,hr,xr,gr,jr,fr,vr,yr,_r,br,Sr,Cr,Nr,wr,kr,Fr,Ir,zr,Br,Ar,Er,Tr,Dr,Rr,Lr,Pr,$r,Ur,Or,Mr,Wr,Hr,Gr,Vr,qr,Jr,Qr,Kr,Yr,Xr,Zr,ei,si,ti,ri,ii,ni,ai,oi,li,ci,di,mi,pi,ui,hi,xi,gi,ji,fi,vi,yi,_i,bi,Si,Ci,Ni,wi,ki,Fi,Ii,zi,Bi,Ai,Ei,Ti,Di,Ri,Li,Pi,$i,Ui,Oi,Mi;const f=ea(),[N,R]=o.useState("overview"),[C,w]=o.useState(null),[M,D]=o.useState(!1),[x,Y]=o.useState(null),[b,Fe]=o.useState(""),[se,Yi]=o.useState([]),[Bs,Xi]=o.useState([]),[As,Zi]=o.useState([]),[oe,st]=o.useState(""),[en,tt]=o.useState(!0),[sn,Ie]=o.useState(!1),[tn,Ye]=o.useState(!1),[ze,Be]=o.useState(null),[Ae,Xe]=o.useState(null),[rn,rt]=o.useState(14400),[U,nn]=o.useState(null),[ge,Ee]=o.useState(null),Te=sa(),[L,te]=o.useState({firmName:"",firmDomain:"",firmEmail:"",firmPhone:"",adminEmail:"",adminPassword:"",adminFirstName:"",adminLastName:""}),[it,nt]=o.useState(!1),[X,Ze]=o.useState(null),[Es,at]=o.useState(""),[g,De]=o.useState(null),[ot,lt]=o.useState(!1),[Re,ct]=o.useState(""),[Ts,an]=o.useState(!1),[es,on]=o.useState(""),[Le,dt]=o.useState(""),[q,le]=o.useState(""),[ne,je]=o.useState("input"),[P,Ds]=o.useState(null),[T,ss]=o.useState(null),[fe,ve]=o.useState(!1),[ts,Pe]=o.useState("clio"),[Rs,mt]=o.useState(!0),[fd,ln]=o.useState(""),[vd,cn]=o.useState(""),[rs,pt]=o.useState(""),[is,ut]=o.useState(""),[k,ht]=o.useState(null),[ye,$e]=o.useState(null),[ns,J]=o.useState(!1),[as,dn]=o.useState(()=>sessionStorage.getItem("clio_includeUsers")!=="false"),[os,mn]=o.useState(()=>sessionStorage.getItem("clio_includeContacts")!=="false"),[ls,pn]=o.useState(()=>sessionStorage.getItem("clio_includeMatters")!=="false"),[cs,un]=o.useState(()=>sessionStorage.getItem("clio_includeActivities")!=="false"),[ds,hn]=o.useState(()=>sessionStorage.getItem("clio_includeBills")!=="false"),[ms,xn]=o.useState(()=>sessionStorage.getItem("clio_includeCalendar")!=="false"),[Ue,gn]=o.useState(()=>sessionStorage.getItem("clio_includeDocuments")!=="false"),[ps,jn]=o.useState(()=>sessionStorage.getItem("clio_includeTasks")!=="false"),[us,fn]=o.useState(()=>sessionStorage.getItem("clio_includeNotes")!=="false"),[Oe,vn]=o.useState(()=>sessionStorage.getItem("clio_customAzureFolder")||""),[_e,xt]=o.useState(()=>sessionStorage.getItem("clio_useExistingFirm")==="true"),[hs,Ls]=o.useState(()=>sessionStorage.getItem("clio_existingFirmId")||""),[ce,gt]=o.useState(()=>sessionStorage.getItem("clio_filterByUser")==="true"),[Me,Ps]=o.useState(()=>sessionStorage.getItem("clio_filterUserEmail")||"");o.useEffect(()=>{sessionStorage.setItem("clio_includeUsers",String(as))},[as]),o.useEffect(()=>{sessionStorage.setItem("clio_includeContacts",String(os))},[os]),o.useEffect(()=>{sessionStorage.setItem("clio_includeMatters",String(ls))},[ls]),o.useEffect(()=>{sessionStorage.setItem("clio_includeActivities",String(cs))},[cs]),o.useEffect(()=>{sessionStorage.setItem("clio_includeBills",String(ds))},[ds]),o.useEffect(()=>{sessionStorage.setItem("clio_includeCalendar",String(ms))},[ms]),o.useEffect(()=>{sessionStorage.setItem("clio_includeDocuments",String(Ue))},[Ue]),o.useEffect(()=>{sessionStorage.setItem("clio_includeTasks",String(ps))},[ps]),o.useEffect(()=>{sessionStorage.setItem("clio_includeNotes",String(us))},[us]),o.useEffect(()=>{sessionStorage.setItem("clio_customAzureFolder",Oe)},[Oe]),o.useEffect(()=>{sessionStorage.setItem("clio_useExistingFirm",String(_e))},[_e]),o.useEffect(()=>{sessionStorage.setItem("clio_existingFirmId",hs)},[hs]),o.useEffect(()=>{sessionStorage.setItem("clio_filterByUser",String(ce))},[ce]),o.useEffect(()=>{sessionStorage.setItem("clio_filterUserEmail",Me)},[Me]);const[S,xs]=o.useState(()=>{const s=sessionStorage.getItem("clio_migration_progress");if(s)try{return JSON.parse(s)}catch{return null}return null});o.useEffect(()=>{S&&sessionStorage.setItem("clio_migration_progress",JSON.stringify(S))},[S]),o.useEffect(()=>{const s=new URLSearchParams(window.location.search),r=s.get("clio_connected"),i=s.get("clio_error"),a=s.get("firm"),c=sessionStorage.getItem("_sap_auth");let d=!1;if(c)try{d=JSON.parse(atob(c)).exp>Date.now()}catch{d=!1}if(console.log("[CLIO OAUTH] Callback check - connected:",r,"session valid:",d),r){if(ht(r),R("migration"),Pe("clio"),a&&I(m=>({...m,firmName:decodeURIComponent(a)})),window.history.replaceState({},"",window.location.pathname),!d){console.error("[CLIO OAUTH] Admin session expired during OAuth flow"),n("error","Admin session expired. Please log in again and reconnect to Clio.");return}n("success","Connected to Clio! Starting import..."),yn(r),setTimeout(()=>{console.log("[CLIO OAUTH] Auto-starting import for connection:",r),Kn(r,a?decodeURIComponent(a):"Imported from Clio")},1500)}i&&(R("migration"),Pe("clio"),window.history.replaceState({},"",window.location.pathname),n("error",`Clio connection failed: ${decodeURIComponent(i)}`))},[]);const yn=async s=>{try{const r=await fetch(`${p}/migration/clio/user/${s}`,{headers:h()});if(r.ok){const i=await r.json();i.success&&i.user?$e(i.user):$e({name:"Clio User",email:"Connected via OAuth"})}else $e({name:"Clio User",email:"Connected via OAuth"})}catch(r){console.error("Failed to fetch Clio user:",r),$e({name:"Clio User",email:"Connected via OAuth"})}},[gs,js]=o.useState(!1),[F,be]=o.useState(null),[u,I]=o.useState({firmName:"",firmEmail:"",firmPhone:"",firmAddress:"",users:"",clients:"",matters:"",timeEntries:"",calendarEvents:"",bills:""}),[_n,fs]=o.useState(!1),[z,ee]=o.useState(null),[v,W]=o.useState(null),[j,jt]=o.useState(null),[de,ft]=o.useState(null),[yd,vt]=o.useState(!1),[_d,bd]=o.useState(!1),[Sd,Cd]=o.useState(!1),[Se,yt]=o.useState("overview"),[y,_t]=o.useState(null),[We,bn]=o.useState(null),[vs,bt]=o.useState(!1),[ys,St]=o.useState(!1),[me,_s]=o.useState(null),[He,Ct]=o.useState([]),[$,Nt]=o.useState(null),[wt,kt]=o.useState(!1),[$s,Ft]=o.useState(""),[Us,It]=o.useState(""),[zt,Bt]=o.useState(""),[l,Os]=o.useState({}),[Ms,At]=o.useState(!1),[Sn,Et]=o.useState(!1),Tt=o.useCallback(()=>{const s=sessionStorage.getItem("_sap_auth");if(!s)return Te("/rx760819"),!1;try{return JSON.parse(atob(s)).exp<Date.now()?(sessionStorage.removeItem("_sap_auth"),Te("/rx760819"),!1):!0}catch{return sessionStorage.removeItem("_sap_auth"),Te("/rx760819"),!1}},[Te]);o.useEffect(()=>{const s=setInterval(()=>{rt(r=>r<=1?(Dt(),0):r-1)},1e3);return()=>clearInterval(s)},[]),o.useEffect(()=>{const s=()=>rt(14400);return window.addEventListener("mousemove",s),window.addEventListener("keypress",s),()=>{window.removeEventListener("mousemove",s),window.removeEventListener("keypress",s)}},[]),o.useEffect(()=>{if(ge){const s=setTimeout(()=>Ee(null),5e3);return()=>clearTimeout(s)}},[ge]),o.useEffect(()=>{Tt()&&H()},[Tt]);const n=(s,r)=>{Ee({type:s,message:r})},H=async()=>{tt(!0);try{const s=await fetch(`${p}/secure-admin/firms`,{headers:h()});if(s.ok){const c=await s.json();Yi(c)}const r=await fetch(`${p}/secure-admin/users`,{headers:h()});if(r.ok){const c=await r.json();Xi(c)}const i=await fetch(`${p}/secure-admin/detailed-stats`,{headers:h()});if(i.ok){const c=await i.json();nn(c)}const a=await fetch(`${p}/secure-admin/audit`,{headers:h()});if(a.ok){const c=await a.json();Zi(c)}}catch(s){console.error("Failed to load data:",s)}tt(!1)},h=()=>{const s=localStorage.getItem("token");return{"Content-Type":"application/json",Authorization:s?`Bearer ${s}`:"","X-Admin-Auth":sessionStorage.getItem("_sap_auth")||""}},Dt=()=>{sessionStorage.removeItem("_sap_auth"),console.log(`[AUDIT] Admin logout at ${new Date().toISOString()}`),Te("/rx760819")},Cn=s=>{const r=Math.floor(s/60),i=s%60;return`${r}:${i.toString().padStart(2,"0")}`},Nn=async s=>{s.preventDefault(),nt(!0),Ze(null);try{const r=await fetch(`${p}/secure-admin/quick-onboard`,{method:"POST",headers:h(),body:JSON.stringify(L)}),i=await r.json();r.ok?(Ze({success:!0,message:i.message,firm:i.firm,user:i.user}),n("success",i.message),te({firmName:"",firmDomain:"",firmEmail:"",firmPhone:"",adminEmail:"",adminPassword:"",adminFirstName:"",adminLastName:""}),await H()):(Ze({success:!1,message:i.error}),n("error",i.error))}catch{Ze({success:!1,message:"Failed to complete onboarding"}),n("error","Failed to complete onboarding")}nt(!1)},Rt=async()=>{Et(!0);try{const s=await fetch(`${p}/secure-admin/platform-settings`,{headers:{"X-Admin-Auth":et()}});if(s.ok){const r=await s.json();if(r.settings&&Array.isArray(r.settings)){const i={};r.settings.forEach(a=>{i[a.key]={value:a.value||"",isConfigured:!!a.value,isSecret:a.is_secret}}),Os(i)}else Os(r)}}catch(s){console.error("Failed to load integration settings:",s)}Et(!1)},_=(s,r)=>{Os(i=>({...i,[s]:{...i[s],value:r,isConfigured:!!r}}))},wn=async()=>{At(!0);try{const s=[];if(Object.entries(l).forEach(([i,a])=>{a.value!==void 0&&s.push({key:i,value:a.value})}),(await fetch(`${p}/secure-admin/platform-settings`,{method:"PUT",headers:{"Content-Type":"application/json","X-Admin-Auth":et()},body:JSON.stringify({settings:s})})).ok)Ee({type:"success",message:"Integration settings saved successfully!"}),Rt();else throw new Error("Failed to save")}catch{Ee({type:"error",message:"Failed to save integration settings"})}At(!1)},Ge=async()=>{D(!0);try{const s=await fetch(`${p}/secure-admin/storage-overview`,{headers:h()});if(s.ok){const r=await s.json();w(r)}else n("error","Failed to load storage overview")}catch(s){console.error("Failed to load storage overview:",s),n("error","Failed to load storage overview")}D(!1)},bs=async s=>{try{const r=await fetch(`${p}/secure-admin/firms/${s}/storage`,{headers:h()});if(r.ok){const i=await r.json();Y(i)}else n("error","Failed to load firm storage settings")}catch(r){console.error("Failed to load firm storage:",r),n("error","Failed to load firm storage settings")}},kn=async(s,r,i)=>{try{const a=await fetch(`${p}/secure-admin/firms/${s}/storage`,{method:"PUT",headers:h(),body:JSON.stringify({azureFolder:r,driveSettings:i})});if(a.ok){const c=await a.json();n("success",c.message||"Storage settings updated"),Ge(),bs(s)}else{const c=await a.json();n("error",c.error||"Failed to update storage settings")}}catch(a){console.error("Failed to update firm storage:",a),n("error","Failed to update storage settings")}},Ws=async(s,r,i={})=>{try{const a=await fetch(`${p}/secure-admin/firms/${s}/bulk-permissions`,{method:"POST",headers:h(),body:JSON.stringify({action:r,...i})});if(a.ok){const c=await a.json();n("success",c.message),bs(s),Ge()}else{const c=await a.json();n("error",c.error||"Failed to update permissions")}}catch(a){console.error("Failed to update permissions:",a),n("error","Failed to update permissions")}},Fn=async(s,r)=>{try{const i=await fetch(`${p}/secure-admin/firms/${s}/create-folder`,{method:"POST",headers:h(),body:JSON.stringify({folderName:r})});if(i.ok){const a=await i.json();n("success",a.message),bs(s),Ge()}else{const a=await i.json();n("error",a.error||"Failed to create folder")}}catch(i){console.error("Failed to create folder:",i),n("error","Failed to create folder")}},Ss=async()=>{if(Es.trim()){lt(!0),De(null);try{const s=await fetch(`${p}/secure-admin/account-tools/lookup/${encodeURIComponent(Es)}`,{headers:h()});if(s.ok){const r=await s.json();De(r),dt(r.role)}else{const r=await s.json();n("error",r.error||"User not found")}}catch{n("error","Failed to lookup account")}lt(!1)}},In=async()=>{if(!(!g||!Re))try{const s=await fetch(`${p}/secure-admin/account-tools/reset-password`,{method:"POST",headers:h(),body:JSON.stringify({userId:g.id,newPassword:Re})}),r=await s.json();s.ok?(n("success",r.message),ct("")):n("error",r.error)}catch{n("error","Failed to reset password")}},zn=async()=>{if(g)try{const s=await fetch(`${p}/secure-admin/account-tools/verify-email`,{method:"POST",headers:h(),body:JSON.stringify({userId:g.id})}),r=await s.json();s.ok?(n("success",r.message),De({...g,emailVerified:!0})):n("error",r.error)}catch{n("error","Failed to verify email")}},Bn=async()=>{if(g)try{const s=await fetch(`${p}/secure-admin/account-tools/toggle-status`,{method:"POST",headers:h(),body:JSON.stringify({userId:g.id,isActive:!g.isActive})}),r=await s.json();s.ok?(n("success",r.message),De({...g,isActive:r.isActive}),await H()):n("error",r.error)}catch{n("error","Failed to toggle status")}},An=async()=>{if(!(!g||!Le||Le===g.role))try{const s=await fetch(`${p}/secure-admin/account-tools/change-role`,{method:"POST",headers:h(),body:JSON.stringify({userId:g.id,newRole:Le})}),r=await s.json();s.ok?(n("success",r.message),De({...g,role:r.role}),await H()):n("error",r.error)}catch{n("error","Failed to change role")}},En=async()=>{if(!(!g||!es))try{const s=await fetch(`${p}/secure-admin/account-tools/transfer-firm`,{method:"POST",headers:h(),body:JSON.stringify({userId:g.id,newFirmId:es})}),r=await s.json();s.ok?(n("success",r.message),await Ss(),await H()):n("error",r.error)}catch{n("error","Failed to transfer firm")}},Tn=async s=>{try{const r=ze?`${p}/secure-admin/firms/${ze.id}`:`${p}/secure-admin/firms`;(await fetch(r,{method:ze?"PUT":"POST",headers:h(),body:JSON.stringify(s)})).ok&&(await H(),Ie(!1),Be(null),n("success",ze?"Firm updated successfully":"Firm created successfully"))}catch(r){console.error("Failed to save firm:",r),n("error","Failed to save firm")}},Dn=async s=>{if(confirm("Are you sure you want to delete this firm? This action cannot be undone."))try{const r=await fetch(`${p}/secure-admin/firms/${s}`,{method:"DELETE",headers:h()});if(r.ok)await H(),n("success","Firm deleted successfully");else{const i=await r.json();n("error",i.error||"Failed to delete firm")}}catch(r){console.error("Failed to delete firm:",r),n("error","Failed to delete firm")}},Cs=async s=>{ee(s),W(null),console.log("[SCAN] Starting document scan for firm:",s);try{const i=await(await fetch(`${p}/secure-admin/firms/${s}/scan-documents`,{method:"POST",headers:h()})).json();if(console.log("[SCAN] Initial response:",i),i.status==="already_running")n("success","A scan is already running. Click Reset if stuck."),W({firmId:s,message:"A scan is already running. If stuck, click Reset Scan below.",success:!1}),ee(null);else if(i.status==="started"){n("success","Scan started - this may take a while for large datasets...");const a=setInterval(async()=>{try{const d=await(await fetch(`${p}/secure-admin/firms/${s}/scan-status`,{headers:h()})).json();if(console.log("[SCAN] Status:",d),d.status==="running"){const m=d.progress||{},B=d.phase||"";let A="Processing...";B==="scanning_azure"?A=`Indexing Azure files... ${(m.azureScanned||0).toLocaleString()} found`:B==="matching"?A=`Matching: ${(m.processed||0).toLocaleString()}/${(m.pending||"?").toLocaleString()} (${m.percent||0}%)`:B==="preparing"?A="Preparing database...":B==="finalizing"&&(A="Finalizing..."),W({firmId:s,message:A,success:!0,azureScanned:m.azureScanned,processed:m.processed,matched:m.matched,created:m.created,alreadyMatched:m.alreadyMatched})}else if(d.status==="completed"&&d.results){clearInterval(a),ee(null);const m=d.results;W({firmId:s,message:m.message,success:!0,manifestEntries:m.manifestEntries,azureFiles:m.azureFiles,processed:m.processed,matched:m.matched,created:m.created,skipped:m.skipped,missing:m.missing,withMatter:m.withMatter,withoutMatter:m.withoutMatter,matterMappings:m.matterMappings,matterLookupHits:m.matterLookupHits,matterLookupMisses:m.matterLookupMisses}),n("success",m.message),j&&j.id===s&&Ve(j)}else(d.status==="error"||d.status==="cancelled")&&(clearInterval(a),ee(null),W({firmId:s,message:d.error||`Scan ${d.status}`,success:!1}),n("error",d.error||`Scan ${d.status}`))}catch(c){console.error("[SCAN] Poll error:",c)}},2e3);setTimeout(()=>{clearInterval(a),z===s&&(ee(null),n("error","Scan is taking longer than expected. Check status later."))},30*60*1e3)}else{const a=i.error||"Failed to start scan";W({firmId:s,message:a,success:!1}),n("error",a),ee(null)}}catch(r){console.error("[SCAN] Error:",r);const i=r.message||"Failed to scan documents";W({firmId:s,message:i,success:!1}),n("error",i),ee(null)}},Rn=async s=>{try{(await(await fetch(`${p}/secure-admin/firms/${s}/scan-reset`,{method:"POST",headers:h()})).json()).success&&(W(null),ee(null),n("success","Scan reset. You can start a new scan."))}catch{n("error","Failed to reset scan")}},Ln=async s=>{if(!s){n("error","No firm selected");return}ee(s),W(null),console.log("[RESCAN] Starting rescan of unmatched documents for firm:",s);try{const r=await fetch(`${p}/secure-admin/firms/${s}/rescan-unmatched`,{method:"POST",headers:h()});console.log("[RESCAN] Response status:",r.status);let i;try{i=await r.json()}catch(a){throw console.error("[RESCAN] Failed to parse response as JSON:",a),new Error("Server returned an invalid response. Please try again.")}if(console.log("[RESCAN] Response data:",i),r.ok&&i.success){const a={firmId:s,message:i.message,success:!0,checked:i.checked,matched:i.matched,stillUnmatched:i.stillUnmatched,withMatter:i.withMatter,withoutMatter:i.withoutMatter};W(a),n("success",i.message),j&&j.id===s&&Ve(j)}else{let a=i.error||i.message||"Rescan failed";r.status===401?a="Session expired. Please log in again.":r.status===404?a="Firm not found. Please refresh the page.":r.status===500&&(a=i.details?`Error: ${i.error} (${i.details})`:i.error||"Server error occurred"),W({firmId:s,message:a,success:!1}),n("error",a)}}catch(r){console.error("[RESCAN] Error:",r);let i="Failed to rescan documents";r.message&&(r.message.includes("Failed to fetch")||r.message.includes("NetworkError")?i="Network error. Please check your connection and try again.":i=r.message),W({firmId:s,message:i,success:!1}),n("error",i)}finally{ee(null)}},Ve=async s=>{jt(s),yt("overview"),kt(!0),vt(!0),Ct([]),Nt(null),ft(null);try{const[r,i,a]=await Promise.all([fetch(`${p}/secure-admin/firms/${s.id}/users`,{headers:h()}),fetch(`${p}/secure-admin/firms/${s.id}/stats`,{headers:h()}),fetch(`${p}/migration/documents/manifest/${s.id}`,{headers:h()})]);if(r.ok){const c=await r.json();Ct(c.users||c||[])}if(i.ok){const c=await i.json();Nt(c)}if(a.ok){const c=await a.json();ft(c)}try{const c=await fetch(`${p}/migration/documents/stream-status/${s.id}`,{headers:h()});if(c.ok){const d=await c.json();d.success&&_t(d.status)}}catch(c){console.log("Streaming status not available:",c)}}catch(r){console.error("Failed to load firm data:",r)}kt(!1),vt(!1)},Hs=async s=>{var r;try{const a=await(await fetch(`${p}/migration/documents/stream-status/${s}`,{headers:h()})).json();a.success&&(_t(a.status),a.azureStorage&&bn({account:a.azureStorage.account,share:a.azureStorage.share,fullPath:a.azureStorage.fullPath,firmFolder:((r=a.firmInfo)==null?void 0:r.azureFolder)||`firm-${s}`}))}catch(i){console.error("Failed to fetch streaming status:",i)}},Pn=async()=>{if(!j||!k){n("error","Please connect to Clio first from the Migration tab");return}bt(!0);try{const r=await(await fetch(`${p}/migration/documents/fetch-manifest`,{method:"POST",headers:h(),body:JSON.stringify({firmId:j.id,connectionId:k})})).json();r.success?(n("success",r.message),await Hs(j.id)):n("error",r.error||"Failed to fetch manifest")}catch{n("error","Failed to fetch document manifest from Clio")}bt(!1)},$n=async()=>{if(!j||!k){n("error","Please connect to Clio first from the Migration tab");return}St(!0),_s({status:"starting",processed:0,total:(y==null?void 0:y.pending)||0});try{const r=await(await fetch(`${p}/migration/documents/stream-to-azure`,{method:"POST",headers:h(),body:JSON.stringify({firmId:j.id,connectionId:k,batchSize:5,customFirmFolder:Oe.trim()||null})})).json();r.success?(n("success",r.message),_s({status:"complete",processed:r.success+r.failed,total:r.success+r.failed,success:r.success,failed:r.failed}),await Hs(j.id),Ve(j)):(n("error",r.error||"Streaming failed"),_s({status:"error"}))}catch{n("error","Failed to stream documents"),_s({status:"error"})}St(!1)},Un=async()=>{if(j)try{const r=await(await fetch(`${p}/migration/documents/reset-failed`,{method:"POST",headers:h(),body:JSON.stringify({firmId:j.id})})).json();r.success?(n("success",r.message),await Hs(j.id)):n("error",r.error||"Reset failed")}catch{n("error","Failed to reset documents")}},On=async()=>{if(j)try{const r=await(await fetch(`${p}/migration/documents/sync-permissions`,{method:"POST",headers:h(),body:JSON.stringify({firmId:j.id})})).json();r.success?n("success",r.message):n("error",r.error||"Sync failed")}catch{n("error","Failed to sync permissions")}},Mn=async s=>{try{const r=Ae?`${p}/secure-admin/users/${Ae.id}`:`${p}/secure-admin/users`;(await fetch(r,{method:Ae?"PUT":"POST",headers:h(),body:JSON.stringify(s)})).ok&&(await H(),Ye(!1),Xe(null),n("success",Ae?"User updated successfully":"User created successfully"))}catch(r){console.error("Failed to save user:",r),n("error","Failed to save user")}},Wn=async s=>{if(confirm("Are you sure you want to delete this user? This action cannot be undone."))try{(await fetch(`${p}/secure-admin/users/${s}`,{method:"DELETE",headers:h()})).ok&&(await H(),n("success","User deleted successfully"))}catch(r){console.error("Failed to delete user:",r),n("error","Failed to delete user")}},Hn=async()=>{if(!$s.trim()||!Us){n("error","Please provide users and select a firm");return}try{const r=$s.trim().split(`
`).map(c=>{const d=c.split(",").map(m=>m.trim());return{email:d[0],firstName:d[1],lastName:d[2],role:d[3]||"attorney"}}).filter(c=>c.email&&c.firstName&&c.lastName),i=await fetch(`${p}/secure-admin/bulk-create-users`,{method:"POST",headers:h(),body:JSON.stringify({users:r,firmId:Us,defaultPassword:zt||void 0})}),a=await i.json();i.ok?(n("success",`Created ${a.created} users. ${a.failed} failed.`),fs(!1),Ft(""),It(""),Bt(""),await H()):n("error",a.error)}catch{n("error","Failed to bulk import users")}},Gn=async()=>{try{const s=await fetch(`${p}/migration/template`,{headers:h()});if(s.ok){const r=await s.json(),i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),a=URL.createObjectURL(i),c=document.createElement("a");c.href=a,c.download="clio-migration-template.json",c.click(),URL.revokeObjectURL(a)}}catch(s){console.error("Failed to download template:",s)}},Vn=s=>{var i;const r=(i=s.target.files)==null?void 0:i[0];if(r){const a=new FileReader;a.onload=c=>{var m;const d=(m=c.target)==null?void 0:m.result;le(d)},a.readAsText(r)}},Lt=async()=>{if(!q.trim()){f.warning("Please enter or upload migration data");return}ve(!0);try{const s=JSON.parse(q),i=await(await fetch(`${p}/migration/validate`,{method:"POST",headers:h(),body:JSON.stringify({data:s})})).json();Ds(i),je("validate")}catch(s){s instanceof SyntaxError?(Ds({valid:!1,errors:["Invalid JSON format. Please check your data."],warnings:[],summary:{firm:null,users:0,contacts:0,matters:0,activities:0,calendar_entries:0}}),je("validate")):(console.error("Validation failed:",s),f.error("Validation failed","Please try again."))}ve(!1)},qn=async()=>{if(!q.trim()){n("error","No data to import");return}ve(!0);try{const s=JSON.parse(q),i=await(await fetch(`${p}/migration/import`,{method:"POST",headers:h(),body:JSON.stringify({data:s})})).json();ss(i),je("complete"),i.success?(await H(),n("success",`Migration complete! Created firm "${i.firm_name}"`)):n("error","Import had issues - check results below")}catch(s){console.error("Migration failed:",s),ss({success:!1,firm_id:null,firm_name:null,imported:{users:0,contacts:0,matters:0,time_entries:0,expenses:0,calendar_entries:0},user_credentials:[],errors:["Migration failed. Please check the JSON format and try again."],warnings:[]}),je("complete"),n("error","Migration failed - check JSON format")}ve(!1)},Pt=()=>{le(""),je("input"),Ds(null),ss(null),be(null),ln(""),cn("")},$t=(s,r=500)=>{if(!s||!s.trim())return[];const i=s.trim().split(`
`),a=i[0],c=[];for(let d=1;d<i.length;d+=r){const m=i.slice(d,d+r);d===1?c.push([a,...m].join(`
`)):c.push(m.join(`
`))}return c},Jn=async()=>{if(!(u.firmName.trim()||u.users.trim()||u.clients.trim()||u.matters.trim()||u.timeEntries.trim()||u.calendarEvents.trim())){n("error","Please enter data in at least one section");return}if(!u.firmName.trim()){n("error","Please enter a firm name");return}js(!0),be(null);try{n("success","Starting migration session...");const i=await(await fetch(`${p}/migration/start-session`,{method:"POST",headers:h(),body:JSON.stringify({firmName:u.firmName,firmEmail:u.firmEmail,firmPhone:u.firmPhone,firmAddress:u.firmAddress})})).json();if(!i.success)throw new Error(i.error||"Failed to start session");const a=i.sessionId,c=[{key:"users",data:u.users},{key:"clients",data:u.clients},{key:"matters",data:u.matters},{key:"timeEntries",data:u.timeEntries},{key:"calendarEvents",data:u.calendarEvents},{key:"bills",data:u.bills}];let d=0,m=0;for(const Z of c)Z.data.trim()&&(d+=$t(Z.data).length);for(const Z of c){if(!Z.data.trim())continue;const Ce=$t(Z.data);for(let pe=0;pe<Ce.length;pe++){m++,console.log(`Processing ${Z.key} chunk ${pe+1}/${Ce.length} (${m}/${d} total)`);const Ns=await(await fetch(`${p}/migration/add-chunk`,{method:"POST",headers:h(),body:JSON.stringify({sessionId:a,dataType:Z.key,data:Ce[pe]})})).json();Ns.success||console.error(`Chunk error for ${Z.key}:`,Ns.error)}}n("success","Finalizing migration data...");const B=await fetch(`${p}/migration/finalize-session`,{method:"POST",headers:h(),body:JSON.stringify({sessionId:a})}),A=await B.json();B.ok&&A.success?(be(A),le(JSON.stringify(A.transformedData,null,2)),n("success",`Parsed successfully: ${A.summary.users} users, ${A.summary.contacts} contacts, ${A.summary.matters} matters, ${A.summary.activities} time entries`)):(be({success:!1,error:A.error||"Parsing failed"}),n("error",A.error||"CSV parsing failed - check your data format"))}catch(r){console.error("CSV parsing error:",r),be({success:!1,error:"Failed to connect to server"}),n("error",r instanceof Error?r.message:"Failed to connect to server")}js(!1)},Qn=async()=>{if(!rs.trim()||!is.trim()){n("error","Please enter both Client ID and Client Secret");return}if(!u.firmName.trim()){n("error","Please enter a firm name before connecting");return}J(!0);try{const r=await(await fetch(`${p}/migration/clio/oauth-start`,{method:"POST",headers:h(),body:JSON.stringify({clientId:rs.trim(),clientSecret:is.trim(),firmName:u.firmName.trim()})})).json();r.success&&r.authUrl?window.location.href=r.authUrl:(n("error",r.error||"Failed to start Clio authorization"),J(!1))}catch{n("error","Failed to connect to Clio"),J(!1)}},Kn=async(s,r)=>{J(!0),xs({status:"starting"});const i=sessionStorage.getItem("clio_useExistingFirm")==="true",a=sessionStorage.getItem("clio_existingFirmId")||"",c=sessionStorage.getItem("clio_includeUsers")!=="false",d=sessionStorage.getItem("clio_includeContacts")!=="false",m=sessionStorage.getItem("clio_includeMatters")!=="false",B=sessionStorage.getItem("clio_includeActivities")!=="false",A=sessionStorage.getItem("clio_includeBills")!=="false",Z=sessionStorage.getItem("clio_includeCalendar")!=="false",Ce=sessionStorage.getItem("clio_includeDocuments")!=="false",pe=sessionStorage.getItem("clio_includeTasks")!=="false",Vs=sessionStorage.getItem("clio_includeNotes")!=="false",Ns=sessionStorage.getItem("clio_customAzureFolder")||"",qs=sessionStorage.getItem("clio_filterByUser")==="true",Wi=sessionStorage.getItem("clio_filterUserEmail")||"";console.log("[CLIO] Import options from sessionStorage:",{useExistingFirm:i,existingFirmId:a,includeUsers:c,includeContacts:d,includeMatters:m,includeActivities:B,includeBills:A,includeCalendar:Z,includeDocuments:Ce,includeTasks:pe,includeNotes:Vs,filterByUser:qs,filterUserEmail:Wi});try{console.log("[CLIO] Starting import for connection:",s);const Js=await(await fetch(`${p}/migration/clio/import`,{method:"POST",headers:h(),body:JSON.stringify({connectionId:s,firmName:r,existingFirmId:i?a:null,includeUsers:c,includeContacts:d,includeMatters:m,includeActivities:B,includeBills:A,includeCalendar:Z,includeDocuments:Ce,includeTasks:pe,includeNotes:Vs,customFirmFolder:Ns.trim()||null,filterByUser:qs,filterUserEmail:qs?Wi:null})})).json();console.log("[CLIO] Import response:",Js),Js.success?(n("success","Import started! Pulling all data from Clio..."),Ut(s)):(n("error",Js.error||"Failed to start import"),J(!1))}catch(Hi){console.error("[CLIO] Import error:",Hi),n("error","Failed to start Clio import"),J(!1)}},Yn=async()=>{if(!k){n("error","Please connect to Clio first");return}if(!u.firmName.trim()){n("error","Please enter a firm name");return}J(!0),xs({status:"starting"});try{console.log("[CLIO] Starting manual import for connection:",k);const r=await(await fetch(`${p}/migration/clio/import`,{method:"POST",headers:h(),body:JSON.stringify({connectionId:k,firmName:u.firmName,existingFirmId:_e?hs:null,includeUsers:as,includeContacts:os,includeMatters:ls,includeActivities:cs,includeBills:ds,includeCalendar:ms,includeDocuments:Ue,includeTasks:ps,includeNotes:us,customFirmFolder:Oe.trim()||null,filterByUser:ce,filterUserEmail:ce?Me:null})})).json();console.log("[CLIO] Manual import response:",r),r.success?(n("success","Import started! Pulling data from Clio..."),Ut(k)):(n("error",r.error||"Failed to start import"),J(!1))}catch(s){console.error("[CLIO] Manual import error:",s),n("error","Failed to start Clio import"),J(!1)}},Ut=async s=>{const r=s||k;if(!r){console.error("[CLIO] No connection ID available for polling");return}console.log("[CLIO] Starting progress polling for:",r);const i=async()=>{var a;try{const d=await(await fetch(`${p}/migration/clio/progress/${r}`,{headers:h()})).json();if(console.log("[CLIO] Progress update:",d),(a=d.summary)!=null&&a.userCredentials&&console.log("[CLIO] User credentials found:",d.summary.userCredentials.length),xs(d),d.status==="completed"){console.log("[CLIO] Clio data fetch completed, getting results...");const B=await(await fetch(`${p}/migration/clio/result/${r}`,{headers:h()})).json();if(console.log("[CLIO] Fetched data:",B),B.success&&B.transformedData){be(B);const A=JSON.stringify(B.transformedData,null,2);le(A),n("success",`✅ Data fetched from Clio! ${B.summary.users} users, ${B.summary.contacts} contacts, ${B.summary.matters} matters. Review the data below and click "Validate & Import" when ready.`),console.log("[CLIO] Data fetched - waiting for user to review and import")}else n("error",B.error||"Failed to fetch import results");J(!1);return}else if(d.status==="error"){n("error",d.error||"Import failed"),J(!1);return}setTimeout(i,2e3)}catch(c){console.error("[CLIO] Progress poll error:",c),setTimeout(i,3e3)}};i()},Gs=async()=>{if(console.log("[CLIO] Disconnecting and resetting migration state..."),k)try{await fetch(`${p}/migration/clio/disconnect`,{method:"POST",headers:h(),body:JSON.stringify({connectionId:k})})}catch{}ht(null),$e(null),pt(""),ut(""),xs(null),J(!1),xt(!1),Ls(""),gt(!1),Ps(""),I(r=>({...r,firmName:""})),sessionStorage.removeItem("clio_useExistingFirm"),sessionStorage.removeItem("clio_existingFirmId"),sessionStorage.removeItem("clio_filterByUser"),sessionStorage.removeItem("clio_filterUserEmail"),sessionStorage.removeItem("clio_migration_progress");const s=new URL(window.location.href);(s.searchParams.has("clio_connected")||s.searchParams.has("clio_error"))&&(s.searchParams.delete("clio_connected"),s.searchParams.delete("clio_error"),s.searchParams.delete("firm"),window.history.replaceState({},"",s.pathname)),n("success","Migration reset. You can now start a new migration."),console.log("[CLIO] Migration state reset complete")},Ot=se.filter(s=>{var r;return s.name.toLowerCase().includes(oe.toLowerCase())||((r=s.domain)==null?void 0:r.toLowerCase().includes(oe.toLowerCase()))}),Mt=Bs.filter(s=>{var r,i;return s.email.toLowerCase().includes(oe.toLowerCase())||((r=s.first_name)==null?void 0:r.toLowerCase().includes(oe.toLowerCase()))||((i=s.last_name)==null?void 0:i.toLowerCase().includes(oe.toLowerCase()))}),G=s=>{navigator.clipboard.writeText(s),n("success","Copied to clipboard")},Xn=()=>{const s="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789!@#$%";let r="";for(let i=0;i<12;i++)r+=s.charAt(Math.floor(Math.random()*s.length));return r},Zn=async s=>{const r=Xn();try{const i=await fetch(`${p}/secure-admin/account-tools/reset-password`,{method:"POST",headers:h(),body:JSON.stringify({userId:s.id,newPassword:r})});if(i.ok){const a=`Dear ${s.first_name},

	Welcome to Strapped AI! Your login details are below. Get comfortable with your Apex AI, and navigate to the integrations page to link your email account and your calendar. If you have any questions feel free to reach out to us at admin@strappedai.com.

Username: ${s.email}
Password: ${r}`;await navigator.clipboard.writeText(a),n("success",`Password reset for ${s.email}. Welcome email copied to clipboard!`)}else{const a=await i.json();n("error",a.error||"Failed to reset password")}}catch{n("error","Failed to reset password")}};return e.jsxs("div",{className:t.container,children:[ge&&e.jsxs("div",{className:`${t.notification} ${t[ge.type]}`,children:[ge.type==="success"?e.jsx(ue,{size:18}):e.jsx(Ne,{size:18}),e.jsx("span",{children:ge.message}),e.jsx("button",{onClick:()=>Ee(null),children:"×"})]}),e.jsxs("header",{className:t.header,children:[e.jsxs("div",{className:t.headerLeft,children:[e.jsxs("div",{className:t.logo,children:[e.jsx(ta,{size:24}),e.jsx("span",{children:"APEX Admin Console"})]}),e.jsxs("div",{className:t.securityIndicator,children:[e.jsx(ra,{size:14}),e.jsx("span",{children:"Secure Session"})]})]}),e.jsxs("div",{className:t.headerRight,children:[e.jsxs("div",{className:t.sessionTimer,children:[e.jsx(re,{size:14}),e.jsxs("span",{children:["Session: ",Cn(rn)]})]}),e.jsx("button",{onClick:H,className:t.refreshBtn,title:"Refresh data",children:e.jsx(E,{size:16})}),e.jsxs("button",{onClick:Dt,className:t.logoutBtn,children:[e.jsx(ia,{size:16}),e.jsx("span",{children:"Secure Logout"})]})]})]}),e.jsxs("div",{className:t.mainContainer,children:[e.jsx("aside",{className:t.sidebar,children:e.jsxs("nav",{className:t.sidebarNav,children:[e.jsxs("button",{className:`${t.navItem} ${N==="overview"?t.active:""}`,onClick:()=>R("overview"),children:[e.jsx(Gi,{size:18}),e.jsx("span",{children:"Overview"})]}),e.jsxs("button",{className:`${t.navItem} ${N==="quick-onboard"?t.active:""}`,onClick:()=>R("quick-onboard"),children:[e.jsx(we,{size:18}),e.jsx("span",{children:"Quick Onboard"})]}),e.jsxs("button",{className:`${t.navItem} ${N==="account-tools"?t.active:""}`,onClick:()=>R("account-tools"),children:[e.jsx(Qs,{size:18}),e.jsx("span",{children:"Account Tools"})]}),e.jsx("div",{className:t.navDivider}),e.jsxs("button",{className:`${t.navItem} ${N==="firms"?t.active:""}`,onClick:()=>R("firms"),children:[e.jsx(Q,{size:18}),e.jsx("span",{children:"Firms"}),e.jsx("span",{className:t.navBadge,children:se.length})]}),e.jsxs("button",{className:`${t.navItem} ${N==="users"?t.active:""}`,onClick:()=>R("users"),children:[e.jsx(V,{size:18}),e.jsx("span",{children:"Users"}),e.jsx("span",{className:t.navBadge,children:Bs.length})]}),e.jsx("div",{className:t.navDivider}),e.jsxs("button",{className:`${t.navItem} ${N==="migration"?t.active:""}`,onClick:()=>R("migration"),children:[e.jsx(K,{size:18}),e.jsx("span",{children:"Migration"})]}),e.jsxs("button",{className:`${t.navItem} ${N==="audit"?t.active:""}`,onClick:()=>R("audit"),children:[e.jsx(qe,{size:18}),e.jsx("span",{children:"Audit Log"})]}),e.jsxs("button",{className:`${t.navItem} ${N==="integrations"?t.active:""}`,onClick:()=>{R("integrations"),Rt()},children:[e.jsx(ie,{size:18}),e.jsx("span",{children:"Integrations"})]}),e.jsxs("button",{className:`${t.navItem} ${N==="storage"?t.active:""}`,onClick:()=>{R("storage"),Ge()},children:[e.jsx(he,{size:18}),e.jsx("span",{children:"Drive Storage"})]})]})}),e.jsx("main",{className:t.mainContent,children:en?e.jsxs("div",{className:t.loading,children:[e.jsx(E,{size:32,className:t.spinner}),e.jsx("span",{children:"Loading..."})]}):e.jsxs(e.Fragment,{children:[N==="overview"&&U&&e.jsxs("div",{className:t.overviewTab,children:[e.jsx("h2",{className:t.pageTitle,children:"Platform Overview"}),e.jsxs("div",{className:t.metricsGrid,children:[e.jsxs("div",{className:t.metricCard,children:[e.jsx("div",{className:t.metricIcon,style:{background:"rgba(59, 130, 246, 0.1)"},children:e.jsx(Q,{size:24,style:{color:"#3b82f6"}})}),e.jsxs("div",{className:t.metricContent,children:[e.jsx("span",{className:t.metricValue,children:U.overview.total_firms}),e.jsx("span",{className:t.metricLabel,children:"Total Firms"}),e.jsxs("span",{className:t.metricTrend,children:[e.jsx(Vi,{size:14}),"+",U.overview.new_firms_30d," this month"]})]})]}),e.jsxs("div",{className:t.metricCard,children:[e.jsx("div",{className:t.metricIcon,style:{background:"rgba(34, 197, 94, 0.1)"},children:e.jsx(V,{size:24,style:{color:"#22c55e"}})}),e.jsxs("div",{className:t.metricContent,children:[e.jsx("span",{className:t.metricValue,children:U.overview.total_users}),e.jsx("span",{className:t.metricLabel,children:"Total Users"}),e.jsxs("span",{className:t.metricTrend,children:[e.jsx(Vi,{size:14}),"+",U.overview.new_users_30d," this month"]})]})]}),e.jsxs("div",{className:t.metricCard,children:[e.jsx("div",{className:t.metricIcon,style:{background:"rgba(251, 191, 36, 0.1)"},children:e.jsx(na,{size:24,style:{color:"#fbbf24"}})}),e.jsxs("div",{className:t.metricContent,children:[e.jsx("span",{className:t.metricValue,children:U.overview.active_users}),e.jsx("span",{className:t.metricLabel,children:"Active Users"}),e.jsxs("span",{className:t.metricSubtext,children:[U.overview.active_today," active today"]})]})]}),e.jsxs("div",{className:t.metricCard,children:[e.jsx("div",{className:t.metricIcon,style:{background:"rgba(239, 68, 68, 0.1)"},children:e.jsx(Ne,{size:24,style:{color:"#ef4444"}})}),e.jsxs("div",{className:t.metricContent,children:[e.jsx("span",{className:t.metricValue,children:U.overview.unverified_users}),e.jsx("span",{className:t.metricLabel,children:"Unverified Users"}),e.jsx("span",{className:t.metricSubtext,children:"Need email verification"})]})]})]}),e.jsxs("div",{className:t.secondaryStats,children:[e.jsxs("div",{className:t.statItem,children:[e.jsx(ws,{size:16}),e.jsxs("span",{children:[U.overview.total_matters," Matters"]})]}),e.jsxs("div",{className:t.statItem,children:[e.jsx(V,{size:16}),e.jsxs("span",{children:[U.overview.total_clients," Clients"]})]}),e.jsxs("div",{className:t.statItem,children:[e.jsx(re,{size:16}),e.jsxs("span",{children:[U.overview.total_time_entries," Time Entries"]})]}),e.jsxs("div",{className:t.statItem,children:[e.jsx(Je,{size:16}),e.jsxs("span",{children:[U.overview.total_documents," Documents"]})]})]}),e.jsxs("div",{className:t.recentGrid,children:[e.jsxs("div",{className:t.recentCard,children:[e.jsx("h3",{children:"Recent Firms"}),e.jsx("div",{className:t.recentList,children:U.recentFirms.slice(0,5).map(s=>e.jsxs("div",{className:t.recentItem,children:[e.jsx("div",{className:t.recentIcon,children:e.jsx(Q,{size:16})}),e.jsxs("div",{className:t.recentInfo,children:[e.jsx("span",{className:t.recentName,children:s.name}),e.jsxs("span",{className:t.recentMeta,children:[s.user_count," users"]})]}),e.jsx("span",{className:t.recentDate,children:new Date(s.created_at).toLocaleDateString()})]},s.id))})]}),e.jsxs("div",{className:t.recentCard,children:[e.jsx("h3",{children:"Recent Users"}),e.jsx("div",{className:t.recentList,children:U.recentUsers.slice(0,5).map(s=>e.jsxs("div",{className:t.recentItem,children:[e.jsx("div",{className:t.recentIcon,children:e.jsx(V,{size:16})}),e.jsxs("div",{className:t.recentInfo,children:[e.jsxs("span",{className:t.recentName,children:[s.first_name," ",s.last_name]}),e.jsx("span",{className:t.recentMeta,children:s.firm_name||"No firm"})]}),e.jsx("span",{className:t.recentDate,children:new Date(s.created_at).toLocaleDateString()})]},s.id))})]})]}),e.jsxs("div",{className:t.topFirmsCard,children:[e.jsx("h3",{children:"Top Firms by User Count"}),e.jsx("div",{className:t.topFirmsList,children:U.topFirms.slice(0,5).map((s,r)=>e.jsxs("div",{className:t.topFirmItem,children:[e.jsxs("span",{className:t.topFirmRank,children:["#",r+1]}),e.jsx("span",{className:t.topFirmName,children:s.name}),e.jsxs("span",{className:t.topFirmCount,children:[s.user_count," users"]})]},s.id))})]})]}),N==="quick-onboard"&&e.jsxs("div",{className:t.quickOnboardTab,children:[e.jsxs("h2",{className:t.pageTitle,children:[e.jsx(we,{size:24}),"Quick Onboard"]}),e.jsx("p",{className:t.pageSubtitle,children:"Create a new firm with an admin user in one step"}),e.jsxs("form",{onSubmit:Nn,className:t.onboardForm,children:[e.jsxs("div",{className:t.formSection,children:[e.jsxs("h3",{children:[e.jsx(Q,{size:18})," Firm Information"]}),e.jsxs("div",{className:t.formGrid,children:[e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Firm Name *"}),e.jsx("input",{type:"text",value:L.firmName,onChange:s=>te({...L,firmName:s.target.value}),placeholder:"Smith & Associates LLC",required:!0})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Domain"}),e.jsx("input",{type:"text",value:L.firmDomain,onChange:s=>te({...L,firmDomain:s.target.value}),placeholder:"smithlaw.com"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Firm Email"}),e.jsx("input",{type:"email",value:L.firmEmail,onChange:s=>te({...L,firmEmail:s.target.value}),placeholder:"contact@smithlaw.com"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Phone"}),e.jsx("input",{type:"tel",value:L.firmPhone,onChange:s=>te({...L,firmPhone:s.target.value}),placeholder:"(555) 123-4567"})]})]})]}),e.jsxs("div",{className:t.formSection,children:[e.jsxs("h3",{children:[e.jsx(Ks,{size:18})," Admin User"]}),e.jsxs("div",{className:t.formGrid,children:[e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"First Name *"}),e.jsx("input",{type:"text",value:L.adminFirstName,onChange:s=>te({...L,adminFirstName:s.target.value}),placeholder:"John",required:!0})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Last Name *"}),e.jsx("input",{type:"text",value:L.adminLastName,onChange:s=>te({...L,adminLastName:s.target.value}),placeholder:"Smith",required:!0})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Email *"}),e.jsx("input",{type:"email",value:L.adminEmail,onChange:s=>te({...L,adminEmail:s.target.value}),placeholder:"john@smithlaw.com",required:!0})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Password *"}),e.jsx("input",{type:"password",value:L.adminPassword,onChange:s=>te({...L,adminPassword:s.target.value}),placeholder:"••••••••",minLength:8,required:!0})]})]})]}),e.jsx("div",{className:t.formActions,children:e.jsx("button",{type:"submit",className:t.primaryBtn,disabled:it,children:it?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:18,className:t.spinner}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{size:18}),"Create Firm & Admin"]})})})]}),X&&e.jsx("div",{className:`${t.resultCard} ${X.success?t.success:t.error}`,children:X.success?e.jsxs(e.Fragment,{children:[e.jsx(ae,{size:24}),e.jsxs("div",{children:[e.jsx("h4",{children:"Onboarding Complete!"}),e.jsx("p",{children:X.message}),X.firm&&X.user&&e.jsxs("div",{className:t.resultDetails,children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Firm ID:"})," ",X.firm.id,e.jsx("button",{onClick:()=>G(X.firm.id),className:t.copyBtn,children:e.jsx(O,{size:14})})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"User ID:"})," ",X.user.id,e.jsx("button",{onClick:()=>G(X.user.id),className:t.copyBtn,children:e.jsx(O,{size:14})})]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{size:24}),e.jsxs("div",{children:[e.jsx("h4",{children:"Onboarding Failed"}),e.jsx("p",{children:X.message})]})]})})]}),N==="account-tools"&&e.jsxs("div",{className:t.accountToolsTab,children:[e.jsxs("h2",{className:t.pageTitle,children:[e.jsx(Qs,{size:24}),"Account Tools"]}),e.jsx("p",{className:t.pageSubtitle,children:"Search for a user and perform administrative actions"}),e.jsx("div",{className:t.lookupSection,children:e.jsxs("div",{className:t.lookupInput,children:[e.jsx(ks,{size:18}),e.jsx("input",{type:"text",value:Es,onChange:s=>at(s.target.value),onKeyDown:s=>s.key==="Enter"&&Ss(),placeholder:"Search by email or user ID..."}),e.jsx("button",{onClick:Ss,disabled:ot,children:ot?e.jsx(E,{size:16,className:t.spinner}):"Lookup"})]})}),g&&e.jsxs("div",{className:t.lookupResult,children:[e.jsxs("div",{className:t.userInfoCard,children:[e.jsxs("div",{className:t.userInfoHeader,children:[e.jsxs("div",{className:t.userAvatar,children:[g.firstName[0],g.lastName[0]]}),e.jsxs("div",{className:t.userBasicInfo,children:[e.jsxs("h3",{children:[g.firstName," ",g.lastName]}),e.jsx("p",{children:g.email}),e.jsxs("div",{className:t.userBadges,children:[e.jsx("span",{className:`${t.badge} ${g.isActive?t.active:t.inactive}`,children:g.isActive?"Active":"Inactive"}),e.jsx("span",{className:`${t.badge} ${t.role}`,children:g.role}),g.emailVerified?e.jsxs("span",{className:`${t.badge} ${t.verified}`,children:[e.jsx(ke,{size:12})," Verified"]}):e.jsxs("span",{className:`${t.badge} ${t.unverified}`,children:[e.jsx(ke,{size:12})," Unverified"]})]})]})]}),e.jsxs("div",{className:t.userDetails,children:[e.jsxs("div",{className:t.detailRow,children:[e.jsx("span",{className:t.detailLabel,children:"User ID"}),e.jsxs("span",{className:t.detailValue,children:[g.id,e.jsx("button",{onClick:()=>G(g.id),className:t.copyBtn,children:e.jsx(O,{size:14})})]})]}),e.jsxs("div",{className:t.detailRow,children:[e.jsx("span",{className:t.detailLabel,children:"Firm"}),e.jsx("span",{className:t.detailValue,children:g.firmName||"N/A"})]}),e.jsxs("div",{className:t.detailRow,children:[e.jsx("span",{className:t.detailLabel,children:"Firm ID"}),e.jsxs("span",{className:t.detailValue,children:[g.firmId,e.jsx("button",{onClick:()=>G(g.firmId),className:t.copyBtn,children:e.jsx(O,{size:14})})]})]}),e.jsxs("div",{className:t.detailRow,children:[e.jsx("span",{className:t.detailLabel,children:"Last Login"}),e.jsx("span",{className:t.detailValue,children:g.lastLoginAt?new Date(g.lastLoginAt).toLocaleString():"Never"})]}),e.jsxs("div",{className:t.detailRow,children:[e.jsx("span",{className:t.detailLabel,children:"Created"}),e.jsx("span",{className:t.detailValue,children:new Date(g.createdAt).toLocaleString()})]}),e.jsxs("div",{className:t.detailRow,children:[e.jsx("span",{className:t.detailLabel,children:"Time Entries"}),e.jsx("span",{className:t.detailValue,children:g.stats.timeEntriesCount})]})]})]}),e.jsxs("div",{className:t.actionCards,children:[e.jsxs("div",{className:t.actionCard,children:[e.jsxs("h4",{children:[e.jsx(ie,{size:16})," Reset Password"]}),e.jsxs("div",{className:t.actionContent,children:[e.jsxs("div",{className:t.passwordInputWrapper,children:[e.jsx("input",{type:Ts?"text":"password",value:Re,onChange:s=>ct(s.target.value),placeholder:"New password (min 8 chars)",minLength:8}),e.jsx("button",{type:"button",onClick:()=>an(!Ts),children:Ts?e.jsx(Qi,{size:16}):e.jsx(Ki,{size:16})})]}),e.jsx("button",{onClick:In,disabled:!Re||Re.length<8,className:t.actionBtn,children:"Reset Password"})]})]}),e.jsxs("div",{className:t.actionCard,children:[e.jsxs("h4",{children:[e.jsx(ke,{size:16})," Email Verification"]}),e.jsxs("div",{className:t.actionContent,children:[e.jsxs("p",{children:["Status: ",g.emailVerified?e.jsx("span",{className:t.statusVerified,children:"Verified"}):e.jsx("span",{className:t.statusUnverified,children:"Not Verified"})]}),e.jsx("button",{onClick:zn,disabled:g.emailVerified,className:t.actionBtn,children:"Force Verify Email"})]})]}),e.jsxs("div",{className:t.actionCard,children:[e.jsxs("h4",{children:[g.isActive?e.jsx(aa,{size:16}):e.jsx(oa,{size:16}),"Account Status"]}),e.jsxs("div",{className:t.actionContent,children:[e.jsxs("p",{children:["Current: ",g.isActive?e.jsx("span",{className:t.statusActive,children:"Active"}):e.jsx("span",{className:t.statusInactive,children:"Inactive"})]}),e.jsx("button",{onClick:Bn,className:`${t.actionBtn} ${g.isActive?t.danger:""}`,children:g.isActive?"Deactivate Account":"Activate Account"})]})]}),e.jsxs("div",{className:t.actionCard,children:[e.jsxs("h4",{children:[e.jsx(Ks,{size:16})," Change Role"]}),e.jsxs("div",{className:t.actionContent,children:[e.jsxs("select",{value:Le,onChange:s=>dt(s.target.value),children:[e.jsx("option",{value:"owner",children:"Owner"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"attorney",children:"Attorney"}),e.jsx("option",{value:"paralegal",children:"Paralegal"}),e.jsx("option",{value:"staff",children:"Staff"}),e.jsx("option",{value:"billing",children:"Billing"}),e.jsx("option",{value:"readonly",children:"Read Only"})]}),e.jsx("button",{onClick:An,disabled:Le===g.role,className:t.actionBtn,children:"Update Role"})]})]}),e.jsxs("div",{className:t.actionCard,children:[e.jsxs("h4",{children:[e.jsx(la,{size:16})," Transfer to Firm"]}),e.jsxs("div",{className:t.actionContent,children:[e.jsxs("select",{value:es,onChange:s=>on(s.target.value),children:[e.jsx("option",{value:"",children:"Select firm..."}),se.filter(s=>s.id!==g.firmId).map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("button",{onClick:En,disabled:!es,className:t.actionBtn,children:"Transfer User"})]})]})]})]})]}),N==="firms"&&e.jsxs("div",{className:t.listTab,children:[e.jsxs("div",{className:t.listHeader,children:[e.jsxs("h2",{className:t.pageTitle,children:[e.jsx(Q,{size:24}),"Firms (",se.length,")"]}),e.jsxs("div",{className:t.listActions,children:[e.jsxs("div",{className:t.searchBox,children:[e.jsx(ks,{size:18}),e.jsx("input",{type:"text",placeholder:"Search firms...",value:oe,onChange:s=>st(s.target.value)})]}),e.jsxs("button",{className:t.addBtn,onClick:()=>{Be(null),Ie(!0)},children:[e.jsx(Qe,{size:18}),"Add Firm"]})]})]}),e.jsxs("div",{className:t.tableWrapper,children:[e.jsxs("table",{className:t.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Firm Name"}),e.jsx("th",{children:"Domain"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Users"}),e.jsx("th",{children:"Subscription"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:Ot.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:t.firmName,children:e.jsxs("button",{onClick:()=>Ve(s),style:{background:"none",border:"none",color:"#3B82F6",cursor:"pointer",padding:0,fontWeight:500,display:"flex",alignItems:"center",gap:"6px"},title:"Click to view firm details & document migration",children:[e.jsx(Q,{size:14}),s.name,e.jsx(ca,{size:12,style:{opacity:.5}})]})}),e.jsx("td",{children:s.domain||"—"}),e.jsx("td",{children:e.jsx("span",{className:`${t.badge} ${t[s.status||"active"]}`,children:s.status||"active"})}),e.jsx("td",{children:s.users_count||0}),e.jsx("td",{children:s.subscription_tier||"Professional"}),e.jsx("td",{children:new Date(s.created_at).toLocaleDateString()}),e.jsxs("td",{className:t.actions,children:[e.jsx("button",{onClick:()=>Ve(s),className:t.viewBtn,title:"View firm details & document migration",style:{background:"#3B82F6"},children:e.jsx(he,{size:14})}),e.jsx("button",{onClick:()=>Cs(s.id),disabled:z===s.id,className:t.editBtn,title:"Quick scan Azure files",style:{background:z===s.id?"#6B7280":"#10B981"},children:z===s.id?e.jsx(re,{size:14,className:"animate-spin"}):e.jsx(Fs,{size:14})}),e.jsx("button",{onClick:()=>{Be(s),Ie(!0)},className:t.editBtn,title:"Edit firm",children:e.jsx(Ys,{size:14})}),e.jsx("button",{onClick:()=>Dn(s.id),className:t.deleteBtn,title:"Delete firm",children:e.jsx(qi,{size:14})})]})]},s.id))})]}),Ot.length===0&&e.jsx("div",{className:t.emptyState,children:"No firms found"})]})]}),N==="users"&&e.jsxs("div",{className:t.listTab,children:[e.jsxs("div",{className:t.listHeader,children:[e.jsxs("h2",{className:t.pageTitle,children:[e.jsx(V,{size:24}),"Users (",Bs.length,")"]}),e.jsxs("div",{className:t.listActions,children:[e.jsxs("div",{className:t.searchBox,children:[e.jsx(ks,{size:18}),e.jsx("input",{type:"text",placeholder:"Search users...",value:oe,onChange:s=>st(s.target.value)})]}),e.jsxs("button",{className:t.secondaryBtn,onClick:()=>fs(!0),children:[e.jsx(K,{size:18}),"Bulk Import"]}),e.jsxs("button",{className:t.addBtn,onClick:()=>{Xe(null),Ye(!0)},children:[e.jsx(Qe,{size:18}),"Add User"]})]})]}),e.jsxs("div",{className:t.tableWrapper,children:[e.jsxs("table",{className:t.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Firm"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Last Login"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:Mt.map(s=>{var r;return e.jsxs("tr",{children:[e.jsxs("td",{className:t.userName,children:[s.first_name," ",s.last_name]}),e.jsx("td",{children:s.email}),e.jsx("td",{children:s.firm_name||((r=se.find(i=>i.id===s.firm_id))==null?void 0:r.name)||"—"}),e.jsx("td",{children:e.jsx("span",{className:`${t.roleBadge} ${t[s.role]}`,children:s.role})}),e.jsx("td",{children:e.jsx("span",{className:`${t.badge} ${t[s.status||"active"]}`,children:s.status||"active"})}),e.jsx("td",{children:s.last_login?new Date(s.last_login).toLocaleDateString():"Never"}),e.jsxs("td",{className:t.actions,children:[e.jsx("button",{onClick:()=>{at(s.email),R("account-tools"),setTimeout(()=>Ss(),100)},className:t.viewBtn,title:"View in Account Tools",children:e.jsx(da,{size:14})}),e.jsx("button",{onClick:()=>Zn(s),className:t.viewBtn,title:"Reset password & copy welcome email",style:{background:"#8B5CF6"},children:e.jsx(ie,{size:14})}),e.jsx("button",{onClick:()=>{Xe(s),Ye(!0)},className:t.editBtn,title:"Edit user",children:e.jsx(Ys,{size:14})}),e.jsx("button",{onClick:()=>Wn(s.id),className:t.deleteBtn,title:"Delete user",children:e.jsx(qi,{size:14})})]})]},s.id)})})]}),Mt.length===0&&e.jsx("div",{className:t.emptyState,children:"No users found"})]})]}),N==="migration"&&e.jsxs("div",{className:t.migrationContainer,children:[e.jsxs("h2",{className:t.pageTitle,children:[e.jsx(K,{size:24}),"Data Migration"]}),e.jsxs("div",{className:t.migrationSteps,children:[e.jsxs("div",{className:`${t.step} ${ne==="input"?t.activeStep:""} ${["validate","import","complete"].includes(ne)?t.completedStep:""}`,children:[e.jsx("div",{className:t.stepNumber,children:"1"}),e.jsx("span",{children:"Upload Data"})]}),e.jsx(Ke,{size:20,className:t.stepArrow}),e.jsxs("div",{className:`${t.step} ${ne==="validate"?t.activeStep:""} ${["import","complete"].includes(ne)?t.completedStep:""}`,children:[e.jsx("div",{className:t.stepNumber,children:"2"}),e.jsx("span",{children:"Validate"})]}),e.jsx(Ke,{size:20,className:t.stepArrow}),e.jsxs("div",{className:`${t.step} ${ne==="complete"?t.activeStep:""}`,children:[e.jsx("div",{className:t.stepNumber,children:"3"}),e.jsx("span",{children:"Import"})]})]}),ne==="input"&&e.jsxs("div",{className:t.migrationInput,children:[e.jsxs("div",{className:t.migrationHeader,children:[e.jsx("h3",{children:"Import Firm Data from Clio"}),e.jsx("p",{children:"Migrate a law firm's data from Clio to Apex Legal. Use AI to automatically transform any data format, or upload pre-formatted JSON."})]}),e.jsxs("div",{className:t.aiModeToggle,children:[e.jsxs("button",{className:`${t.modeBtn} ${ts==="clio"?t.activeMode:""}`,onClick:()=>Pe("clio"),children:[e.jsx(we,{size:18}),"Clio API",e.jsx("span",{className:t.aiLabel,children:"Recommended"})]}),e.jsxs("button",{className:`${t.modeBtn} ${ts==="csv"&&Rs?t.activeMode:""}`,onClick:()=>{Pe("csv"),mt(!0)},children:[e.jsx(K,{size:18}),"CSV Import"]}),e.jsxs("button",{className:`${t.modeBtn} ${ts==="csv"&&!Rs?t.activeMode:""}`,onClick:()=>{Pe("csv"),mt(!1)},children:[e.jsx(Xs,{size:18}),"Manual JSON"]})]}),ts==="clio"?e.jsxs("div",{className:t.aiTransformSection,children:[e.jsxs("div",{className:t.aiHeader,style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[e.jsx(we,{size:24}),e.jsxs("div",{children:[e.jsx("h4",{children:"Connect to Clio API (Recommended)"}),e.jsx("p",{children:"Direct API connection pulls all your data automatically with intact relationships. No CSV exports needed - just connect and import."})]})]}),(k||S)&&e.jsxs("button",{onClick:Gs,className:t.secondaryBtn,style:{padding:"0.5rem 1rem",fontSize:"0.875rem"},children:[e.jsx(E,{size:16}),"Reset & Start New"]})]}),e.jsxs("div",{className:t.migrationSection,children:[e.jsxs("div",{className:t.sectionHeader,children:[e.jsx(ie,{size:18}),e.jsx("h4",{children:"1. Connect to Clio"})]}),k?e.jsxs("div",{className:t.clioConnected,children:[e.jsxs("div",{className:t.connectedBadge,children:[e.jsx(ae,{size:20}),e.jsxs("span",{children:["Connected as ",e.jsx("strong",{children:ye==null?void 0:ye.name})," (",ye==null?void 0:ye.email,")"]})]}),e.jsx("button",{onClick:Gs,className:t.secondaryBtn,children:"Disconnect"})]}):e.jsxs("div",{className:t.clioConnect,children:[e.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem",background:"rgba(34, 197, 94, 0.1)",borderRadius:"8px"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",marginBottom:"0.5rem"},children:[e.jsx("input",{type:"checkbox",checked:_e,onChange:s=>{xt(s.target.checked),s.target.checked||Ls("")}}),e.jsx("span",{style:{fontSize:"0.9rem",fontWeight:500,color:"#4ade80"},children:"Migrate to Existing Firm"})]}),_e&&e.jsxs("select",{value:hs,onChange:s=>{Ls(s.target.value);const r=se.find(i=>i.id===s.target.value);r&&I(i=>({...i,firmName:r.name}))},style:{width:"100%",padding:"0.5rem",borderRadius:"6px",background:"#1a1a2e",border:"1px solid #2d2d4a",color:"#e5e7eb"},children:[e.jsx("option",{value:"",children:"Select a firm..."}),se.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.users_count," users)"]},s.id))]})]}),!_e&&e.jsxs("div",{className:t.inputField,children:[e.jsx("label",{htmlFor:"clio-firm-name",children:"New Firm Name *"}),e.jsx("input",{id:"clio-firm-name",type:"text",value:u.firmName,onChange:s=>I(r=>({...r,firmName:s.target.value})),placeholder:"Enter the firm name for this import"})]}),e.jsxs("p",{className:t.sectionDescription,style:{marginTop:"1rem"},children:["Get your credentials from ",e.jsx("strong",{children:"Clio → Settings → Developer Applications"})," → Create an app.",e.jsx("br",{}),"Use these values:",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Website URL:"})," https://strappedai.com",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Redirect URI:"})," https://strappedai-gpfra9f8gsg9d9hy.canadacentral-01.azurewebsites.net/api/migration/clio/callback"]}),e.jsxs("div",{className:t.inputField,children:[e.jsx("label",{htmlFor:"clio-client-id",children:"Client ID"}),e.jsx("input",{id:"clio-client-id",type:"text",value:rs,onChange:s=>pt(s.target.value),placeholder:"Paste your Clio Client ID"})]}),e.jsxs("div",{className:t.inputField,children:[e.jsx("label",{htmlFor:"clio-client-secret",children:"Client Secret"}),e.jsx("input",{id:"clio-client-secret",type:"password",value:is,onChange:s=>ut(s.target.value),placeholder:"Paste your Clio Client Secret"})]}),e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"rgba(59, 130, 246, 0.1)",borderRadius:"8px"},children:[e.jsx("p",{style:{fontSize:"0.85rem",marginBottom:"0.5rem",color:"#93c5fd"},children:e.jsx("strong",{children:"Select Data to Import:"})}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:as,onChange:s=>dn(s.target.checked)}),e.jsx("span",{style:{fontSize:"0.85rem"},children:"Users"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:os,onChange:s=>mn(s.target.checked)}),e.jsx("span",{style:{fontSize:"0.85rem"},children:"Contacts"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:ls,onChange:s=>pn(s.target.checked)}),e.jsx("span",{style:{fontSize:"0.85rem"},children:"Matters"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:cs,onChange:s=>un(s.target.checked)}),e.jsx("span",{style:{fontSize:"0.85rem"},children:"Time Entries"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:ds,onChange:s=>hn(s.target.checked)}),e.jsx("span",{style:{fontSize:"0.85rem"},children:"Bills"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:ms,onChange:s=>xn(s.target.checked)}),e.jsx("span",{style:{fontSize:"0.85rem"},children:"Calendar"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:ps,onChange:s=>jn(s.target.checked)}),e.jsx("span",{style:{fontSize:"0.85rem"},children:"Tasks"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:us,onChange:s=>fn(s.target.checked)}),e.jsx("span",{style:{fontSize:"0.85rem"},children:"Notes"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",background:"rgba(124, 58, 237, 0.1)",padding:"4px 8px",borderRadius:"6px",border:"1px solid rgba(124, 58, 237, 0.3)"},children:[e.jsx("input",{type:"checkbox",checked:Ue,onChange:s=>gn(s.target.checked)}),e.jsx("span",{style:{fontSize:"0.85rem",fontWeight:600,color:"#7C3AED"},children:"Documents (Stream to Azure)"})]})]}),Ue&&e.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.75rem 1rem",background:"rgba(124, 58, 237, 0.08)",borderRadius:"8px",border:"1px solid rgba(124, 58, 237, 0.2)",fontSize:"0.8rem",color:"#6B7280"},children:[e.jsx("strong",{style:{color:"#7C3AED"},children:"Requires Azure Storage:"})," Go to"," ",e.jsx("strong",{children:"Platform Settings → Azure Storage (Apex Drive)"})," and enter your storage account name, key, and file share name. Without this, documents will be skipped during migration.",e.jsxs("div",{style:{marginTop:"0.75rem"},children:[e.jsx("label",{style:{display:"block",fontWeight:500,marginBottom:"0.25rem",color:"#7C3AED"},children:"Custom Azure Folder Path (optional)"}),e.jsx("input",{type:"text",value:Oe,onChange:s=>vn(s.target.value),placeholder:"e.g., firm-54639e17-b1e1-44ff-ac1c-ffbf15211752",style:{width:"100%",padding:"0.5rem",borderRadius:"6px",border:"1px solid rgba(124, 58, 237, 0.3)",background:"white",fontSize:"0.85rem",fontFamily:"monospace"}}),e.jsx("p",{style:{fontSize:"0.75rem",color:"#888",marginTop:"0.25rem"},children:"Leave blank to auto-generate from firm ID. Use this to target an existing firm's folder."})]})]})]}),e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"rgba(245, 158, 11, 0.1)",borderRadius:"8px",border:"1px solid rgba(245, 158, 11, 0.3)"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",marginBottom:"0.5rem"},children:[e.jsx("input",{type:"checkbox",checked:ce,onChange:s=>{gt(s.target.checked),s.target.checked||Ps("")}}),e.jsx("span",{style:{fontSize:"0.9rem",fontWeight:500,color:"#F59E0B"},children:"Migrate Specific User Only"})]}),e.jsx("p",{style:{fontSize:"0.8rem",color:"#888",marginBottom:"0.5rem"},children:"Only migrate matters where this user is the responsible attorney, plus their time entries, bills, and calendar events."}),ce&&e.jsx("input",{type:"email",value:Me,onChange:s=>Ps(s.target.value),placeholder:"Enter user email from Clio (e.g. john@firm.com)",style:{width:"100%",padding:"0.5rem",borderRadius:"6px",background:"#1a1a2e",border:"1px solid #2d2d4a",color:"#e5e7eb",fontSize:"0.85rem"}})]}),e.jsx("button",{onClick:Qn,disabled:ns||!rs.trim()||!is.trim()||!u.firmName.trim()||ce&&!Me.trim(),className:t.primaryBtn,style:{marginTop:"1rem"},children:ns?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:18,className:t.spinner})," Connecting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{size:18})," Connect & Import from Clio"]})})]})]}),k&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:t.migrationSection,children:[e.jsxs("div",{className:t.sectionHeader,children:[e.jsx(Q,{size:18}),e.jsx("h4",{children:"2. Firm Name for Import"})]}),e.jsxs("div",{className:t.inputField,children:[e.jsx("label",{htmlFor:"clio-firm-name",children:"Firm Name *"}),e.jsx("input",{id:"clio-firm-name",type:"text",value:u.firmName,onChange:s=>I(r=>({...r,firmName:s.target.value})),placeholder:"Enter firm name for the import"})]})]}),e.jsxs("div",{className:t.migrationSection,children:[e.jsxs("div",{className:t.sectionHeader,children:[e.jsx(Zs,{size:18}),e.jsx("h4",{children:"3. Start Import"})]}),e.jsx("p",{className:t.sectionDescription,children:"This will pull all data from Clio: Users, Contacts, Matters, Time Entries, Bills, Calendar Events, Tasks, Notes, and Documents. The process runs in the background and may take several minutes for large firms."}),e.jsx("button",{onClick:Yn,disabled:ns||!u.firmName.trim(),className:t.primaryBtn,children:ns?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:18,className:t.spinner})," Importing from Clio..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Zs,{size:18})," Start Clio Import"]})})]}),S&&S.steps&&e.jsxs("div",{className:t.migrationSection,children:[e.jsxs("div",{className:t.sectionHeader,children:[e.jsx(qe,{size:18}),e.jsx("h4",{children:"Import Progress"})]}),e.jsx("div",{className:t.clioProgress,children:Object.entries(S.steps).map(([s,r])=>e.jsxs("div",{className:`${t.progressItem} ${t[r.status]}`,children:[e.jsx("span",{className:t.progressLabel,children:s}),e.jsx("span",{className:t.progressStatus,children:r.status==="done"?e.jsxs(e.Fragment,{children:[e.jsx(ae,{size:16})," ",r.count]}):r.status==="running"?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:16,className:t.spinner})," ",r.count,"..."]}):r.status==="error"?e.jsxs(e.Fragment,{children:[e.jsx(xe,{size:16})," Error: ",r.error||"Unknown"]}):r.status==="skipped"?e.jsxs(e.Fragment,{children:[e.jsx(Is,{size:16})," Skipped"]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{size:16})," Pending"]})})]},s))}),S.logs&&S.logs.length>0&&e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"#1a1a2e",borderRadius:"8px",maxHeight:"200px",overflow:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("strong",{style:{fontSize:"0.875rem",color:"#888"},children:"Migration Log"}),e.jsxs("button",{onClick:()=>{var s;return G(((s=S.logs)==null?void 0:s.join(`
`))||"")},style:{background:"none",border:"none",color:"#8B5CF6",cursor:"pointer",fontSize:"0.75rem"},children:[e.jsx(O,{size:12})," Copy"]})]}),e.jsx("pre",{style:{fontSize:"0.75rem",color:"#ccc",margin:0,fontFamily:"monospace",whiteSpace:"pre-wrap"},children:S.logs.slice(-50).join(`
`)})]}),S.status==="completed"&&S.summary&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:t.clioSummary,style:{background:"linear-gradient(135deg, #10B981 0%, #059669 100%)",padding:"1.5rem",borderRadius:"12px",marginBottom:"1rem"},children:[e.jsx(ae,{size:32}),e.jsxs("div",{children:[e.jsx("strong",{style:{fontSize:"1.25rem"},children:"🎉 Migration Complete!"}),e.jsxs("p",{style:{marginTop:"0.5rem",opacity:.9},children:["Successfully imported: ",S.summary.users," users, ",S.summary.contacts," contacts,",S.summary.matters," matters, ",S.summary.activities," time entries,",S.summary.bills," bills, ",S.summary.calendar_entries||S.summary.calendar," calendar events"]})]})]}),e.jsx("div",{style:{marginBottom:"1rem",textAlign:"right"},children:e.jsxs("button",{onClick:Gs,className:t.secondaryBtn,style:{marginRight:"0.5rem"},children:[e.jsx(Qe,{size:16})," Start New Migration"]})}),Array.isArray(S.summary.userCredentials)&&S.summary.userCredentials.length>0?e.jsxs("div",{className:t.credentialsSection,style:{marginTop:"1rem",border:"2px solid #F59E0B",background:"rgba(245, 158, 11, 0.1)"},children:[e.jsxs("div",{className:t.credentialsHeader,children:[e.jsx(ie,{size:20}),e.jsxs("h4",{children:["🔐 User Login Credentials (",S.summary.userCredentials.length," users)"]}),e.jsxs("button",{onClick:()=>{var i;const r=((i=S.summary)==null?void 0:i.userCredentials).map(a=>`${a.name} (${a.role})
Email: ${a.email}
Password: ${a.password}
`).join(`
---
`);G(r)},className:t.copyAllBtn,children:[e.jsx(O,{size:14}),"Copy All"]})]}),e.jsx("p",{className:t.credentialsNote,style:{background:"#FEF3C7",color:"#92400E",padding:"0.75rem",borderRadius:"8px",fontWeight:600},children:"⚠️ IMPORTANT: Save these passwords now! They cannot be retrieved later."}),e.jsx("div",{className:t.credentialsList,children:S.summary.userCredentials.map((s,r)=>e.jsxs("div",{className:t.credentialCard,children:[e.jsxs("div",{className:t.credentialName,children:[e.jsx("span",{children:s.name}),e.jsx("span",{className:t.credentialRole,children:s.role})]}),e.jsxs("div",{className:t.credentialDetails,children:[e.jsxs("div",{className:t.credentialRow,children:[e.jsx(ke,{size:14}),e.jsx("span",{children:s.email}),e.jsx("button",{onClick:()=>G(s.email),title:"Copy email",children:e.jsx(O,{size:12})})]}),e.jsxs("div",{className:t.credentialRow,children:[e.jsx(ie,{size:14}),e.jsx("code",{children:s.password}),e.jsx("button",{onClick:()=>G(s.password),title:"Copy password",children:e.jsx(O,{size:12})})]}),e.jsx("div",{className:t.credentialRow,style:{marginTop:"0.5rem"},children:e.jsxs("button",{onClick:()=>{const i=`Dear ${s.firstName},

	Welcome to Strapped AI! Your login details are below. Get comfortable with your Apex AI, and navigate to the integrations page to link your email account and your calendar. If you have any questions feel free to reach out to us at admin@strappedai.com.

Username: ${s.email}
Password: ${s.password}`;G(i),n("success","Welcome email copied to clipboard!")},className:t.secondaryBtn,style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},title:"Copy welcome email",children:[e.jsx(ke,{size:12}),"Copy Welcome Email"]})})]})]},r))})]}):e.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"rgba(100, 100, 100, 0.1)",borderRadius:"8px"},children:[e.jsx("p",{style:{color:"#888",margin:0},children:"ℹ️ No new user accounts were created. Users may have been skipped due to missing email addresses, or imported to an existing firm where accounts already existed."}),e.jsxs("p",{style:{color:"#888",marginTop:"0.5rem",fontSize:"0.875rem"},children:["To reset a user's password, go to the ",e.jsx("strong",{children:"Users"})," tab and click the 🔑 key icon next to any user."]})]})]})]})]}),(F==null?void 0:F.success)&&e.jsxs("div",{className:t.migrationSection,children:[e.jsxs("div",{className:t.sectionHeader,children:[e.jsx(ae,{size:18}),e.jsx("h4",{children:"Data Ready for Import"})]}),e.jsx("div",{className:t.clioDataSummary,children:e.jsxs("p",{children:[e.jsx("strong",{children:((Wt=F.summary)==null?void 0:Wt.users)||0})," users,",e.jsxs("strong",{children:[" ",((Ht=F.summary)==null?void 0:Ht.contacts)||0]})," contacts,",e.jsxs("strong",{children:[" ",((Gt=F.summary)==null?void 0:Gt.matters)||0]})," matters,",e.jsxs("strong",{children:[" ",((Vt=F.summary)==null?void 0:Vt.activities)||0]})," time entries,",e.jsxs("strong",{children:[" ",((qt=F.summary)==null?void 0:qt.calendar_entries)||0]})," calendar events"]})}),e.jsxs("div",{className:t.dataEditorSection,children:[e.jsxs("button",{onClick:()=>{const s=document.getElementById("clio-data-editor");s&&(s.style.display=s.style.display==="none"?"block":"none")},className:t.secondaryBtn,style:{marginBottom:"0.5rem"},children:[e.jsx(Xs,{size:16}),"Edit Data (Advanced)"]}),e.jsx("textarea",{id:"clio-data-editor",style:{display:"none",width:"100%",height:"300px",fontFamily:"monospace",fontSize:"12px"},value:q,onChange:s=>le(s.target.value)}),e.jsx("p",{className:t.sectionDescription,style:{fontSize:"0.8rem",marginTop:"0.25rem"},children:"Edit the JSON data to remove users or fix any issues before importing."})]}),e.jsxs("div",{className:t.aiActions,children:[e.jsxs("button",{onClick:Lt,className:t.secondaryBtn,children:[e.jsx(zs,{size:18}),"Validate First (Optional)"]}),e.jsx("button",{onClick:async()=>{var s;if(!q.trim()){n("error","No data to import");return}ve(!0);try{const r=JSON.parse(q),a=await(await fetch(`${p}/migration/import`,{method:"POST",headers:h(),body:JSON.stringify({data:r})})).json();ss(a),je("complete"),a.success?(n("success",`✅ Migration complete! Created firm "${a.firm_name}"`),await H()):n("error",`Import had issues: ${((s=a.errors)==null?void 0:s.slice(0,2).join(", "))||"Check results"}`)}catch(r){console.error("Import error:",r),n("error","Failed to import. Check JSON format.")}ve(!1)},disabled:fe,className:t.primaryBtn,children:fe?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:18,className:t.spinner})," Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{size:18})," Import to Database"]})})]}),e.jsxs("p",{className:t.sectionDescription,style:{marginTop:"1rem",fontSize:"0.85rem"},children:[e.jsx("strong",{children:"Note:"})," Duplicate users/matters are handled automatically - existing users will be linked, and matter numbers will be made unique."]})]})]}):Rs?e.jsxs("div",{className:t.aiTransformSection,children:[e.jsxs("div",{className:t.aiHeader,children:[e.jsx(K,{size:24}),e.jsxs("div",{children:[e.jsx("h4",{children:"Import from Clio (or any Case Management Software)"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Step 1:"})," Fill in firm info and paste your CSV exports below",e.jsx("br",{}),e.jsx("strong",{children:"Step 2:"}),' Click "Parse CSV Data" to convert',e.jsx("br",{}),e.jsx("strong",{children:"Step 3:"}),' Click "Validate Data" to check for errors',e.jsx("br",{}),e.jsx("strong",{children:"Step 4:"}),' Click "Execute Import" to save to database']})]})]}),e.jsxs("div",{className:t.migrationSection,children:[e.jsxs("div",{className:t.sectionHeader,children:[e.jsx(Q,{size:18}),e.jsx("h4",{children:"1. Firm Information"})]}),e.jsxs("div",{className:t.firmInputGrid,children:[e.jsxs("div",{className:t.inputField,children:[e.jsx("label",{htmlFor:"mig-firm-name",children:"Firm Name *"}),e.jsx("input",{id:"mig-firm-name",name:"firmName",type:"text",autoComplete:"organization",value:u.firmName,onChange:s=>I(r=>({...r,firmName:s.target.value})),placeholder:"Smith & Associates LLP"})]}),e.jsxs("div",{className:t.inputField,children:[e.jsx("label",{htmlFor:"mig-firm-email",children:"Firm Email"}),e.jsx("input",{id:"mig-firm-email",name:"firmEmail",type:"email",autoComplete:"email",value:u.firmEmail,onChange:s=>I(r=>({...r,firmEmail:s.target.value})),placeholder:"info@smithlaw.com"})]}),e.jsxs("div",{className:t.inputField,children:[e.jsx("label",{htmlFor:"mig-firm-phone",children:"Firm Phone"}),e.jsx("input",{id:"mig-firm-phone",name:"firmPhone",type:"tel",autoComplete:"tel",value:u.firmPhone,onChange:s=>I(r=>({...r,firmPhone:s.target.value})),placeholder:"555-123-4567"})]}),e.jsxs("div",{className:t.inputField,children:[e.jsx("label",{htmlFor:"mig-firm-address",children:"Firm Address"}),e.jsx("input",{id:"mig-firm-address",name:"firmAddress",type:"text",autoComplete:"street-address",value:u.firmAddress,onChange:s=>I(r=>({...r,firmAddress:s.target.value})),placeholder:"123 Legal Way, Boston, MA 02101"})]})]})]}),e.jsxs("div",{className:t.migrationSection,children:[e.jsxs("div",{className:t.sectionHeader,children:[e.jsx(V,{size:18}),e.jsx("h4",{children:"2. Users / Team Members"})]}),e.jsxs("p",{className:t.sectionDescription,children:["Copy the user list from ",e.jsx("strong",{children:"Clio → Settings → Firm → Users"})," and paste below. Passwords will be auto-generated and shown after import."]}),e.jsx("textarea",{value:u.users,onChange:s=>I(r=>({...r,users:s.target.value})),placeholder:`Name, Email, Role, Rate
Jane Smith, jane@smithlaw.com, Attorney, $400
Bob Johnson, bob@smithlaw.com, Paralegal, $150`,rows:5}),e.jsxs("div",{className:t.userAiButton,children:[e.jsxs("button",{onClick:async()=>{if(!u.users.trim()){n("error","Please paste user data first");return}js(!0);try{const s=await fetch(`${p}/migration/ai-format-users`,{method:"POST",headers:h(),body:JSON.stringify({rawUsers:u.users})}),r=await s.json();s.ok&&r.success?(I(i=>({...i,users:r.formattedCsv})),n("success",`Formatted ${r.userCount} users into CSV format`)):n("error",r.error||"Failed to format users")}catch{n("error","Failed to format users")}js(!1)},disabled:gs||!u.users.trim(),className:t.formatUsersBtn,children:[e.jsx(ma,{size:14}),gs?"Formatting...":"AI Format to CSV"]}),e.jsx("span",{className:t.formatHint,children:"Click to convert messy data into proper CSV format"})]})]}),e.jsxs("div",{className:t.migrationSection,children:[e.jsxs("div",{className:t.sectionHeader,children:[e.jsx(Ks,{size:18}),e.jsx("h4",{children:"3. Clients / Contacts"}),e.jsx("span",{className:t.sectionHint,children:"From Clio: Contacts → Export → CSV"})]}),e.jsxs("div",{className:t.csvUploadArea,children:[e.jsx("input",{type:"file",accept:".csv,.txt",onChange:s=>{var i;const r=(i=s.target.files)==null?void 0:i[0];if(r){const a=new FileReader;a.onload=c=>{I(d=>{var m;return{...d,clients:(m=c.target)==null?void 0:m.result}})},a.readAsText(r)}},id:"clients-csv",className:t.fileInput}),e.jsxs("label",{htmlFor:"clients-csv",className:t.csvUploadLabel,children:[e.jsx(K,{size:20}),e.jsx("span",{children:u.clients?"✓ CSV Loaded":"Upload Contacts CSV"})]}),u.clients&&e.jsx("button",{className:t.clearBtn,onClick:()=>I(s=>({...s,clients:""})),children:"Clear"})]}),u.clients&&e.jsx("div",{className:t.csvPreview,children:e.jsxs("span",{children:[u.clients.split(`
`).length," rows loaded"]})})]}),e.jsxs("div",{className:t.migrationSection,children:[e.jsxs("div",{className:t.sectionHeader,children:[e.jsx(ws,{size:18}),e.jsx("h4",{children:"4. Matters / Cases"}),e.jsx("span",{className:t.sectionHint,children:"From Clio: Matters → Export → CSV"})]}),e.jsxs("div",{className:t.csvUploadArea,children:[e.jsx("input",{type:"file",accept:".csv,.txt",onChange:s=>{var i;const r=(i=s.target.files)==null?void 0:i[0];if(r){const a=new FileReader;a.onload=c=>{I(d=>{var m;return{...d,matters:(m=c.target)==null?void 0:m.result}})},a.readAsText(r)}},id:"matters-csv",className:t.fileInput}),e.jsxs("label",{htmlFor:"matters-csv",className:t.csvUploadLabel,children:[e.jsx(K,{size:20}),e.jsx("span",{children:u.matters?"✓ CSV Loaded":"Upload Matters CSV"})]}),u.matters&&e.jsx("button",{className:t.clearBtn,onClick:()=>I(s=>({...s,matters:""})),children:"Clear"})]}),u.matters&&e.jsx("div",{className:t.csvPreview,children:e.jsxs("span",{children:[u.matters.split(`
`).length," rows loaded"]})})]}),e.jsxs("div",{className:t.migrationSection,children:[e.jsxs("div",{className:t.sectionHeader,children:[e.jsx(re,{size:18}),e.jsx("h4",{children:"5. Time Entries (Optional)"}),e.jsx("span",{className:t.sectionHint,children:"From Clio: Activities → Export → CSV"})]}),e.jsxs("div",{className:t.csvUploadArea,children:[e.jsx("input",{type:"file",accept:".csv,.txt",onChange:s=>{var i;const r=(i=s.target.files)==null?void 0:i[0];if(r){const a=new FileReader;a.onload=c=>{I(d=>{var m;return{...d,timeEntries:(m=c.target)==null?void 0:m.result}})},a.readAsText(r)}},id:"time-csv",className:t.fileInput}),e.jsxs("label",{htmlFor:"time-csv",className:t.csvUploadLabel,children:[e.jsx(K,{size:20}),e.jsx("span",{children:u.timeEntries?"✓ CSV Loaded":"Upload Time Entries CSV"})]}),u.timeEntries&&e.jsx("button",{className:t.clearBtn,onClick:()=>I(s=>({...s,timeEntries:""})),children:"Clear"})]}),u.timeEntries&&e.jsx("div",{className:t.csvPreview,children:e.jsxs("span",{children:[u.timeEntries.split(`
`).length," rows loaded"]})})]}),e.jsxs("div",{className:t.migrationSection,children:[e.jsxs("div",{className:t.sectionHeader,children:[e.jsx(qe,{size:18}),e.jsx("h4",{children:"6. Calendar Events (Optional)"}),e.jsx("span",{className:t.sectionHint,children:"From Clio: Calendar → Export → CSV"})]}),e.jsxs("div",{className:t.csvUploadArea,children:[e.jsx("input",{type:"file",accept:".csv,.txt",onChange:s=>{var i;const r=(i=s.target.files)==null?void 0:i[0];if(r){const a=new FileReader;a.onload=c=>{I(d=>{var m;return{...d,calendarEvents:(m=c.target)==null?void 0:m.result}})},a.readAsText(r)}},id:"calendar-csv",className:t.fileInput}),e.jsxs("label",{htmlFor:"calendar-csv",className:t.csvUploadLabel,children:[e.jsx(K,{size:20}),e.jsx("span",{children:u.calendarEvents?"✓ CSV Loaded":"Upload Calendar CSV"})]}),u.calendarEvents&&e.jsx("button",{className:t.clearBtn,onClick:()=>I(s=>({...s,calendarEvents:""})),children:"Clear"})]}),u.calendarEvents&&e.jsx("div",{className:t.csvPreview,children:e.jsxs("span",{children:[u.calendarEvents.split(`
`).length," rows loaded"]})})]}),e.jsxs("div",{className:t.migrationSection,children:[e.jsxs("div",{className:t.sectionHeader,children:[e.jsx(Je,{size:18}),e.jsx("h4",{children:"7. Bills / Invoices"})]}),e.jsxs("p",{className:t.sectionDescription,children:["Export from ",e.jsx("strong",{children:"Clio → Reports → Bills"}),". Columns: Invoice#, Matter, Client, Date, Amount, Status, Due Date, Balance"]}),e.jsxs("div",{className:t.csvUploadArea,children:[e.jsx("input",{type:"file",accept:".csv,.txt",onChange:s=>{var i;const r=(i=s.target.files)==null?void 0:i[0];if(r){const a=new FileReader;a.onload=c=>{I(d=>{var m;return{...d,bills:(m=c.target)==null?void 0:m.result}})},a.readAsText(r)}},id:"bills-csv",className:t.fileInput}),e.jsxs("label",{htmlFor:"bills-csv",className:t.csvUploadLabel,children:[e.jsx(K,{size:20}),e.jsx("span",{children:u.bills?"✓ CSV Loaded":"Upload Bills CSV"})]}),u.bills&&e.jsx("button",{className:t.clearBtn,onClick:()=>I(s=>({...s,bills:""})),children:"Clear"})]}),u.bills&&e.jsx("div",{className:t.csvPreview,children:e.jsxs("span",{children:[u.bills.split(`
`).length," rows loaded"]})})]}),e.jsx("div",{className:t.aiActions,children:e.jsx("button",{onClick:Jn,disabled:!u.firmName.trim()||gs,className:t.aiTransformBtn,children:gs?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:18,className:t.spinner}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{size:18}),"Parse CSV Data"]})})}),F&&e.jsx("div",{className:`${t.transformResult} ${F.success?t.success:t.error}`,children:F.success?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:t.transformHeader,children:[e.jsx(ae,{size:24}),e.jsxs("div",{children:[e.jsx("h4",{children:"Transformation Successful!"}),e.jsx("p",{children:"AI has converted your data to the migration format."})]})]}),e.jsxs("div",{className:t.transformSummary,children:[e.jsxs("div",{className:t.summaryItem,children:[e.jsx(Q,{size:16}),e.jsxs("span",{children:["Firm: ",(Jt=F.summary)==null?void 0:Jt.firm]})]}),e.jsxs("div",{className:t.summaryItem,children:[e.jsx(V,{size:16}),e.jsxs("span",{children:[(Qt=F.summary)==null?void 0:Qt.users," Users"]})]}),e.jsxs("div",{className:t.summaryItem,children:[e.jsx("span",{children:"👤"}),e.jsxs("span",{children:[(Kt=F.summary)==null?void 0:Kt.contacts," Contacts"]})]}),e.jsxs("div",{className:t.summaryItem,children:[e.jsx("span",{children:"📁"}),e.jsxs("span",{children:[(Yt=F.summary)==null?void 0:Yt.matters," Matters"]})]}),e.jsxs("div",{className:t.summaryItem,children:[e.jsx(re,{size:16}),e.jsxs("span",{children:[(Xt=F.summary)==null?void 0:Xt.activities," Activities"]})]}),e.jsxs("div",{className:t.summaryItem,children:[e.jsx("span",{children:"📅"}),e.jsxs("span",{children:[(Zt=F.summary)==null?void 0:Zt.calendar_entries," Events"]})]})]}),e.jsx("p",{className:t.transformNote,children:"The transformed data has been loaded below. Review and proceed to validation."})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:t.transformHeader,children:[e.jsx(xe,{size:24}),e.jsxs("div",{children:[e.jsx("h4",{children:"Transformation Failed"}),e.jsx("p",{children:F.error})]})]})})}),(F==null?void 0:F.success)&&q&&e.jsxs("div",{className:t.jsonPreview,children:[e.jsxs("div",{className:t.previewHeader,children:[e.jsx("h4",{children:"Transformed JSON Data"}),e.jsxs("button",{onClick:()=>G(q),className:t.copyBtn,children:[e.jsx(O,{size:14}),"Copy"]})]}),e.jsx("textarea",{value:q,onChange:s=>le(s.target.value),rows:10,className:t.jsonPreviewText})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:t.templateDownload,children:[e.jsxs("button",{onClick:Gn,className:t.templateBtn,children:[e.jsx(Xs,{size:18}),"Download Clio Format Template"]}),e.jsx("span",{className:t.templateHint,children:"Use this template as a reference for the expected data format"})]}),e.jsxs("div",{className:t.uploadArea,children:[e.jsx("input",{type:"file",accept:".json",onChange:Vn,id:"migration-file",className:t.fileInput}),e.jsxs("label",{htmlFor:"migration-file",className:t.uploadLabel,children:[e.jsx(K,{size:32}),e.jsx("span",{children:"Drop JSON file here or click to upload"})]})]}),e.jsx("div",{className:t.orDivider,children:e.jsx("span",{children:"OR"})}),e.jsxs("div",{className:t.jsonInput,children:[e.jsx("label",{children:"Paste JSON Data:"}),e.jsx("textarea",{value:q,onChange:s=>le(s.target.value),placeholder:'{"firm": {"name": "..."}, "users": [...], "contacts": [...], ...}',rows:12})]})]}),e.jsx("div",{className:t.migrationActions,children:e.jsxs("button",{onClick:Lt,disabled:!q.trim()||fe,className:t.primaryBtn,children:[fe?"Validating...":"Validate Data",e.jsx(Ke,{size:18})]})})]}),ne==="validate"&&P&&e.jsxs("div",{className:t.validationResults,children:[e.jsx("div",{className:`${t.validationHeader} ${P.valid?t.valid:t.invalid}`,children:P.valid?e.jsxs(e.Fragment,{children:[e.jsx(ae,{size:32}),e.jsxs("div",{children:[e.jsx("h3",{children:"Validation Passed"}),e.jsx("p",{children:"Your data is ready to import"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{size:32}),e.jsxs("div",{children:[e.jsx("h3",{children:"Validation Failed"}),e.jsx("p",{children:"Please fix the errors below before importing"})]})]})}),e.jsxs("div",{className:t.summaryCard,children:[e.jsx("h4",{children:"Migration Summary"}),e.jsxs("div",{className:t.summaryGrid,children:[e.jsxs("div",{className:t.summaryItem,children:[e.jsx(Q,{size:20}),e.jsxs("span",{children:["Firm: ",P.summary.firm||"N/A"]})]}),e.jsxs("div",{className:t.summaryItem,children:[e.jsx(V,{size:20}),e.jsxs("span",{children:[P.summary.users," Users"]})]}),e.jsxs("div",{className:t.summaryItem,children:[e.jsx("span",{className:t.summaryIcon,children:"👤"}),e.jsxs("span",{children:[P.summary.contacts," Contacts"]})]}),e.jsxs("div",{className:t.summaryItem,children:[e.jsx("span",{className:t.summaryIcon,children:"📁"}),e.jsxs("span",{children:[P.summary.matters," Matters"]})]}),e.jsxs("div",{className:t.summaryItem,children:[e.jsx(re,{size:20}),e.jsxs("span",{children:[P.summary.activities," Activities"]})]}),e.jsxs("div",{className:t.summaryItem,children:[e.jsx("span",{className:t.summaryIcon,children:"📅"}),e.jsxs("span",{children:[P.summary.calendar_entries," Calendar Entries"]})]})]})]}),P.errors.length>0&&e.jsxs("div",{className:t.errorList,children:[e.jsxs("h4",{children:[e.jsx(xe,{size:18})," Errors (",P.errors.length,")"]}),e.jsx("ul",{children:P.errors.map((s,r)=>e.jsx("li",{children:s},r))})]}),P.warnings.length>0&&e.jsxs("div",{className:t.warningList,children:[e.jsxs("h4",{children:[e.jsx(zs,{size:18})," Warnings (",P.warnings.length,")"]}),e.jsx("ul",{children:P.warnings.map((s,r)=>e.jsx("li",{children:s},r))})]}),e.jsxs("div",{className:t.migrationActions,children:[e.jsx("button",{onClick:Pt,className:t.secondaryBtn,children:"← Back to Edit"}),e.jsxs("button",{onClick:qn,disabled:fe,className:t.primaryBtn,children:[fe?"Importing...":P.valid?"Import Data":"Import Anyway (Skip Errors)",e.jsx(Ke,{size:18})]})]}),!P.valid&&e.jsxs("p",{style:{fontSize:"0.85rem",color:"#666",marginTop:"0.5rem"},children:[e.jsx("strong",{children:"Note:"})," Duplicates and some errors are handled automatically. Existing users will be linked, matter numbers will be made unique."]})]}),ne==="complete"&&T&&e.jsxs("div",{className:t.importComplete,children:[e.jsx("div",{className:`${t.importHeader} ${T.success?t.success:t.failed}`,children:T.success?e.jsxs(e.Fragment,{children:[e.jsx(ue,{size:48}),e.jsxs("div",{children:[e.jsx("h3",{children:"Migration Complete!"}),e.jsxs("p",{children:['Firm "',T.firm_name,'" has been successfully created']})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{size:48}),e.jsxs("div",{children:[e.jsx("h3",{children:"Migration Failed"}),e.jsx("p",{children:"An error occurred during import"})]})]})}),T.success&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:t.importSummary,children:[e.jsx("h4",{children:"Imported Records"}),e.jsxs("div",{className:t.importGrid,children:[e.jsxs("div",{className:t.importItem,children:[e.jsx("span",{className:t.importCount,children:T.imported.users}),e.jsx("span",{children:"Users"})]}),e.jsxs("div",{className:t.importItem,children:[e.jsx("span",{className:t.importCount,children:T.imported.contacts}),e.jsx("span",{children:"Contacts"})]}),e.jsxs("div",{className:t.importItem,children:[e.jsx("span",{className:t.importCount,children:T.imported.matters}),e.jsx("span",{children:"Matters"})]}),e.jsxs("div",{className:t.importItem,children:[e.jsx("span",{className:t.importCount,children:T.imported.time_entries}),e.jsx("span",{children:"Time Entries"})]}),e.jsxs("div",{className:t.importItem,children:[e.jsx("span",{className:t.importCount,children:T.imported.expenses}),e.jsx("span",{children:"Expenses"})]}),e.jsxs("div",{className:t.importItem,children:[e.jsx("span",{className:t.importCount,children:T.imported.calendar_entries}),e.jsx("span",{children:"Calendar Events"})]})]})]}),T.user_credentials&&T.user_credentials.length>0&&e.jsxs("div",{className:t.credentialsSection,children:[e.jsxs("div",{className:t.credentialsHeader,children:[e.jsx(ie,{size:20}),e.jsx("h4",{children:"User Login Credentials"}),e.jsxs("button",{onClick:()=>{const s=T.user_credentials.map(r=>`${r.name} (${r.role})
Email: ${r.email}
Password: ${r.password}
`).join(`
---
`);G(s)},className:t.copyAllBtn,children:[e.jsx(O,{size:14}),"Copy All"]})]}),e.jsx("p",{className:t.credentialsNote,children:"⚠️ Save these passwords now! They cannot be retrieved later."}),e.jsx("div",{className:t.credentialsList,children:T.user_credentials.map((s,r)=>e.jsxs("div",{className:t.credentialCard,children:[e.jsxs("div",{className:t.credentialName,children:[e.jsx("span",{children:s.name}),e.jsx("span",{className:t.credentialRole,children:s.role})]}),e.jsxs("div",{className:t.credentialDetails,children:[e.jsxs("div",{className:t.credentialRow,children:[e.jsx(ke,{size:14}),e.jsx("span",{children:s.email}),e.jsx("button",{onClick:()=>G(s.email),title:"Copy email",children:e.jsx(O,{size:12})})]}),e.jsxs("div",{className:t.credentialRow,children:[e.jsx(ie,{size:14}),e.jsx("code",{children:s.password}),e.jsx("button",{onClick:()=>G(s.password),title:"Copy password",children:e.jsx(O,{size:12})})]})]})]},r))})]})]}),T.errors.length>0&&e.jsxs("div",{className:t.errorList,children:[e.jsxs("h4",{children:[e.jsx(xe,{size:18})," Errors"]}),e.jsx("ul",{children:T.errors.map((s,r)=>e.jsx("li",{children:s},r))})]}),T.warnings.length>0&&e.jsxs("div",{className:t.warningList,children:[e.jsxs("h4",{children:[e.jsx(zs,{size:18})," Warnings"]}),e.jsx("ul",{children:T.warnings.map((s,r)=>e.jsx("li",{children:s},r))})]}),e.jsx("div",{className:t.migrationActions,children:e.jsxs("button",{onClick:Pt,className:t.primaryBtn,children:[e.jsx(Qe,{size:18}),"Start New Migration"]})})]})]}),N==="audit"&&e.jsxs("div",{className:t.listTab,children:[e.jsxs("div",{className:t.listHeader,children:[e.jsxs("h2",{className:t.pageTitle,children:[e.jsx(qe,{size:24}),"Audit Log"]}),e.jsx("div",{className:t.listActions,children:e.jsxs("button",{className:t.secondaryBtn,onClick:()=>{const s=As.map(c=>`${new Date(c.timestamp).toISOString()},${c.action},${c.user},${c.details},${c.ip_address}`).join(`
`),r=new Blob([`Timestamp,Action,User,Details,IP Address
${s}`],{type:"text/csv"}),i=URL.createObjectURL(r),a=document.createElement("a");a.href=i,a.download="audit-logs.csv",a.click(),URL.revokeObjectURL(i)},children:[e.jsx(Zs,{size:16}),"Export CSV"]})})]}),e.jsxs("div",{className:t.tableWrapper,children:[e.jsxs("table",{className:t.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Timestamp"}),e.jsx("th",{children:"Action"}),e.jsx("th",{children:"Admin"}),e.jsx("th",{children:"Target"}),e.jsx("th",{children:"Details"}),e.jsx("th",{children:"IP Address"})]})}),e.jsx("tbody",{children:As.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(s.timestamp).toLocaleString()}),e.jsx("td",{children:e.jsx("span",{className:t.actionBadge,children:s.action})}),e.jsx("td",{children:s.user}),e.jsx("td",{children:s.target_user||"—"}),e.jsx("td",{children:s.details}),e.jsx("td",{className:t.ipAddress,children:s.ip_address})]},s.id))})]}),As.length===0&&e.jsx("div",{className:t.emptyState,children:"No audit logs found"})]})]}),N==="integrations"&&e.jsxs("div",{className:t.listTab,children:[e.jsx("div",{className:t.listHeader,children:e.jsxs("h2",{className:t.pageTitle,children:[e.jsx(ie,{size:24}),"Integration OAuth Credentials"]})}),e.jsx("p",{style:{color:"#94a3b8",marginBottom:"1.5rem"},children:"Configure OAuth Client IDs and Secrets for all integrations. Users will be able to connect their accounts once these are configured."}),Sn?e.jsx("div",{className:t.emptyState,children:"Loading settings..."}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{className:t.card,style:{borderColor:(er=l.microsoft_client_id)!=null&&er.isConfigured&&((sr=l.microsoft_client_secret)!=null&&sr.isConfigured)?"#10b981":void 0,borderWidth:(tr=l.microsoft_client_id)!=null&&tr.isConfigured&&((rr=l.microsoft_client_secret)!=null&&rr.isConfigured)?"2px":void 0,background:(ir=l.microsoft_client_id)!=null&&ir.isConfigured&&((nr=l.microsoft_client_secret)!=null&&nr.isConfigured)?"linear-gradient(135deg, rgba(16, 185, 129, 0.05) 0%, rgba(30, 41, 59, 1) 100%)":void 0},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:0},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:"📧"})," Microsoft (Outlook + Word + OneDrive)"]}),((ar=l.microsoft_client_id)==null?void 0:ar.isConfigured)&&((or=l.microsoft_client_secret)==null?void 0:or.isConfigured)&&e.jsx("span",{style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",padding:"0.25rem 0.75rem",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.25rem"},children:"✓ Configured"})]}),e.jsx("p",{style:{color:"#64748b",fontSize:"0.875rem",marginBottom:"1rem"},children:e.jsx("a",{href:"https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade",target:"_blank",rel:"noopener noreferrer",style:{color:"#d4af37"},children:"Register app in Azure Portal →"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:t.formGroup,children:[e.jsxs("label",{children:["Client ID ",((lr=l.microsoft_client_id)==null?void 0:lr.isConfigured)&&e.jsx("span",{style:{color:"#10b981"},children:"✓"})]}),e.jsx("input",{type:"text",value:((cr=l.microsoft_client_id)==null?void 0:cr.value)||"",onChange:s=>_("microsoft_client_id",s.target.value),placeholder:"Enter Client ID",style:(dr=l.microsoft_client_id)!=null&&dr.isConfigured?{borderColor:"#10b981"}:void 0})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsxs("label",{children:["Client Secret ",((mr=l.microsoft_client_secret)==null?void 0:mr.isConfigured)&&e.jsx("span",{style:{color:"#10b981"},children:"✓"})]}),e.jsx("input",{type:"password",value:((pr=l.microsoft_client_secret)==null?void 0:pr.value)||"",onChange:s=>_("microsoft_client_secret",s.target.value),placeholder:(ur=l.microsoft_client_secret)!=null&&ur.isConfigured?"••••••••":"Enter Secret",style:(hr=l.microsoft_client_secret)!=null&&hr.isConfigured?{borderColor:"#10b981"}:void 0})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsxs("label",{children:["Redirect URI ",((xr=l.microsoft_redirect_uri)==null?void 0:xr.isConfigured)&&e.jsx("span",{style:{color:"#10b981"},children:"✓"})]}),e.jsx("input",{type:"text",value:((gr=l.microsoft_redirect_uri)==null?void 0:gr.value)||"",onChange:s=>_("microsoft_redirect_uri",s.target.value),placeholder:"https://your-api/api/integrations/outlook/callback",style:(jr=l.microsoft_redirect_uri)!=null&&jr.isConfigured?{borderColor:"#10b981"}:void 0})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsxs("label",{children:["Tenant ",((fr=l.microsoft_tenant)==null?void 0:fr.isConfigured)&&e.jsx("span",{style:{color:"#10b981"},children:"✓"})]}),e.jsx("input",{type:"text",value:((vr=l.microsoft_tenant)==null?void 0:vr.value)||"common",onChange:s=>_("microsoft_tenant",s.target.value),placeholder:"common",style:(yr=l.microsoft_tenant)!=null&&yr.isConfigured?{borderColor:"#10b981"}:void 0})]})]}),((_r=l.microsoft_client_id)==null?void 0:_r.isConfigured)&&((br=l.microsoft_client_secret)==null?void 0:br.isConfigured)&&e.jsx("p",{style:{color:"#10b981",fontSize:"0.75rem",marginTop:"1rem",fontWeight:"500"},children:"✓ Microsoft integration is configured. Users can connect Outlook, Word Online, and OneDrive."})]}),e.jsxs("div",{className:t.card,children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:"📅"})," Google (Calendar + Drive)"]}),e.jsx("p",{style:{color:"#64748b",fontSize:"0.875rem",marginBottom:"1rem"},children:e.jsx("a",{href:"https://console.cloud.google.com/apis/credentials",target:"_blank",rel:"noopener noreferrer",style:{color:"#d4af37"},children:"Create credentials in Google Cloud →"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Client ID"}),e.jsx("input",{type:"text",value:((Sr=l.google_client_id)==null?void 0:Sr.value)||"",onChange:s=>_("google_client_id",s.target.value),placeholder:"Enter Client ID"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Client Secret"}),e.jsx("input",{type:"password",value:((Cr=l.google_client_secret)==null?void 0:Cr.value)||"",onChange:s=>_("google_client_secret",s.target.value),placeholder:(Nr=l.google_client_secret)!=null&&Nr.isConfigured?"••••••••":"Enter Secret"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Redirect URI"}),e.jsx("input",{type:"text",value:((wr=l.google_redirect_uri)==null?void 0:wr.value)||"",onChange:s=>_("google_redirect_uri",s.target.value),placeholder:"https://your-api/api/integrations/google/callback"})]})]})]}),e.jsxs("div",{className:t.card,style:{borderColor:(kr=l.quickbooks_client_id)!=null&&kr.isConfigured&&((Fr=l.quickbooks_client_secret)!=null&&Fr.isConfigured)?"#10b981":void 0,borderWidth:(Ir=l.quickbooks_client_id)!=null&&Ir.isConfigured&&((zr=l.quickbooks_client_secret)!=null&&zr.isConfigured)?"2px":void 0,background:(Br=l.quickbooks_client_id)!=null&&Br.isConfigured&&((Ar=l.quickbooks_client_secret)!=null&&Ar.isConfigured)?"linear-gradient(135deg, rgba(16, 185, 129, 0.05) 0%, rgba(30, 41, 59, 1) 100%)":void 0},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:0},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:"📊"})," QuickBooks"]}),((Er=l.quickbooks_client_id)==null?void 0:Er.isConfigured)&&((Tr=l.quickbooks_client_secret)==null?void 0:Tr.isConfigured)&&e.jsx("span",{style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",padding:"0.25rem 0.75rem",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.25rem"},children:"✓ Configured"})]}),e.jsx("p",{style:{color:"#64748b",fontSize:"0.875rem",marginBottom:"1rem"},children:e.jsx("a",{href:"https://developer.intuit.com/app/developer/dashboard",target:"_blank",rel:"noopener noreferrer",style:{color:"#d4af37"},children:"Register in Intuit Developer →"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:t.formGroup,children:[e.jsxs("label",{children:["Client ID ",((Dr=l.quickbooks_client_id)==null?void 0:Dr.isConfigured)&&e.jsx("span",{style:{color:"#10b981"},children:"✓"})]}),e.jsx("input",{type:"text",value:((Rr=l.quickbooks_client_id)==null?void 0:Rr.value)||"",onChange:s=>_("quickbooks_client_id",s.target.value),placeholder:"Enter Client ID",style:(Lr=l.quickbooks_client_id)!=null&&Lr.isConfigured?{borderColor:"#10b981"}:void 0})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsxs("label",{children:["Client Secret ",((Pr=l.quickbooks_client_secret)==null?void 0:Pr.isConfigured)&&e.jsx("span",{style:{color:"#10b981"},children:"✓"})]}),e.jsx("input",{type:"password",value:(($r=l.quickbooks_client_secret)==null?void 0:$r.value)||"",onChange:s=>_("quickbooks_client_secret",s.target.value),placeholder:(Ur=l.quickbooks_client_secret)!=null&&Ur.isConfigured?"••••••••":"Enter Secret",style:(Or=l.quickbooks_client_secret)!=null&&Or.isConfigured?{borderColor:"#10b981"}:void 0})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsxs("label",{children:["Redirect URI ",((Mr=l.quickbooks_redirect_uri)==null?void 0:Mr.isConfigured)&&e.jsx("span",{style:{color:"#10b981"},children:"✓"})]}),e.jsx("input",{type:"text",value:((Wr=l.quickbooks_redirect_uri)==null?void 0:Wr.value)||"",onChange:s=>_("quickbooks_redirect_uri",s.target.value),placeholder:"https://your-api/api/integrations/quickbooks/callback",style:(Hr=l.quickbooks_redirect_uri)!=null&&Hr.isConfigured?{borderColor:"#10b981"}:void 0})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsxs("label",{children:["Environment ",((Gr=l.quickbooks_environment)==null?void 0:Gr.isConfigured)&&e.jsx("span",{style:{color:"#10b981"},children:"✓"})]}),e.jsxs("select",{value:((Vr=l.quickbooks_environment)==null?void 0:Vr.value)||"sandbox",onChange:s=>_("quickbooks_environment",s.target.value),style:(qr=l.quickbooks_environment)!=null&&qr.isConfigured?{borderColor:"#10b981"}:void 0,children:[e.jsx("option",{value:"sandbox",children:"Sandbox"}),e.jsx("option",{value:"production",children:"Production"})]})]})]}),((Jr=l.quickbooks_client_id)==null?void 0:Jr.isConfigured)&&((Qr=l.quickbooks_client_secret)==null?void 0:Qr.isConfigured)&&e.jsx("p",{style:{color:"#10b981",fontSize:"0.75rem",marginTop:"1rem",fontWeight:"500"},children:"✓ QuickBooks integration is configured. Users can connect their QuickBooks accounts."})]}),e.jsxs("div",{className:t.card,children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:"📦"})," Dropbox"]}),e.jsx("p",{style:{color:"#64748b",fontSize:"0.875rem",marginBottom:"1rem"},children:e.jsx("a",{href:"https://www.dropbox.com/developers/apps",target:"_blank",rel:"noopener noreferrer",style:{color:"#d4af37"},children:"Create app in Dropbox →"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"App Key (Client ID)"}),e.jsx("input",{type:"text",value:((Kr=l.dropbox_client_id)==null?void 0:Kr.value)||"",onChange:s=>_("dropbox_client_id",s.target.value),placeholder:"Enter App Key"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"App Secret"}),e.jsx("input",{type:"password",value:((Yr=l.dropbox_client_secret)==null?void 0:Yr.value)||"",onChange:s=>_("dropbox_client_secret",s.target.value),placeholder:(Xr=l.dropbox_client_secret)!=null&&Xr.isConfigured?"••••••••":"Enter Secret"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Redirect URI"}),e.jsx("input",{type:"text",value:((Zr=l.dropbox_redirect_uri)==null?void 0:Zr.value)||"",onChange:s=>_("dropbox_redirect_uri",s.target.value),placeholder:"https://your-api/api/integrations/dropbox/callback"})]})]})]}),e.jsxs("div",{className:t.card,children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:"✍️"})," DocuSign"]}),e.jsx("p",{style:{color:"#64748b",fontSize:"0.875rem",marginBottom:"1rem"},children:e.jsx("a",{href:"https://admindemo.docusign.com/apps-and-keys",target:"_blank",rel:"noopener noreferrer",style:{color:"#d4af37"},children:"Get keys from DocuSign →"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Integration Key"}),e.jsx("input",{type:"text",value:((ei=l.docusign_client_id)==null?void 0:ei.value)||"",onChange:s=>_("docusign_client_id",s.target.value),placeholder:"Enter Integration Key"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Secret Key"}),e.jsx("input",{type:"password",value:((si=l.docusign_client_secret)==null?void 0:si.value)||"",onChange:s=>_("docusign_client_secret",s.target.value),placeholder:(ti=l.docusign_client_secret)!=null&&ti.isConfigured?"••••••••":"Enter Secret"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Redirect URI"}),e.jsx("input",{type:"text",value:((ri=l.docusign_redirect_uri)==null?void 0:ri.value)||"",onChange:s=>_("docusign_redirect_uri",s.target.value),placeholder:"https://your-api/api/integrations/docusign/callback"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Environment"}),e.jsxs("select",{value:((ii=l.docusign_environment)==null?void 0:ii.value)||"demo",onChange:s=>_("docusign_environment",s.target.value),children:[e.jsx("option",{value:"demo",children:"Demo"}),e.jsx("option",{value:"production",children:"Production"})]})]})]})]}),e.jsxs("div",{className:t.card,children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:"💬"})," Slack"]}),e.jsx("p",{style:{color:"#64748b",fontSize:"0.875rem",marginBottom:"1rem"},children:e.jsx("a",{href:"https://api.slack.com/apps",target:"_blank",rel:"noopener noreferrer",style:{color:"#d4af37"},children:"Create app in Slack →"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Client ID"}),e.jsx("input",{type:"text",value:((ni=l.slack_client_id)==null?void 0:ni.value)||"",onChange:s=>_("slack_client_id",s.target.value),placeholder:"Enter Client ID"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Client Secret"}),e.jsx("input",{type:"password",value:((ai=l.slack_client_secret)==null?void 0:ai.value)||"",onChange:s=>_("slack_client_secret",s.target.value),placeholder:(oi=l.slack_client_secret)!=null&&oi.isConfigured?"••••••••":"Enter Secret"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Redirect URI"}),e.jsx("input",{type:"text",value:((li=l.slack_redirect_uri)==null?void 0:li.value)||"",onChange:s=>_("slack_redirect_uri",s.target.value),placeholder:"https://your-api/api/integrations/slack/callback"})]})]})]}),e.jsxs("div",{className:t.card,children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:"📹"})," Zoom"]}),e.jsx("p",{style:{color:"#64748b",fontSize:"0.875rem",marginBottom:"1rem"},children:e.jsx("a",{href:"https://marketplace.zoom.us/develop/create",target:"_blank",rel:"noopener noreferrer",style:{color:"#d4af37"},children:"Create app in Zoom Marketplace →"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Client ID"}),e.jsx("input",{type:"text",value:((ci=l.zoom_client_id)==null?void 0:ci.value)||"",onChange:s=>_("zoom_client_id",s.target.value),placeholder:"Enter Client ID"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Client Secret"}),e.jsx("input",{type:"password",value:((di=l.zoom_client_secret)==null?void 0:di.value)||"",onChange:s=>_("zoom_client_secret",s.target.value),placeholder:(mi=l.zoom_client_secret)!=null&&mi.isConfigured?"••••••••":"Enter Secret"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Redirect URI"}),e.jsx("input",{type:"text",value:((pi=l.zoom_redirect_uri)==null?void 0:pi.value)||"",onChange:s=>_("zoom_redirect_uri",s.target.value),placeholder:"https://your-api/api/integrations/zoom/callback"})]})]})]}),e.jsxs("div",{className:t.card,children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:"💰"})," Quicken"]}),e.jsx("p",{style:{color:"#64748b",fontSize:"0.875rem",marginBottom:"1rem"},children:e.jsx("a",{href:"https://developer.intuit.com/",target:"_blank",rel:"noopener noreferrer",style:{color:"#d4af37"},children:"Register via Intuit Developer →"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Client ID"}),e.jsx("input",{type:"text",value:((ui=l.quicken_client_id)==null?void 0:ui.value)||"",onChange:s=>_("quicken_client_id",s.target.value),placeholder:"Enter Client ID"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Client Secret"}),e.jsx("input",{type:"password",value:((hi=l.quicken_client_secret)==null?void 0:hi.value)||"",onChange:s=>_("quicken_client_secret",s.target.value),placeholder:(xi=l.quicken_client_secret)!=null&&xi.isConfigured?"••••••••":"Enter Secret"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Redirect URI"}),e.jsx("input",{type:"text",value:((gi=l.quicken_redirect_uri)==null?void 0:gi.value)||"",onChange:s=>_("quicken_redirect_uri",s.target.value),placeholder:"https://your-api/api/integrations/quicken/callback"})]})]})]}),e.jsxs("div",{className:t.card,style:{borderColor:(ji=l.azure_storage_account_name)!=null&&ji.isConfigured&&((fi=l.azure_storage_account_key)!=null&&fi.isConfigured)?"#10b981":"#0078d4",borderWidth:"2px",background:(vi=l.azure_storage_account_name)!=null&&vi.isConfigured&&((yi=l.azure_storage_account_key)!=null&&yi.isConfigured)?"linear-gradient(135deg, rgba(16, 185, 129, 0.05) 0%, rgba(30, 41, 59, 1) 100%)":void 0},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:0},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:"☁️"})," Azure Storage (Apex Drive)"]}),((_i=l.azure_storage_account_name)==null?void 0:_i.isConfigured)&&((bi=l.azure_storage_account_key)==null?void 0:bi.isConfigured)&&e.jsx("span",{style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",padding:"0.25rem 0.75rem",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.25rem"},children:"✓ Configured"})]}),e.jsxs("p",{style:{color:"#64748b",fontSize:"0.875rem",marginBottom:"1rem"},children:["Document storage for all firms. ",e.jsx("a",{href:"https://portal.azure.com/#browse/Microsoft.Storage%2FStorageAccounts",target:"_blank",rel:"noopener noreferrer",style:{color:"#d4af37"},children:"Create Storage Account in Azure →"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:t.formGroup,children:[e.jsxs("label",{children:["Storage Account Name ",((Si=l.azure_storage_account_name)==null?void 0:Si.isConfigured)&&e.jsx("span",{style:{color:"#10b981"},children:"✓"})]}),e.jsx("input",{type:"text",value:((Ci=l.azure_storage_account_name)==null?void 0:Ci.value)||"",onChange:s=>_("azure_storage_account_name",s.target.value),placeholder:"mystorageaccount",style:(Ni=l.azure_storage_account_name)!=null&&Ni.isConfigured?{borderColor:"#10b981"}:void 0})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsxs("label",{children:["Storage Account Key ",((wi=l.azure_storage_account_key)==null?void 0:wi.isConfigured)&&e.jsx("span",{style:{color:"#10b981"},children:"✓"})]}),e.jsx("input",{type:"password",value:((ki=l.azure_storage_account_key)==null?void 0:ki.value)||"",onChange:s=>_("azure_storage_account_key",s.target.value),placeholder:(Fi=l.azure_storage_account_key)!=null&&Fi.isConfigured?"••••••••":"Enter Key",style:(Ii=l.azure_storage_account_key)!=null&&Ii.isConfigured?{borderColor:"#10b981"}:void 0})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsxs("label",{children:["File Share Name ",((zi=l.azure_file_share_name)==null?void 0:zi.isConfigured)&&e.jsx("span",{style:{color:"#10b981"},children:"✓"})]}),e.jsx("input",{type:"text",value:((Bi=l.azure_file_share_name)==null?void 0:Bi.value)||"",onChange:s=>_("azure_file_share_name",s.target.value),placeholder:"apexdrive",style:(Ai=l.azure_file_share_name)!=null&&Ai.isConfigured?{borderColor:"#10b981"}:void 0})]})]}),(Ei=l.azure_storage_account_name)!=null&&Ei.isConfigured&&((Ti=l.azure_storage_account_key)!=null&&Ti.isConfigured)?e.jsxs("div",{style:{marginTop:"1rem"},children:[e.jsx("p",{style:{color:"#10b981",fontSize:"0.75rem",fontWeight:"500",marginBottom:"0.75rem"},children:"✓ Azure Storage credentials saved."}),e.jsx("button",{onClick:async()=>{try{const r=await(await fetch(`${p}/secure-admin/platform-settings/test/azure_storage`,{method:"POST",headers:{"X-Admin-Auth":et()}})).json();r.success?n("success",r.message):n("error",r.message||"Connection test failed")}catch{n("error","Failed to test connection")}},style:{padding:"0.5rem 1rem",background:"#0078d4",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:"500"},children:"Test Azure Connection"})]}):e.jsx("p",{style:{color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:'After saving, click "Test Azure Connection" to verify it works. Documents will be stored in this Azure File Share.'})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"1rem"},children:e.jsxs("button",{onClick:wn,disabled:Ms,className:t.saveBtn,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[Ms?e.jsx(E,{size:18,className:t.spinning}):e.jsx(ue,{size:18}),Ms?"Saving...":"Save All Settings"]})})]})]}),N==="storage"&&e.jsxs("div",{className:t.storageTab,children:[e.jsxs("div",{className:t.listHeader,children:[e.jsxs("h2",{className:t.pageTitle,children:[e.jsx(he,{size:24}),"Drive Storage Management"]}),e.jsxs("div",{className:t.listActions,children:[e.jsxs("div",{className:t.searchBox,children:[e.jsx(ks,{size:18}),e.jsx("input",{type:"text",placeholder:"Search firms...",value:b,onChange:s=>Fe(s.target.value)})]}),e.jsxs("button",{className:t.secondaryBtn,onClick:()=>Ge(),disabled:M,children:[e.jsx(E,{size:18,className:M?t.spinning:""}),"Refresh"]})]})]}),C&&e.jsxs("div",{style:{background:C.azureConfigured?"linear-gradient(135deg, #059669 0%, #10B981 100%)":"linear-gradient(135deg, #DC2626 0%, #EF4444 100%)",borderRadius:"16px",padding:"24px 32px",color:"white",marginBottom:"24px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"20px",fontWeight:700,display:"flex",alignItems:"center",gap:"12px"},children:C.azureConfigured?e.jsxs(e.Fragment,{children:[e.jsx(ue,{size:24})," Azure Storage Connected"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{size:24})," Azure Storage Not Configured"]})}),C.azureInfo&&e.jsxs("div",{style:{fontSize:"14px",opacity:.9},children:[e.jsxs("span",{style:{marginRight:"24px"},children:["Account: ",e.jsx("strong",{children:C.azureInfo.accountName})]}),e.jsxs("span",{children:["Share: ",e.jsx("strong",{children:C.azureInfo.shareName})]})]}),!C.azureConfigured&&e.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"14px",opacity:.9},children:"Go to Integrations tab to configure Azure Storage credentials."})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:"36px",fontWeight:700},children:C.firms.length}),e.jsx("div",{style:{fontSize:"14px",opacity:.9},children:"Firms"})]})]}),M?e.jsxs("div",{style:{textAlign:"center",padding:"60px",color:"#64748B"},children:[e.jsx(E,{size:40,className:t.spinning,style:{marginBottom:"16px"}}),e.jsx("p",{children:"Loading storage overview..."})]}):C?e.jsxs("div",{className:t.tableWrapper,children:[e.jsxs("table",{className:t.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Firm"}),e.jsx("th",{children:"Azure Folder"}),e.jsx("th",{children:"Documents"}),e.jsx("th",{children:"Matched"}),e.jsx("th",{children:"Unmatched"}),e.jsx("th",{children:"Size"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:C.firms.filter(s=>!b||s.name.toLowerCase().includes(b.toLowerCase())).map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:t.firmName,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(Q,{size:16,style:{color:"#3B82F6"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500},children:s.name}),e.jsxs("div",{style:{fontSize:"12px",color:"#64748B"},children:[s.usersCount," users"]})]})]})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"8px",background:"#F1F5F9",padding:"4px 12px",borderRadius:"6px",fontFamily:"monospace",fontSize:"13px"},children:[e.jsx(he,{size:14,style:{color:"#64748B"}}),s.azureFolder,s.customFolder&&e.jsx("span",{style:{background:"#3B82F6",color:"white",padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:600},children:"Custom"})]})}),e.jsx("td",{children:e.jsx("span",{style:{fontWeight:600,color:"#1E293B"},children:s.documentsCount})}),e.jsx("td",{children:e.jsx("span",{style:{color:s.matchedDocuments>0?"#10B981":"#64748B",fontWeight:s.matchedDocuments>0?600:400},children:s.matchedDocuments})}),e.jsx("td",{children:e.jsxs("span",{style:{color:s.unmatchedDocuments>0?"#F59E0B":"#64748B",fontWeight:s.unmatchedDocuments>0?600:400},children:[s.unmatchedDocuments,s.unmatchedDocuments>0&&e.jsx(Ne,{size:12,style:{marginLeft:"4px",verticalAlign:"middle"}})]})}),e.jsx("td",{children:e.jsxs("span",{style:{color:"#64748B"},children:[s.totalSizeMB," MB"]})}),e.jsxs("td",{className:t.actions,children:[e.jsx("button",{onClick:()=>bs(s.id),className:t.viewBtn,title:"Configure storage settings",style:{background:"#3B82F6"},children:e.jsx(Qs,{size:14})}),e.jsx("button",{onClick:()=>Cs(s.id),disabled:z===s.id,className:t.editBtn,title:"Scan documents",style:{background:z===s.id?"#6B7280":"#10B981"},children:z===s.id?e.jsx(re,{size:14,className:t.spinning}):e.jsx(Fs,{size:14})}),s.unmatchedDocuments>0&&e.jsx("button",{onClick:()=>Ws(s.id,"match_all"),className:t.editBtn,title:"Auto-match unmatched documents",style:{background:"#F59E0B"},children:e.jsx(Ji,{size:14})})]})]},s.id))})]}),C.firms.filter(s=>!b||s.name.toLowerCase().includes(b.toLowerCase())).length===0&&e.jsx("div",{className:t.emptyState,children:"No firms found"})]}):e.jsxs("div",{style:{textAlign:"center",padding:"60px",color:"#64748B"},children:[e.jsx(he,{size:48,style:{marginBottom:"16px",opacity:.3}}),e.jsx("p",{children:"No storage data loaded. Click Refresh to load."})]}),x&&e.jsx("div",{className:t.modalOverlay,onClick:()=>Y(null),children:e.jsxs("div",{className:t.modal,onClick:s=>s.stopPropagation(),style:{maxWidth:"800px",maxHeight:"90vh",overflow:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsxs("h2",{style:{margin:0,display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(he,{size:24}),"Storage Settings: ",x.firmName]}),e.jsx("button",{onClick:()=>Y(null),style:{background:"none",border:"none",cursor:"pointer",padding:"8px"},children:e.jsx(Is,{size:24})})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"24px"},children:[{label:"Documents",value:x.stats.documentsCount,color:"#3B82F6"},{label:"Matched",value:x.stats.matchedDocuments,color:"#10B981"},{label:"Unmatched",value:x.stats.unmatchedDocuments,color:"#F59E0B"},{label:"Total Size",value:`${x.stats.totalSizeMB} MB`,color:"#8B5CF6"}].map((s,r)=>e.jsxs("div",{style:{background:"#F8FAFC",border:"1px solid #E2E8F0",borderRadius:"12px",padding:"16px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"28px",fontWeight:700,color:s.color},children:s.value}),e.jsx("div",{style:{fontSize:"13px",color:"#64748B"},children:s.label})]},r))}),e.jsxs("div",{style:{background:"#F8FAFC",border:"1px solid #E2E8F0",borderRadius:"12px",padding:"20px",marginBottom:"20px"},children:[e.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"16px",fontWeight:600},children:"Azure Folder Path"}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"flex-end",marginBottom:"12px"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{display:"block",fontSize:"13px",color:"#64748B",marginBottom:"4px"},children:"Folder Name"}),e.jsx("input",{type:"text",value:x.azureFolder,onChange:s=>Y({...x,azureFolder:s.target.value,customFolder:s.target.value!==`firm-${x.firmId}`}),placeholder:`firm-${x.firmId}`,style:{width:"100%",padding:"10px 14px",border:"1px solid #E2E8F0",borderRadius:"8px",fontSize:"14px",fontFamily:"monospace"}})]}),e.jsxs("button",{onClick:()=>{kn(x.firmId,x.azureFolder===`firm-${x.firmId}`?null:x.azureFolder,x.driveSettings)},style:{padding:"10px 20px",background:"#3B82F6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:500,display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(ue,{size:16}),"Save"]}),e.jsxs("button",{onClick:()=>Fn(x.firmId,x.azureFolder),style:{padding:"10px 20px",background:"#10B981",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:500,display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Qe,{size:16}),"Create Folder"]})]}),x.connectionInfo&&e.jsxs("div",{style:{background:"white",border:"1px solid #E2E8F0",borderRadius:"8px",padding:"12px",fontSize:"13px"},children:[e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("span",{style:{color:"#64748B",marginRight:"8px"},children:"Windows:"}),e.jsx("code",{style:{background:"#1E293B",color:"#E2E8F0",padding:"4px 8px",borderRadius:"4px",fontFamily:"monospace"},children:x.connectionInfo.windowsPath}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(x.connectionInfo.windowsPath),n("success","Copied!")},style:{marginLeft:"8px",background:"none",border:"none",cursor:"pointer",color:"#3B82F6"},children:e.jsx(O,{size:14})})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"#64748B",marginRight:"8px"},children:"Mac:"}),e.jsx("code",{style:{background:"#1E293B",color:"#E2E8F0",padding:"4px 8px",borderRadius:"4px",fontFamily:"monospace"},children:x.connectionInfo.macPath}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(x.connectionInfo.macPath),n("success","Copied!")},style:{marginLeft:"8px",background:"none",border:"none",cursor:"pointer",color:"#3B82F6"},children:e.jsx(O,{size:14})})]})]})]}),e.jsxs("div",{style:{background:"#F8FAFC",border:"1px solid #E2E8F0",borderRadius:"12px",padding:"20px",marginBottom:"20px"},children:[e.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"16px",fontWeight:600},children:"Document Settings"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"13px",color:"#64748B",marginBottom:"4px"},children:"Default Privacy Level"}),e.jsxs("select",{value:x.driveSettings.defaultDocumentPrivacy,onChange:s=>Y({...x,driveSettings:{...x.driveSettings,defaultDocumentPrivacy:s.target.value}}),style:{width:"100%",padding:"10px 14px",border:"1px solid #E2E8F0",borderRadius:"8px",fontSize:"14px"},children:[e.jsx("option",{value:"private",children:"Private (Owner only)"}),e.jsx("option",{value:"team",children:"Team (Matter assignees)"}),e.jsx("option",{value:"public",children:"Public (All firm users)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"13px",color:"#64748B",marginBottom:"4px"},children:"Scan Interval (minutes)"}),e.jsx("input",{type:"number",value:x.driveSettings.scanIntervalMinutes,onChange:s=>Y({...x,driveSettings:{...x.driveSettings,scanIntervalMinutes:parseInt(s.target.value)||60}}),min:10,max:1440,style:{width:"100%",padding:"10px 14px",border:"1px solid #E2E8F0",borderRadius:"8px",fontSize:"14px"}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("input",{type:"checkbox",id:"inheritPermissions",checked:x.driveSettings.inheritMatterPermissions,onChange:s=>Y({...x,driveSettings:{...x.driveSettings,inheritMatterPermissions:s.target.checked}})}),e.jsx("label",{htmlFor:"inheritPermissions",style:{fontSize:"14px",color:"#1E293B"},children:"Inherit permissions from parent matter"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("input",{type:"checkbox",id:"preserveStructure",checked:x.driveSettings.preserveFolderStructure,onChange:s=>Y({...x,driveSettings:{...x.driveSettings,preserveFolderStructure:s.target.checked}})}),e.jsx("label",{htmlFor:"preserveStructure",style:{fontSize:"14px",color:"#1E293B"},children:"Preserve folder structure from source"})]})]})]}),e.jsxs("div",{style:{background:"#FEF3C7",border:"1px solid #F59E0B",borderRadius:"12px",padding:"20px",marginBottom:"20px"},children:[e.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"16px",fontWeight:600,color:"#B45309"},children:"Bulk Document Actions"}),e.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[e.jsxs("button",{onClick:()=>Ws(x.firmId,"match_all"),style:{padding:"10px 20px",background:"#F59E0B",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:500,display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Ji,{size:16}),"Auto-Match All (",x.stats.unmatchedDocuments," unmatched)"]}),e.jsxs("button",{onClick:()=>Ws(x.firmId,"set_privacy",{privacyLevel:"team"}),style:{padding:"10px 20px",background:"#8B5CF6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:500,display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(V,{size:16}),"Set All to Team Access"]}),e.jsx("button",{onClick:()=>Cs(x.firmId),disabled:z===x.firmId,style:{padding:"10px 20px",background:"#10B981",color:"white",border:"none",borderRadius:"8px",cursor:z===x.firmId?"not-allowed":"pointer",fontWeight:500,display:"flex",alignItems:"center",gap:"8px",opacity:z===x.firmId?.7:1},children:z===x.firmId?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:16,className:t.spinning})," Scanning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Fs,{size:16})," Scan Azure Files"]})})]})]}),x.folderBreakdown.length>0&&e.jsxs("div",{style:{background:"#F8FAFC",border:"1px solid #E2E8F0",borderRadius:"12px",padding:"20px"},children:[e.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"16px",fontWeight:600},children:"Folder Breakdown (Top 20)"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid #E2E8F0"},children:[e.jsx("th",{style:{textAlign:"left",padding:"8px 12px",fontSize:"13px",color:"#64748B"},children:"Folder"}),e.jsx("th",{style:{textAlign:"right",padding:"8px 12px",fontSize:"13px",color:"#64748B"},children:"Files"}),e.jsx("th",{style:{textAlign:"right",padding:"8px 12px",fontSize:"13px",color:"#64748B"},children:"Matched"}),e.jsx("th",{style:{textAlign:"right",padding:"8px 12px",fontSize:"13px",color:"#64748B"},children:"Size"})]})}),e.jsx("tbody",{children:x.folderBreakdown.map((s,r)=>e.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9"},children:[e.jsx("td",{style:{padding:"8px 12px",fontFamily:"monospace",fontSize:"13px"},children:s.folder}),e.jsx("td",{style:{padding:"8px 12px",textAlign:"right",fontWeight:600},children:s.fileCount}),e.jsx("td",{style:{padding:"8px 12px",textAlign:"right",color:s.matchedCount>0?"#10B981":"#64748B"},children:s.matchedCount}),e.jsxs("td",{style:{padding:"8px 12px",textAlign:"right",color:"#64748B"},children:[s.sizeMB," MB"]})]},r))})]})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"24px"},children:e.jsx("button",{onClick:()=>Y(null),style:{padding:"12px 24px",background:"#64748B",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:500},children:"Close"})})]})})]})]})})]}),sn&&e.jsx(gd,{firm:ze,onSave:Tn,onClose:()=>{Ie(!1),Be(null)}}),tn&&e.jsx(jd,{user:Ae,firms:se,onSave:Mn,onClose:()=>{Ye(!1),Xe(null)}}),_n&&e.jsx("div",{className:t.modalOverlay,onClick:()=>fs(!1),children:e.jsxs("div",{className:t.modal,onClick:s=>s.stopPropagation(),children:[e.jsx("h2",{children:"Bulk Import Users"}),e.jsx("p",{className:t.modalSubtitle,children:"Import multiple users at once using CSV format"}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Select Firm *"}),e.jsxs("select",{value:Us,onChange:s=>It(s.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select a firm..."}),se.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Default Password (optional)"}),e.jsx("input",{type:"text",value:zt,onChange:s=>Bt(s.target.value),placeholder:"Leave blank to auto-generate"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Users (CSV format: email, firstName, lastName, role)"}),e.jsx("textarea",{value:$s,onChange:s=>Ft(s.target.value),placeholder:`john@example.com, John, Doe, attorney
jane@example.com, Jane, Smith, paralegal
bob@example.com, Bob, Wilson, partner`,rows:8})]}),e.jsxs("div",{className:t.modalActions,children:[e.jsx("button",{type:"button",onClick:()=>fs(!1),className:t.cancelBtn,children:"Cancel"}),e.jsx("button",{onClick:Hn,className:t.saveBtn,children:"Import Users"})]})]})}),j&&e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"#F8FAFC",zIndex:100,overflow:"auto"},children:[e.jsx("div",{style:{background:"white",borderBottom:"1px solid #E2E8F0",padding:"16px 32px",position:"sticky",top:0,zIndex:10},children:e.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("button",{onClick:()=>jt(null),style:{display:"flex",alignItems:"center",gap:"8px",background:"none",border:"none",color:"#3B82F6",cursor:"pointer",fontSize:"14px",fontWeight:500,padding:"8px 0"},children:[e.jsx(Ke,{size:18,style:{transform:"rotate(180deg)"}}),"Back to Firms"]}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:e.jsxs("button",{onClick:()=>{Be(j),Ie(!0)},style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 16px",background:"#F1F5F9",border:"none",borderRadius:"8px",color:"#475569",cursor:"pointer",fontSize:"14px"},children:[e.jsx(Ys,{size:16}),"Edit Firm"]})})]})}),e.jsx("div",{style:{background:"linear-gradient(135deg, #1E293B 0%, #334155 50%, #475569 100%)",padding:"48px 32px",color:"white"},children:e.jsx("div",{style:{maxWidth:"1400px",margin:"0 auto"},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",marginBottom:"16px"},children:[e.jsx("div",{style:{width:"64px",height:"64px",borderRadius:"16px",background:"linear-gradient(135deg, #3B82F6, #8B5CF6)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px",fontWeight:700},children:j.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h1",{style:{margin:0,fontSize:"32px",fontWeight:700},children:j.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginTop:"8px"},children:[e.jsx("span",{style:{background:j.status==="active"?"rgba(16, 185, 129, 0.2)":"rgba(245, 158, 11, 0.2)",color:j.status==="active"?"#6EE7B7":"#FCD34D",padding:"4px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:500},children:j.status||"active"}),j.domain&&e.jsx("span",{style:{opacity:.7,fontSize:"14px"},children:j.domain})]})]})]}),e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"12px",background:"rgba(255,255,255,0.1)",padding:"12px 20px",borderRadius:"12px",marginTop:"8px"},children:[e.jsx("span",{style:{opacity:.7,fontSize:"13px"},children:"Firm ID:"}),e.jsx("code",{style:{background:"rgba(0,0,0,0.2)",padding:"6px 12px",borderRadius:"6px",fontSize:"13px",fontFamily:"monospace",letterSpacing:"0.5px"},children:j.id}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(j.id),n("success","Firm ID copied!")},style:{background:"rgba(255,255,255,0.1)",border:"none",borderRadius:"6px",padding:"6px 10px",cursor:"pointer",color:"white",display:"flex",alignItems:"center",gap:"4px",fontSize:"12px"},children:[e.jsx(O,{size:14}),"Copy"]})]})]}),e.jsx("div",{style:{display:"flex",gap:"24px"},children:[{icon:V,value:He.length,label:"Users"},{icon:ws,value:($==null?void 0:$.matters)||0,label:"Matters"},{icon:Je,value:($==null?void 0:$.documents)||0,label:"Documents"}].map((s,r)=>e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 8px"},children:e.jsx(s.icon,{size:24,style:{opacity:.9}})}),e.jsx("div",{style:{fontSize:"24px",fontWeight:700},children:s.value}),e.jsx("div",{style:{fontSize:"12px",opacity:.7},children:s.label})]},r))})]})})}),e.jsx("div",{style:{background:"white",borderBottom:"1px solid #E2E8F0",position:"sticky",top:"65px",zIndex:9},children:e.jsx("div",{style:{maxWidth:"1400px",margin:"0 auto",padding:"0 32px"},children:e.jsx("div",{style:{display:"flex",gap:"0"},children:[{id:"overview",icon:Gi,label:"Overview"},{id:"users",icon:V,label:"Users"},{id:"documents",icon:he,label:"Documents"}].map(s=>e.jsxs("button",{onClick:()=>yt(s.id),style:{padding:"20px 28px",background:"transparent",border:"none",borderBottom:Se===s.id?"3px solid #3B82F6":"3px solid transparent",color:Se===s.id?"#1E293B":"#64748B",fontWeight:Se===s.id?600:500,cursor:"pointer",display:"flex",alignItems:"center",gap:"10px",fontSize:"15px",transition:"all 0.15s"},children:[e.jsx(s.icon,{size:20}),s.label,s.id==="users"&&e.jsx("span",{style:{background:"#E2E8F0",padding:"2px 8px",borderRadius:"10px",fontSize:"12px"},children:He.length})]},s.id))})})}),e.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",padding:"32px"},children:[Se==="overview"&&e.jsx("div",{children:wt?e.jsxs("div",{style:{textAlign:"center",padding:"80px",color:"#64748B"},children:[e.jsx(E,{size:40,className:"animate-spin",style:{marginBottom:"20px",opacity:.5}}),e.jsx("p",{style:{margin:0,fontSize:"16px"},children:"Loading firm data..."})]}):$?e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"20px"},children:[{label:"Total Users",value:$.users,sub:`${$.activeUsers} active`,color:"#3B82F6",bg:"#EFF6FF",icon:V},{label:"Matters",value:$.matters,sub:`${$.openMatters} open`,color:"#10B981",bg:"#ECFDF5",icon:ws},{label:"Clients",value:$.clients,color:"#F59E0B",bg:"#FFFBEB",icon:Q},{label:"Documents",value:$.documents,color:"#8B5CF6",bg:"#F5F3FF",icon:Je},{label:"Time Entries",value:$.timeEntries,sub:`${((Di=$.totalHours)==null?void 0:Di.toFixed(0))||0} hours`,color:"#EF4444",bg:"#FEF2F2",icon:re},{label:"Invoices",value:$.invoices,color:"#06B6D4",bg:"#ECFEFF",icon:Je},{label:"Calendar Events",value:$.calendarEvents,color:"#EC4899",bg:"#FDF2F8",icon:qe}].map((s,r)=>e.jsxs("div",{style:{background:"white",border:"1px solid #E2E8F0",borderRadius:"16px",padding:"24px",transition:"box-shadow 0.2s"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"16px"},children:e.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"12px",background:s.bg,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(s.icon,{size:22,style:{color:s.color}})})}),e.jsx("div",{style:{fontSize:"36px",fontWeight:700,color:"#1E293B",marginBottom:"4px"},children:s.value}),e.jsx("div",{style:{fontSize:"14px",color:"#64748B",fontWeight:500},children:s.label}),s.sub&&e.jsx("div",{style:{fontSize:"13px",color:"#94A3B8",marginTop:"4px"},children:s.sub})]},r))}):e.jsxs("div",{style:{textAlign:"center",padding:"80px",color:"#64748B"},children:[e.jsx(Ne,{size:40,style:{marginBottom:"20px",opacity:.3}}),e.jsx("p",{style:{margin:0},children:"Could not load firm statistics"})]})}),Se==="users"&&e.jsx("div",{children:wt?e.jsxs("div",{style:{textAlign:"center",padding:"80px",color:"#64748B"},children:[e.jsx(E,{size:40,className:"animate-spin",style:{marginBottom:"20px",opacity:.5}}),e.jsx("p",{style:{margin:0,fontSize:"16px"},children:"Loading users..."})]}):He.length>0?e.jsx("div",{style:{background:"white",borderRadius:"16px",border:"1px solid #E2E8F0",overflow:"hidden"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"#F8FAFC",borderBottom:"1px solid #E2E8F0"},children:[e.jsx("th",{style:{padding:"16px 24px",textAlign:"left",fontWeight:600,color:"#475569",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"User"}),e.jsx("th",{style:{padding:"16px 24px",textAlign:"left",fontWeight:600,color:"#475569",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Email"}),e.jsx("th",{style:{padding:"16px 24px",textAlign:"left",fontWeight:600,color:"#475569",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Role"}),e.jsx("th",{style:{padding:"16px 24px",textAlign:"center",fontWeight:600,color:"#475569",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Status"}),e.jsx("th",{style:{padding:"16px 24px",textAlign:"right",fontWeight:600,color:"#475569",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Last Login"})]})}),e.jsx("tbody",{children:He.map((s,r)=>{var i,a;return e.jsxs("tr",{style:{borderBottom:r<He.length-1?"1px solid #F1F5F9":"none"},children:[e.jsx("td",{style:{padding:"20px 24px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px"},children:[e.jsxs("div",{style:{width:"42px",height:"42px",borderRadius:"50%",background:"linear-gradient(135deg, #3B82F6, #8B5CF6)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:600,fontSize:"15px"},children:[(i=s.first_name)==null?void 0:i[0],(a=s.last_name)==null?void 0:a[0]]}),e.jsxs("span",{style:{fontWeight:600,color:"#1E293B"},children:[s.first_name," ",s.last_name]})]})}),e.jsx("td",{style:{padding:"20px 24px",color:"#64748B"},children:s.email}),e.jsx("td",{style:{padding:"20px 24px"},children:e.jsx("span",{style:{padding:"6px 14px",borderRadius:"20px",fontSize:"13px",fontWeight:500,background:s.role==="owner"?"#FEF3C7":s.role==="admin"?"#DBEAFE":s.role==="partner"?"#E0E7FF":"#F1F5F9",color:s.role==="owner"?"#B45309":s.role==="admin"?"#1D4ED8":s.role==="partner"?"#4338CA":"#475569"},children:s.role})}),e.jsx("td",{style:{padding:"20px 24px",textAlign:"center"},children:e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"6px 14px",borderRadius:"20px",fontSize:"13px",fontWeight:500,background:s.is_active?"#DCFCE7":"#FEE2E2",color:s.is_active?"#166534":"#991B1B"},children:[e.jsx("span",{style:{width:"6px",height:"6px",borderRadius:"50%",background:"currentColor"}}),s.is_active?"Active":"Inactive"]})}),e.jsx("td",{style:{padding:"20px 24px",textAlign:"right",color:"#64748B",fontSize:"14px"},children:s.last_login?new Date(s.last_login).toLocaleDateString():"—"})]},s.id)})})]})}):e.jsxs("div",{style:{textAlign:"center",padding:"80px",color:"#64748B",background:"white",borderRadius:"16px",border:"1px solid #E2E8F0"},children:[e.jsx(V,{size:56,style:{marginBottom:"20px",opacity:.2}}),e.jsx("p",{style:{margin:0,fontSize:"18px",fontWeight:500},children:"No users in this firm"})]})}),Se==="documents"&&e.jsxs("div",{children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #7C3AED 0%, #8B5CF6 100%)",borderRadius:"20px",padding:"40px 48px",color:"white",marginBottom:"32px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"24px"},children:[e.jsxs("div",{style:{maxWidth:"500px"},children:[e.jsx("h2",{style:{margin:"0 0 12px 0",fontSize:"28px",fontWeight:700},children:"Stream Documents from Clio"}),e.jsx("p",{style:{margin:0,opacity:.9,fontSize:"16px",lineHeight:1.6},children:"Stream documents directly from Clio API to Azure Storage. No local disk required - files are transferred using memory streaming for maximum efficiency."})]}),k?e.jsx("div",{style:{background:"rgba(255,255,255,0.2)",padding:"8px 16px",borderRadius:"8px",fontSize:"14px",fontWeight:500},children:"Clio Connected"}):e.jsx("div",{style:{background:"rgba(255,255,255,0.15)",padding:"8px 16px",borderRadius:"8px",fontSize:"14px",fontWeight:500},children:"Connect via Migration tab first"})]}),We&&e.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",padding:"16px 20px",borderRadius:"12px",marginBottom:"20px",border:"1px solid rgba(255,255,255,0.2)"},children:[e.jsx("div",{style:{fontSize:"14px",opacity:.8,marginBottom:"8px"},children:"📂 Azure Storage Location:"}),e.jsx("div",{style:{fontFamily:"monospace",fontSize:"13px",background:"rgba(0,0,0,0.2)",padding:"10px 14px",borderRadius:"6px",wordBreak:"break-all"},children:We.fullPath}),e.jsxs("div",{style:{fontSize:"12px",opacity:.7,marginTop:"8px"},children:["Account: ",e.jsx("strong",{children:We.account})," | Share: ",e.jsx("strong",{children:We.share})," | Folder: ",e.jsx("strong",{children:We.firmFolder})]})]}),y&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"24px"},children:[e.jsxs("div",{style:{background:"rgba(255,255,255,0.15)",padding:"16px",borderRadius:"12px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"28px",fontWeight:700},children:y.total}),e.jsx("div",{style:{fontSize:"13px",opacity:.9},children:"Total"})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.15)",padding:"16px",borderRadius:"12px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"28px",fontWeight:700},children:y.pending}),e.jsx("div",{style:{fontSize:"13px",opacity:.9},children:"Pending"})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.15)",padding:"16px",borderRadius:"12px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"28px",fontWeight:700},children:y.imported}),e.jsx("div",{style:{fontSize:"13px",opacity:.9},children:"Imported"})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.15)",padding:"16px",borderRadius:"12px",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"28px",fontWeight:700},children:[y.totalSizeMB," MB"]}),e.jsx("div",{style:{fontSize:"13px",opacity:.9},children:"Total Size"})]})]}),me&&me.status!=="complete"&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px",fontSize:"14px"},children:[e.jsx("span",{children:"Streaming in progress..."}),e.jsxs("span",{children:[me.processed||0," / ",me.total||0]})]}),e.jsx("div",{style:{background:"rgba(255,255,255,0.2)",borderRadius:"8px",height:"8px",overflow:"hidden"},children:e.jsx("div",{style:{background:"white",height:"100%",width:`${me.total?(me.processed||0)/me.total*100:0}%`,transition:"width 0.3s ease"}})})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[e.jsx("button",{onClick:Pn,disabled:vs||!k,style:{display:"flex",alignItems:"center",gap:"8px",padding:"14px 24px",background:"white",color:"#7C3AED",border:"none",borderRadius:"10px",cursor:vs||!k?"not-allowed":"pointer",fontWeight:600,fontSize:"15px",opacity:vs||!k?.7:1},children:vs?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:18,className:"animate-spin"})," Fetching..."]}):e.jsx(e.Fragment,{children:"1. Fetch Document List"})}),e.jsx("button",{onClick:$n,disabled:ys||!k||!(y!=null&&y.pending),style:{display:"flex",alignItems:"center",gap:"8px",padding:"14px 24px",background:"white",color:"#7C3AED",border:"none",borderRadius:"10px",cursor:ys||!k||!(y!=null&&y.pending)?"not-allowed":"pointer",fontWeight:600,fontSize:"15px",opacity:ys||!k||!(y!=null&&y.pending)?.7:1},children:ys?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:18,className:"animate-spin"})," Streaming..."]}):e.jsxs(e.Fragment,{children:["2. Stream to Azure (",(y==null?void 0:y.pending)||0," pending)"]})}),e.jsx("button",{onClick:On,disabled:!(y!=null&&y.imported),style:{display:"flex",alignItems:"center",gap:"8px",padding:"14px 24px",background:"rgba(255,255,255,0.2)",color:"white",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"10px",cursor:y!=null&&y.imported?"pointer":"not-allowed",fontWeight:600,fontSize:"15px",opacity:y!=null&&y.imported?1:.7},children:"3. Sync Permissions"}),y&&y.errors>0&&e.jsxs("button",{onClick:Un,style:{display:"flex",alignItems:"center",gap:"8px",padding:"14px 24px",background:"rgba(239, 68, 68, 0.2)",color:"white",border:"1px solid rgba(239, 68, 68, 0.5)",borderRadius:"10px",cursor:"pointer",fontWeight:600,fontSize:"15px"},children:["Reset ",y.errors," Failed"]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",marginBottom:"32px",color:"#94A3B8"},children:[e.jsx("div",{style:{flex:1,height:"1px",background:"#E2E8F0"}}),e.jsx("span",{style:{fontWeight:500,fontSize:"14px"},children:"OR MANUAL MIGRATION"}),e.jsx("div",{style:{flex:1,height:"1px",background:"#E2E8F0"}})]}),e.jsxs("div",{style:{background:"linear-gradient(135deg, #059669 0%, #10B981 100%)",borderRadius:"20px",padding:"40px 48px",color:"white",marginBottom:"32px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{maxWidth:"450px"},children:[e.jsx("h2",{style:{margin:"0 0 12px 0",fontSize:"28px",fontWeight:700},children:"Scan Documents"}),e.jsx("p",{style:{margin:0,opacity:.9,fontSize:"16px",lineHeight:1.6},children:"After copying files from Clio Drive to Azure, scan to import them. Use Rescan to re-match documents after adding new matters/users."})]}),e.jsxs("div",{style:{display:"flex",gap:"16px"},children:[e.jsx("button",{onClick:()=>Cs(j.id),disabled:z===j.id,style:{display:"flex",alignItems:"center",gap:"12px",padding:"18px 32px",background:"white",color:"#059669",border:"none",borderRadius:"14px",cursor:z===j.id?"not-allowed":"pointer",fontWeight:700,fontSize:"16px",boxShadow:"0 8px 24px rgba(0,0,0,0.15)",transition:"transform 0.2s, box-shadow 0.2s",opacity:z===j.id?.8:1},onMouseOver:s=>{z!==j.id&&(s.currentTarget.style.transform="translateY(-2px)",s.currentTarget.style.boxShadow="0 12px 32px rgba(0,0,0,0.2)")},onMouseOut:s=>{s.currentTarget.style.transform="translateY(0)",s.currentTarget.style.boxShadow="0 8px 24px rgba(0,0,0,0.15)"},children:z===j.id?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:22,className:"animate-spin"}),"Scanning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Fs,{size:22}),"Full Scan"]})}),e.jsxs("button",{onClick:()=>Ln(j.id),disabled:z===j.id,style:{display:"flex",alignItems:"center",gap:"12px",padding:"18px 32px",background:"rgba(255,255,255,0.2)",color:"white",border:"2px solid white",borderRadius:"14px",cursor:z===j.id?"not-allowed":"pointer",fontWeight:700,fontSize:"16px",transition:"transform 0.2s, background 0.2s",opacity:z===j.id?.8:1},onMouseOver:s=>{z!==j.id&&(s.currentTarget.style.transform="translateY(-2px)",s.currentTarget.style.background="rgba(255,255,255,0.3)")},onMouseOut:s=>{s.currentTarget.style.transform="translateY(0)",s.currentTarget.style.background="rgba(255,255,255,0.2)"},title:"Re-match unmatched documents to matters (run after adding new matters)",children:[e.jsx(E,{size:22}),"Rescan Unmatched"]}),e.jsxs("button",{onClick:()=>Rn(j.id),style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",background:"rgba(239, 68, 68, 0.2)",color:"white",border:"2px solid #EF4444",borderRadius:"14px",cursor:"pointer",fontWeight:600,fontSize:"14px"},title:"Clear stuck scan job",children:[e.jsx(Is,{size:18}),"Reset Scan"]})]})]}),v&&v.firmId===j.id&&e.jsxs("div",{style:{marginBottom:"24px",padding:"20px 24px",borderRadius:"12px",background:v.success?"rgba(16, 185, 129, 0.1)":"rgba(239, 68, 68, 0.1)",border:`2px solid ${v.success?"#10B981":"#EF4444"}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:v.success&&v.scanned?"16px":0},children:[v.success?e.jsx(ue,{size:24,color:"#10B981"}):e.jsx(Ne,{size:24,color:"#EF4444"}),e.jsx("span",{style:{flex:1,fontSize:"15px",fontWeight:600,color:v.success?"#065F46":"#991B1B"},children:v.message}),e.jsx("button",{onClick:()=>W(null),style:{background:"none",border:"none",cursor:"pointer",padding:"4px"},children:e.jsx(Is,{size:18,color:"#64748B"})})]}),v.success&&v.processed!==void 0&&e.jsxs("div",{style:{marginTop:"12px"},children:[e.jsxs("div",{style:{display:"flex",gap:"24px",marginBottom:"12px",flexWrap:"wrap"},children:[v.manifestEntries!==void 0&&e.jsxs("div",{style:{fontSize:"14px",color:"#374151"},children:[e.jsx("strong",{children:(Ri=v.manifestEntries)==null?void 0:Ri.toLocaleString()})," in manifest"]}),v.azureFiles!==void 0&&e.jsxs("div",{style:{fontSize:"14px",color:"#374151"},children:[e.jsx("strong",{children:(Li=v.azureFiles)==null?void 0:Li.toLocaleString()})," in Azure"]}),e.jsxs("div",{style:{fontSize:"14px",color:"#059669"},children:[e.jsx("strong",{children:(Pi=v.matched)==null?void 0:Pi.toLocaleString()})," matched"]}),e.jsxs("div",{style:{fontSize:"14px",color:"#3B82F6"},children:[e.jsx("strong",{children:($i=v.created)==null?void 0:$i.toLocaleString()})," created"]}),(v.missing||0)>0&&e.jsxs("div",{style:{fontSize:"14px",color:"#D97706"},children:[e.jsx("strong",{children:(Ui=v.missing)==null?void 0:Ui.toLocaleString()})," not found in Azure"]})]}),(v.withMatter!==void 0||v.withoutMatter!==void 0)&&e.jsxs("div",{style:{background:"white",borderRadius:"8px",padding:"12px 16px",marginTop:"12px"},children:[e.jsx("div",{style:{fontSize:"13px",fontWeight:600,color:"#374151",marginBottom:"8px"},children:"Document → Matter Assignments (from Clio metadata)"}),e.jsxs("div",{style:{display:"flex",gap:"16px",fontSize:"13px",flexWrap:"wrap"},children:[e.jsxs("span",{style:{color:"#059669"},children:[e.jsx(ue,{size:14,style:{verticalAlign:"middle",marginRight:"4px"}}),((Oi=v.withMatter)==null?void 0:Oi.toLocaleString())||0," with matter"]}),(v.withoutMatter||0)>0&&e.jsxs("span",{style:{color:"#6B7280"},children:[((Mi=v.withoutMatter)==null?void 0:Mi.toLocaleString())||0," without matter"]})]}),(v.matterLookupHits!==void 0||v.matterMappings!==void 0)&&e.jsxs("div",{style:{display:"flex",gap:"16px",fontSize:"12px",marginTop:"8px",color:"#6B7280",flexWrap:"wrap"},children:[v.matterMappings!==void 0&&e.jsxs("span",{children:[v.matterMappings," matter mappings loaded"]}),v.matterLookupHits!==void 0&&v.matterLookupHits>0&&e.jsxs("span",{style:{color:"#059669"},children:[v.matterLookupHits," resolved via Clio ID"]}),v.matterLookupMisses!==void 0&&v.matterLookupMisses>0&&e.jsxs("span",{style:{color:"#D97706"},children:[v.matterLookupMisses," Clio matter IDs not found"]})]})]})]})]}),(de==null?void 0:de.stats)&&e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx("h3",{style:{margin:"0 0 20px 0",color:"#1E293B",fontSize:"18px",fontWeight:600},children:"Document Status (Actual)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"20px"},children:[e.jsxs("div",{style:{background:"white",border:"1px solid #E2E8F0",padding:"28px",borderRadius:"16px"},children:[e.jsx("div",{style:{fontSize:"40px",fontWeight:700,color:"#3B82F6",marginBottom:"8px"},children:de.stats.total||0}),e.jsx("div",{style:{fontSize:"15px",color:"#64748B",fontWeight:500},children:"Total in Database"})]}),e.jsxs("div",{style:{background:"white",border:"1px solid #E2E8F0",padding:"28px",borderRadius:"16px"},children:[e.jsx("div",{style:{fontSize:"40px",fontWeight:700,color:"#10B981",marginBottom:"8px"},children:de.stats.linkedToMatter||0}),e.jsx("div",{style:{fontSize:"15px",color:"#64748B",fontWeight:500},children:"Linked to Matters"})]}),e.jsxs("div",{style:{background:"white",border:"1px solid #E2E8F0",padding:"28px",borderRadius:"16px"},children:[e.jsx("div",{style:{fontSize:"40px",fontWeight:700,color:"#8B5CF6",marginBottom:"8px"},children:de.stats.withOwner||0}),e.jsx("div",{style:{fontSize:"15px",color:"#64748B",fontWeight:500},children:"With Attorney"})]}),e.jsxs("div",{style:{background:"white",border:"1px solid #E2E8F0",padding:"28px",borderRadius:"16px"},children:[e.jsx("div",{style:{fontSize:"40px",fontWeight:700,color:"#F59E0B",marginBottom:"8px"},children:de.stats.manifestPending||0}),e.jsx("div",{style:{fontSize:"15px",color:"#64748B",fontWeight:500},children:"Clio List (Pending)"})]})]})]}),e.jsxs("div",{style:{background:"white",border:"1px solid #E2E8F0",borderRadius:"16px",padding:"28px"},children:[e.jsx("h3",{style:{margin:"0 0 20px 0",color:"#1E293B",fontSize:"18px",fontWeight:600},children:"How to Migrate Documents"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"24px"},children:[{step:"1",title:"Copy Files",desc:"Copy documents from Clio Drive to Azure File Share"},{step:"2",title:"Scan",desc:"Click the Scan Documents button above"},{step:"3",title:"Done",desc:"Documents are matched to matters automatically"}].map((s,r)=>e.jsxs("div",{style:{display:"flex",gap:"16px"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"50%",background:"#EFF6FF",color:"#3B82F6",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"14px",flexShrink:0},children:s.step}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,color:"#1E293B",marginBottom:"4px"},children:s.title}),e.jsx("div",{style:{fontSize:"14px",color:"#64748B",lineHeight:1.5},children:s.desc})]})]},r))})]})]})]})]}),e.jsx("footer",{className:t.footer,children:e.jsxs("div",{className:t.hipaaNotice,children:[e.jsx(zs,{size:14}),e.jsx("span",{children:"HIPAA Notice: All access and modifications are logged for compliance. PHI handling requires authorization."})]})})]})}function gd({firm:f,onSave:N,onClose:R}){const[C,w]=o.useState({name:(f==null?void 0:f.name)||"",domain:(f==null?void 0:f.domain)||"",status:(f==null?void 0:f.status)||"active",subscription_tier:(f==null?void 0:f.subscription_tier)||"professional"}),M=D=>{D.preventDefault(),N(C)};return e.jsx("div",{className:t.modalOverlay,onClick:R,children:e.jsxs("div",{className:t.modal,onClick:D=>D.stopPropagation(),children:[e.jsx("h2",{children:f?"Edit Firm":"Create New Firm"}),e.jsxs("form",{onSubmit:M,children:[e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Firm Name *"}),e.jsx("input",{type:"text",value:C.name,onChange:D=>w({...C,name:D.target.value}),required:!0})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Domain"}),e.jsx("input",{type:"text",value:C.domain,onChange:D=>w({...C,domain:D.target.value}),placeholder:"e.g., firmname.com"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{value:C.status,onChange:D=>w({...C,status:D.target.value}),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"suspended",children:"Suspended"})]})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Subscription Tier"}),e.jsxs("select",{value:C.subscription_tier,onChange:D=>w({...C,subscription_tier:D.target.value}),children:[e.jsx("option",{value:"starter",children:"Starter"}),e.jsx("option",{value:"professional",children:"Professional"}),e.jsx("option",{value:"enterprise",children:"Enterprise"})]})]}),e.jsxs("div",{className:t.modalActions,children:[e.jsx("button",{type:"button",onClick:R,className:t.cancelBtn,children:"Cancel"}),e.jsx("button",{type:"submit",className:t.saveBtn,children:f?"Update Firm":"Create Firm"})]})]})]})})}function jd({user:f,firms:N,onSave:R,onClose:C}){const[w,M]=o.useState({email:(f==null?void 0:f.email)||"",first_name:(f==null?void 0:f.first_name)||"",last_name:(f==null?void 0:f.last_name)||"",role:(f==null?void 0:f.role)||"attorney",firm_id:(f==null?void 0:f.firm_id)||"",status:(f==null?void 0:f.status)||"active",password:""}),[D,x]=o.useState(!1),Y=b=>{b.preventDefault();const Fe={...w};Fe.password||delete Fe.password,R(Fe)};return e.jsx("div",{className:t.modalOverlay,onClick:C,children:e.jsxs("div",{className:t.modal,onClick:b=>b.stopPropagation(),children:[e.jsx("h2",{children:f?"Edit User":"Create New User"}),e.jsxs("form",{onSubmit:Y,children:[e.jsxs("div",{className:t.formRow,children:[e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"First Name *"}),e.jsx("input",{type:"text",value:w.first_name,onChange:b=>M({...w,first_name:b.target.value}),required:!0})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Last Name *"}),e.jsx("input",{type:"text",value:w.last_name,onChange:b=>M({...w,last_name:b.target.value}),required:!0})]})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Email *"}),e.jsx("input",{type:"email",value:w.email,onChange:b=>M({...w,email:b.target.value}),required:!0})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:f?"New Password (leave blank to keep current)":"Password *"}),e.jsxs("div",{className:t.passwordInput,children:[e.jsx("input",{type:D?"text":"password",value:w.password,onChange:b=>M({...w,password:b.target.value}),required:!f,minLength:8}),e.jsx("button",{type:"button",onClick:()=>x(!D),children:D?e.jsx(Qi,{size:16}):e.jsx(Ki,{size:16})})]})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Firm *"}),e.jsxs("select",{value:w.firm_id,onChange:b=>M({...w,firm_id:b.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select a firm..."}),N.map(b=>e.jsx("option",{value:b.id,children:b.name},b.id))]})]}),e.jsxs("div",{className:t.formRow,children:[e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Role"}),e.jsxs("select",{value:w.role,onChange:b=>M({...w,role:b.target.value}),children:[e.jsx("option",{value:"owner",children:"Owner"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"attorney",children:"Attorney"}),e.jsx("option",{value:"paralegal",children:"Paralegal"}),e.jsx("option",{value:"staff",children:"Staff"}),e.jsx("option",{value:"billing",children:"Billing"}),e.jsx("option",{value:"readonly",children:"Read Only"})]})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{value:w.status,onChange:b=>M({...w,status:b.target.value}),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:t.modalActions,children:[e.jsx("button",{type:"button",onClick:C,className:t.cancelBtn,children:"Cancel"}),e.jsx("button",{type:"submit",className:t.saveBtn,children:f?"Update User":"Create User"})]})]})]})})}export{Ed as default};
