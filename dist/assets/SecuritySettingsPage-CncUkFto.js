import{r as a,a6 as e}from"./vendor-DrKzkH4x.js";import{d as J,u as K}from"./index-CCWWoMiH.js";import{a as Q}from"./router-CNLU_KyZ.js";import{al as ee,a4 as h,am as j,A as k,bu as y,bn as u,aU as _,bv as se,m as M,M as E,a3 as D,aX as ne,ax as ce,J as ae,o as L,aB as $,$ as P,v as ie}from"./icons-BtUkkwGS.js";import{f,p as N}from"./date-utils-BkNAU8cl.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";import"./state-72d44OIA.js";const te="_securityPage_b4jk1_1",oe="_backButton_b4jk1_6",de="_header_b4jk1_36",le="_headerIcon_b4jk1_43",re="_securityScore_b4jk1_69",me="_scoreCircle_b4jk1_80",he="_scoreValue_b4jk1_92",je="_scoreInfo_b4jk1_102",ue="_scoreChecks_b4jk1_117",_e="_checkItem_b4jk1_123",xe="_warning_b4jk1_131",be="_tabs_b4jk1_136",ve="_tab_b4jk1_136",pe="_active_b4jk1_163",ke="_tabContent_b4jk1_170",ye="_section_b4jk1_180",fe="_sectionHeader_b4jk1_188",Ne="_sectionIcon_b4jk1_195",ge="_statusBadge_b4jk1_226",Ce="_enabled_b4jk1_233",Ae="_disabled_b4jk1_238",Ie="_enabledState_b4jk1_244",we="_methodInfo_b4jk1_250",Be="_methodIcon_b4jk1_259",Se="_actions_b4jk1_284",ze="_disabledState_b4jk1_289",Me="_warning2FA_b4jk1_295",Ee="_setup2FA_b4jk1_308",De="_methodOptions_b4jk1_315",Le="_methodOption_b4jk1_315",$e="_selected_b4jk1_338",Pe="_recommended_b4jk1_371",Oe="_setupActions_b4jk1_380",Te="_sessionsList_b4jk1_387",He="_sessionCard_b4jk1_393",Re="_current_b4jk1_403",Fe="_sessionIcon_b4jk1_408",Ge="_sessionInfo_b4jk1_419",Ue="_sessionDevice_b4jk1_423",Ve="_currentBadge_b4jk1_434",qe="_sessionMeta_b4jk1_443",Ze="_revokeBtn_b4jk1_456",We="_activityList_b4jk1_475",Ye="_activityItem_b4jk1_480",Xe="_activityIcon_b4jk1_492",Je="_login_b4jk1_502",Ke="_logout_b4jk1_507",Qe="_twofa_b4jk1_512",es="_activityInfo_b4jk1_522",ss="_activityAction_b4jk1_526",ns="_activityMeta_b4jk1_536",cs="_passwordSection_b4jk1_543",as="_formGroup_b4jk1_547",is="_dangerZone_b4jk1_576",ts="_dangerItem_b4jk1_582",os="_primaryBtn_b4jk1_607",ds="_secondaryBtn_b4jk1_626",ls="_dangerBtn_b4jk1_644",rs="_modal_b4jk1_663",ms="_modalContent_b4jk1_674",hs="_modalHeader_b4jk1_683",js="_modalDesc_b4jk1_697",us="_backupCodes_b4jk1_702",_s="_modalActions_b4jk1_722",xs="_emptyState_b4jk1_729",s={securityPage:te,backButton:oe,header:de,headerIcon:le,securityScore:re,scoreCircle:me,scoreValue:he,scoreInfo:je,scoreChecks:ue,checkItem:_e,warning:xe,tabs:be,tab:ve,active:pe,tabContent:ke,section:ye,sectionHeader:fe,sectionIcon:Ne,statusBadge:ge,enabled:Ce,disabled:Ae,enabledState:Ie,methodInfo:we,methodIcon:Be,actions:Se,disabledState:ze,warning2FA:Me,setup2FA:Ee,methodOptions:De,methodOption:Le,selected:$e,recommended:Pe,setupActions:Oe,sessionsList:Te,sessionCard:He,current:Re,sessionIcon:Fe,sessionInfo:Ge,sessionDevice:Ue,currentBadge:Ve,sessionMeta:qe,revokeBtn:Ze,activityList:We,activityItem:Ye,activityIcon:Xe,login:Je,logout:Ke,twofa:Qe,default:"_default_b4jk1_517",activityInfo:es,activityAction:ss,activityMeta:ns,passwordSection:cs,formGroup:as,dangerZone:is,dangerItem:ts,primaryBtn:os,secondaryBtn:ds,dangerBtn:ls,modal:rs,modalContent:ms,modalHeader:hs,modalDesc:js,backupCodes:us,modalActions:_s,emptyState:xs};function Ss(){const O=Q(),i=J(),{user:bs,twoFactorSetup:c,enable2FA:T,disable2FA:H,generateBackupCodes:g,sessions:C,revokeSession:R,revokeAllOtherSessions:F,getAuditLog:G}=K(),[m,U]=a.useState("2fa"),[V,x]=a.useState(!1),[t,b]=a.useState("authenticator"),[vs,ps]=a.useState(""),[q,v]=a.useState(!1),[A,I]=a.useState([]),[ks,Z]=a.useState(null),[w,B]=a.useState(!1),p=G({}).slice(0,10),W=async()=>{const n=await T(t);n.qrCode&&Z(n.qrCode);const o=g();I(o),v(!0),x(!1)},Y=()=>{navigator.clipboard.writeText(A.join(`
`)),B(!0),setTimeout(()=>B(!1),2e3)},X=[{id:"2fa",label:"Two-Factor Auth",icon:y},{id:"sessions",label:"Active Sessions",icon:u},{id:"activity",label:"Security Log",icon:_},{id:"advanced",label:"Advanced",icon:h}];return e.jsxs("div",{className:s.securityPage,children:[e.jsxs("button",{className:s.backButton,onClick:()=>O("/app/settings"),children:[e.jsx(ee,{size:16}),"Back to Settings"]}),e.jsxs("div",{className:s.header,children:[e.jsx("div",{className:s.headerIcon,children:e.jsx(h,{size:28})}),e.jsxs("div",{children:[e.jsx("h1",{children:"Security Settings"}),e.jsx("p",{children:"Manage your account security and authentication"})]})]}),e.jsxs("div",{className:s.securityScore,children:[e.jsxs("div",{className:s.scoreCircle,children:[e.jsxs("svg",{viewBox:"0 0 100 100",children:[e.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"var(--bg-tertiary)",strokeWidth:"8"}),e.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:c!=null&&c.enabled?"var(--success)":"var(--warning)",strokeWidth:"8",strokeDasharray:`${(c!=null&&c.enabled?85:50)*2.83} 283`,strokeLinecap:"round",transform:"rotate(-90 50 50)"})]}),e.jsx("span",{className:s.scoreValue,children:c!=null&&c.enabled?85:50})]}),e.jsxs("div",{className:s.scoreInfo,children:[e.jsx("h3",{children:"Security Score"}),e.jsx("p",{children:c!=null&&c.enabled?"Good - 2FA is enabled":"Fair - Enable 2FA to improve"}),e.jsxs("div",{className:s.scoreChecks,children:[e.jsxs("span",{className:s.checkItem,children:[e.jsx(j,{size:14})," Strong password"]}),e.jsxs("span",{className:`${s.checkItem} ${c!=null&&c.enabled?"":s.warning}`,children:[c!=null&&c.enabled?e.jsx(j,{size:14}):e.jsx(k,{size:14}),"Two-factor authentication"]}),e.jsxs("span",{className:s.checkItem,children:[e.jsx(j,{size:14})," Email verified"]})]})]})]}),e.jsx("div",{className:s.tabs,children:X.map(n=>e.jsxs("button",{className:`${s.tab} ${m===n.id?s.active:""}`,onClick:()=>U(n.id),children:[e.jsx(n.icon,{size:18}),n.label]},n.id))}),m==="2fa"&&e.jsxs("div",{className:s.tabContent,children:[e.jsxs("div",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx("div",{className:s.sectionIcon,children:e.jsx(se,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{children:"Two-Factor Authentication"}),e.jsx("p",{children:"Add an extra layer of security to your account"})]}),e.jsx("div",{className:`${s.statusBadge} ${c!=null&&c.enabled?s.enabled:s.disabled}`,children:c!=null&&c.enabled?"Enabled":"Disabled"})]}),c!=null&&c.enabled?e.jsxs("div",{className:s.enabledState,children:[e.jsxs("div",{className:s.methodInfo,children:[e.jsxs("div",{className:s.methodIcon,children:[c.method==="authenticator"&&e.jsx(y,{size:24}),c.method==="sms"&&e.jsx(M,{size:24}),c.method==="email"&&e.jsx(E,{size:24})]}),e.jsxs("div",{children:[e.jsxs("h4",{children:[c.method==="authenticator"&&"Authenticator App",c.method==="sms"&&"SMS Verification",c.method==="email"&&"Email Verification"]}),e.jsxs("p",{children:["Enabled on ",c.verifiedAt?f(N(c.verifiedAt),"MMM d, yyyy"):"N/A"]})]})]}),e.jsxs("div",{className:s.actions,children:[e.jsxs("button",{className:s.secondaryBtn,onClick:()=>{const n=g();I(n),v(!0)},children:[e.jsx(D,{size:16}),"View Backup Codes"]}),e.jsx("button",{className:s.dangerBtn,onClick:H,children:"Disable 2FA"})]})]}):e.jsx("div",{className:s.disabledState,children:V?e.jsxs("div",{className:s.setup2FA,children:[e.jsx("h3",{children:"Choose your 2FA method"}),e.jsxs("div",{className:s.methodOptions,children:[e.jsxs("label",{className:`${s.methodOption} ${t==="authenticator"?s.selected:""}`,children:[e.jsx("input",{type:"radio",name:"2fa-method",checked:t==="authenticator",onChange:()=>b("authenticator")}),e.jsx(y,{size:24}),e.jsxs("div",{children:[e.jsx("span",{children:"Authenticator App"}),e.jsx("small",{children:"Use Google Authenticator, Authy, or similar"})]}),e.jsx("span",{className:s.recommended,children:"Recommended"})]}),e.jsxs("label",{className:`${s.methodOption} ${t==="sms"?s.selected:""}`,children:[e.jsx("input",{type:"radio",name:"2fa-method",checked:t==="sms",onChange:()=>b("sms")}),e.jsx(M,{size:24}),e.jsxs("div",{children:[e.jsx("span",{children:"SMS"}),e.jsx("small",{children:"Receive codes via text message"})]})]}),e.jsxs("label",{className:`${s.methodOption} ${t==="email"?s.selected:""}`,children:[e.jsx("input",{type:"radio",name:"2fa-method",checked:t==="email",onChange:()=>b("email")}),e.jsx(E,{size:24}),e.jsxs("div",{children:[e.jsx("span",{children:"Email"}),e.jsx("small",{children:"Receive codes via email"})]})]})]}),e.jsxs("div",{className:s.setupActions,children:[e.jsx("button",{className:s.secondaryBtn,onClick:()=>x(!1),children:"Cancel"}),e.jsx("button",{className:s.primaryBtn,onClick:W,children:"Continue Setup"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:s.warning2FA,children:[e.jsx(k,{size:18}),"Your account is not protected by two-factor authentication. Enable 2FA to significantly improve your account security."]}),e.jsxs("button",{className:s.primaryBtn,onClick:()=>x(!0),children:[e.jsx(h,{size:18}),"Enable Two-Factor Authentication"]})]})})]}),q&&e.jsx("div",{className:s.modal,children:e.jsxs("div",{className:s.modalContent,children:[e.jsxs("div",{className:s.modalHeader,children:[e.jsx(D,{size:24}),e.jsx("h2",{children:"Backup Codes"})]}),e.jsx("p",{className:s.modalDesc,children:"Save these backup codes in a secure location. Each code can only be used once."}),e.jsx("div",{className:s.backupCodes,children:A.map((n,o)=>e.jsx("code",{children:n},o))}),e.jsxs("div",{className:s.modalActions,children:[e.jsxs("button",{onClick:Y,className:s.secondaryBtn,children:[w?e.jsx(j,{size:16}):e.jsx(ne,{size:16}),w?"Copied!":"Copy All"]}),e.jsx("button",{onClick:()=>v(!1),className:s.primaryBtn,children:"Done"})]})]})})]}),m==="sessions"&&e.jsx("div",{className:s.tabContent,children:e.jsxs("div",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx("div",{className:s.sectionIcon,children:e.jsx(u,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{children:"Active Sessions"}),e.jsx("p",{children:"Manage devices where you're signed in"})]}),e.jsx("button",{className:s.dangerBtn,onClick:F,children:"Sign Out All Other Sessions"})]}),e.jsxs("div",{className:s.sessionsList,children:[C.map(n=>e.jsxs("div",{className:`${s.sessionCard} ${n.isCurrent?s.current:""}`,children:[e.jsx("div",{className:s.sessionIcon,children:e.jsx(u,{size:24})}),e.jsxs("div",{className:s.sessionInfo,children:[e.jsxs("div",{className:s.sessionDevice,children:[n.deviceInfo.includes("Windows")?"Windows PC":n.deviceInfo.includes("Mac")?"Mac":n.deviceInfo.includes("iPhone")?"iPhone":n.deviceInfo.includes("Android")?"Android":"Unknown Device",n.isCurrent&&e.jsx("span",{className:s.currentBadge,children:"Current"})]}),e.jsxs("div",{className:s.sessionMeta,children:[e.jsxs("span",{children:[e.jsx(ce,{size:12})," ",n.ipAddress]}),e.jsxs("span",{children:[e.jsx(ae,{size:12})," Last active: ",f(N(n.lastActivity),"MMM d, yyyy h:mm a")]})]})]}),!n.isCurrent&&e.jsxs("button",{className:s.revokeBtn,onClick:()=>R(n.id),children:[e.jsx(L,{size:16}),"Revoke"]})]},n.id)),C.length===0&&e.jsxs("div",{className:s.emptyState,children:[e.jsx(u,{size:48}),e.jsx("p",{children:"No active sessions found"})]})]})]})}),m==="activity"&&e.jsx("div",{className:s.tabContent,children:e.jsxs("div",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx("div",{className:s.sectionIcon,children:e.jsx(_,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{children:"Security Activity Log"}),e.jsx("p",{children:"Recent security-related events on your account"})]}),e.jsxs("button",{className:s.secondaryBtn,onClick:()=>{const n=p.map(d=>`${d.timestamp} | ${d.action} | ${d.resource||"N/A"} | ${d.ip||"N/A"}`).join(`
`),o=new Blob([`Security Log Export

Timestamp | Action | Resource | IP
${n}`],{type:"text/plain"}),l=URL.createObjectURL(o),r=document.createElement("a");r.href=l,r.download="security-log.txt",r.click(),URL.revokeObjectURL(l)},children:[e.jsx($,{size:16}),"Export Log"]})]}),e.jsxs("div",{className:s.activityList,children:[p.map(n=>e.jsxs("div",{className:s.activityItem,children:[e.jsxs("div",{className:`${s.activityIcon} ${n.action.includes("login")?s.login:n.action.includes("logout")?s.logout:n.action.includes("2fa")?s.twofa:s.default}`,children:[n.action.includes("login")&&e.jsx(P,{size:16}),n.action.includes("logout")&&e.jsx(L,{size:16}),n.action.includes("2fa")&&e.jsx(h,{size:16}),!n.action.includes("login")&&!n.action.includes("logout")&&!n.action.includes("2fa")&&e.jsx(_,{size:16})]}),e.jsxs("div",{className:s.activityInfo,children:[e.jsx("span",{className:s.activityAction,children:n.action.replace(/_/g," ").replace(/\./g," - ")}),e.jsxs("span",{className:s.activityMeta,children:[f(N(n.timestamp),"MMM d, yyyy h:mm a")," â€¢ ",n.ipAddress]})]})]},n.id)),p.length===0&&e.jsxs("div",{className:s.emptyState,children:[e.jsx(_,{size:48}),e.jsx("p",{children:"No security events recorded"})]})]})]})}),m==="advanced"&&e.jsxs("div",{className:s.tabContent,children:[e.jsxs("div",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx("div",{className:s.sectionIcon,children:e.jsx(P,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{children:"Password"}),e.jsx("p",{children:"Change your account password"})]})]}),e.jsxs("div",{className:s.passwordSection,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Current Password"}),e.jsx("input",{type:"password",placeholder:"Enter current password"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"New Password"}),e.jsx("input",{type:"password",placeholder:"Enter new password"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Confirm New Password"}),e.jsx("input",{type:"password",placeholder:"Confirm new password"})]}),e.jsx("button",{className:s.primaryBtn,onClick:()=>{var d,S,z;const n=document.querySelectorAll('input[type="password"]'),o=(d=n[0])==null?void 0:d.value,l=(S=n[1])==null?void 0:S.value,r=(z=n[2])==null?void 0:z.value;if(!o||!l||!r){i.info("Please fill in all password fields.");return}if(l!==r){i.info("New passwords do not match.");return}if(l.length<8){i.info("Password must be at least 8 characters.");return}i.info("Password updated successfully!")},children:"Update Password"})]})]}),e.jsxs("div",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx("div",{className:s.sectionIcon,children:e.jsx(k,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{children:"Danger Zone"}),e.jsx("p",{children:"Irreversible account actions"})]})]}),e.jsxs("div",{className:s.dangerZone,children:[e.jsxs("div",{className:s.dangerItem,children:[e.jsxs("div",{children:[e.jsx("h4",{children:"Download Account Data"}),e.jsx("p",{children:"Export all your data in a portable format"})]}),e.jsxs("button",{className:s.secondaryBtn,onClick:()=>{i.info("Your data export has been initiated. You will receive an email with a download link within 24 hours.")},children:[e.jsx($,{size:16}),"Export Data"]})]}),e.jsxs("div",{className:s.dangerItem,children:[e.jsxs("div",{children:[e.jsx("h4",{children:"Delete Account"}),e.jsx("p",{children:"Permanently delete your account and all associated data"})]}),e.jsxs("button",{className:s.dangerBtn,onClick:()=>{confirm("Are you absolutely sure you want to delete your account? This action cannot be undone.")&&(prompt('Type "DELETE" to confirm account deletion:')==="DELETE"?i.info("Account deletion request submitted. You will receive a confirmation email."):i.info("Account deletion cancelled."))},children:[e.jsx(ie,{size:16}),"Delete Account"]})]})]})]})]})]})}export{Ss as SecuritySettingsPage};
