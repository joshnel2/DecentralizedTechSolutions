import{r as y,a6 as e}from"./vendor-DrKzkH4x.js";import{a as le,d as se}from"./index-CCWWoMiH.js";import{D as ie,aJ as ne,x as re,y as oe,am as de,A as ce,as as ue,O as pe,z as me,R as be,aK as Z,Q as he,J as xe,aL as ge,a as fe,aM as ve,f as X,aB as W,ao as ye,aA as je,X as _e}from"./icons-BtUkkwGS.js";import{R as O,A as ke,X as Y,Y as Q,T as G,a as ee,B as te,d as J,C as ae,P as Ne,b as Ce}from"./charts-CBxIs53B.js";import{f as Be}from"./date-utils-BkNAU8cl.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";import"./router-CNLU_KyZ.js";import"./state-72d44OIA.js";const Re="_reportsPage_1b4go_3",Te="_header_1b4go_10",Ie="_headerLeft_1b4go_18",De="_headerActions_1b4go_31",Ae="_exportSuccess_1b4go_37",Se="_exportError_1b4go_49",we="_primaryBtn_1b4go_63",Fe="_tabs_1b4go_102",Le="_tab_1b4go_102",Pe="_active_1b4go_132",Me="_overview_1b4go_138",ze="_controlBar_1b4go_143",Ee="_dateRangeSelector_1b4go_150",He="_refreshBtn_1b4go_208",Oe="_kpiGrid_1b4go_228",Ge="_kpiCard_1b4go_247",qe="_kpiHeader_1b4go_260",$e="_kpiIcon_1b4go_267",Ve="_kpiTrend_1b4go_276",Ue="_kpiValue_1b4go_296",Ke="_kpiLabel_1b4go_303",Ye="_kpiSubtext_1b4go_310",Qe="_chartsGrid_1b4go_317",Je="_chartCard_1b4go_330",We="_chartHeader_1b4go_337",Ze="_chartLegend_1b4go_350",Xe="_dot_1b4go_363",et="_viewReportBtn_1b4go_369",tt="_chartContainer_1b4go_386",at="_pieContainer_1b4go_390",st="_pieLegend_1b4go_396",it="_legendItem_1b4go_403",rt="_legendDot_1b4go_410",lt="_legendLabel_1b4go_416",nt="_legendValue_1b4go_422",ot="_quickReports_1b4go_428",dt="_quickReportsGrid_1b4go_439",ct="_quickReportCard_1b4go_445",ut="_quickReportIcon_1b4go_462",pt="_quickReportInfo_1b4go_472",mt="_quickReportName_1b4go_477",bt="_quickReportDesc_1b4go_485",ht="_runBtn_1b4go_494",xt="_categoryView_1b4go_513",gt="_categoryHeader_1b4go_517",ft="_searchBox_1b4go_524",vt="_categoryActions_1b4go_548",yt="_filterBtn_1b4go_553",jt="_filterPanel_1b4go_573",_t="_filterGroup_1b4go_584",kt="_applyFilters_1b4go_642",Nt="_reportsList_1b4go_660",Ct="_reportItem_1b4go_666",Bt="_selected_1b4go_683",Rt="_reportItemIcon_1b4go_688",Tt="_reportItemInfo_1b4go_697",It="_reportItemName_1b4go_701",Dt="_reportItemDesc_1b4go_709",At="_reportItemActions_1b4go_715",St="_runReportBtn_1b4go_749",wt="_modalOverlay_1b4go_845",Ft="_modal_1b4go_845",Lt="_modalHeader_1b4go_871",Pt="_closeBtn_1b4go_885",Mt="_modalBody_1b4go_904",zt="_formGroup_1b4go_910",Et="_modalFooter_1b4go_995",Ht="_cancelBtn_1b4go_1003",t={reportsPage:Re,header:Te,headerLeft:Ie,headerActions:De,exportSuccess:Ae,exportError:Se,primaryBtn:we,tabs:Fe,tab:Le,active:Pe,overview:Me,controlBar:ze,dateRangeSelector:Ee,refreshBtn:He,kpiGrid:Oe,kpiCard:Ge,kpiHeader:qe,kpiIcon:$e,kpiTrend:Ve,kpiValue:Ue,kpiLabel:Ke,kpiSubtext:Ye,chartsGrid:Qe,chartCard:Je,chartHeader:We,chartLegend:Ze,dot:Xe,viewReportBtn:et,chartContainer:tt,pieContainer:at,pieLegend:st,legendItem:it,legendDot:rt,legendLabel:lt,legendValue:nt,quickReports:ot,quickReportsGrid:dt,quickReportCard:ct,quickReportIcon:ut,quickReportInfo:pt,quickReportName:mt,quickReportDesc:bt,runBtn:ht,categoryView:xt,categoryHeader:gt,searchBox:ft,categoryActions:vt,filterBtn:yt,filterPanel:jt,filterGroup:_t,applyFilters:kt,reportsList:Nt,reportItem:Ct,selected:Bt,reportItemIcon:Rt,reportItemInfo:Tt,reportItemName:It,reportItemDesc:Dt,reportItemActions:At,runReportBtn:St,modalOverlay:wt,modal:Ft,modalHeader:Lt,closeBtn:Pt,modalBody:Mt,formGroup:zt,modalFooter:Et,cancelBtn:Ht},q=["#F59E0B","#3B82F6","#10B981","#8B5CF6","#EF4444","#EC4899","#14B8A6","#F97316"],$=[{id:"billing",name:"Billing & Revenue",icon:ie,color:"#F59E0B",reports:[{id:"billing-summary",name:"Billing Summary",desc:"Overview of all billing activity"},{id:"ar-aging",name:"Accounts Receivable Aging",desc:"Outstanding invoices by age"},{id:"payment-history",name:"Payment History",desc:"All payments received"}]},{id:"productivity",name:"Productivity",icon:ne,color:"#3B82F6",reports:[{id:"timekeeper-summary",name:"Timekeeper Summary",desc:"Hours by attorney/staff"},{id:"unbilled-time",name:"Unbilled Time",desc:"Time not yet invoiced"}]},{id:"matters",name:"Matters",icon:re,color:"#10B981",reports:[{id:"matter-status",name:"Matter Status",desc:"All matters by status"}]},{id:"clients",name:"Clients",icon:oe,color:"#8B5CF6",reports:[{id:"client-summary",name:"Client Summary",desc:"All clients overview"}]}];function Zt(){const{matters:_,clients:C,timeEntries:N,invoices:g,expenses:V}=le(),L=se(),[I,R]=y.useState("overview"),[U,j]=y.useState(null),[D,w]=y.useState("this-month"),[P,M]=y.useState(null),[K,F]=y.useState(!1),[z,E]=y.useState(!1),[u,T]=y.useState(""),[H,s]=y.useState(null),o=y.useMemo(()=>{const a=g.reduce((p,x)=>p+x.total,0),r=g.reduce((p,x)=>p+x.amountPaid,0),l=N.reduce((p,x)=>p+x.hours,0),i=N.filter(p=>p.billable).reduce((p,x)=>p+x.hours,0),n=N.filter(p=>p.billed).reduce((p,x)=>p+x.hours,0),m=_.filter(p=>p.status==="active").length,v=g.filter(p=>p.status!=="paid").reduce((p,x)=>p+(x.total-x.amountPaid),0),B=g.filter(p=>p.status==="overdue").reduce((p,x)=>p+(x.total-x.amountPaid),0);return{totalRevenue:a,totalCollected:r,collectionRate:a>0?(r/a*100).toFixed(1):0,totalHours:l,billableHours:i,utilizationRate:l>0?(i/l*100).toFixed(1):0,realizationRate:i>0?(n/i*100).toFixed(1):0,activeMatters:m,activeClients:C.filter(p=>p.isActive).length,outstandingAR:v,overdueAR:B,avgDaysToPay:28}},[g,N,_,C]),d=y.useMemo(()=>{const a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=new Date().getFullYear();return a.map((l,i)=>{const n=g.filter(B=>{const p=new Date(B.issueDate);return p.getMonth()===i&&p.getFullYear()===r}),m=n.reduce((B,p)=>B+p.total,0),v=n.reduce((B,p)=>B+p.amountPaid,0);return{month:l,billed:Math.round(m),collected:Math.round(v),target:5e4}})},[g]),b=y.useMemo(()=>{const a={};return N.forEach(r=>{const l=r.userId||"Unknown User";a[l]||(a[l]={billable:0,nonBillable:0}),r.billable?a[l].billable+=r.hours:a[l].nonBillable+=r.hours}),Object.keys(a).length===0?[]:Object.entries(a).map(([r,l])=>({name:r,billable:Math.round(l.billable*10)/10,nonBillable:Math.round(l.nonBillable*10)/10,target:160}))},[N]),k=y.useMemo(()=>{const a={};return _.forEach(r=>{const l=r.type.replace(/_/g," ");a[l]=(a[l]||0)+1}),Object.entries(a).map(([r,l])=>({name:r,value:l}))},[_]),h=y.useMemo(()=>{const a=new Date,r={Current:{amount:0,color:"#10B981"},"1-30 Days":{amount:0,color:"#F59E0B"},"31-60 Days":{amount:0,color:"#F97316"},"61-90 Days":{amount:0,color:"#EF4444"},"90+ Days":{amount:0,color:"#DC2626"}};return g.filter(l=>l.status!=="paid"&&l.status!=="void").forEach(l=>{const i=new Date(l.dueDate),n=Math.floor((a.getTime()-i.getTime())/(1e3*60*60*24)),m=l.total-l.amountPaid;n<=0?r.Current.amount+=m:n<=30?r["1-30 Days"].amount+=m:n<=60?r["31-60 Days"].amount+=m:n<=90?r["61-90 Days"].amount+=m:r["90+ Days"].amount+=m}),Object.entries(r).map(([l,i])=>({bucket:l,amount:Math.round(i.amount*100)/100,color:i.color}))},[g]),c=(a,r,l)=>{if(!a||a.length===0)return s("No data available to export for this report. Please ensure you have the relevant data in your system."),setTimeout(()=>s(null),5e3),!1;const i=[l.join(","),...a.map(v=>l.map(B=>{const p=B.toLowerCase().replace(/ /g,"_"),x=v[p]??v[B]??"";return typeof x=="string"&&(x.includes(",")||x.includes('"'))?`"${x.replace(/"/g,'""')}"`:x}).join(","))].join(`
`),n=new Blob([i],{type:"text/csv;charset=utf-8;"}),m=document.createElement("a");return m.href=URL.createObjectURL(n),m.download=`${r}_${Be(new Date,"yyyy-MM-dd")}.csv`,m.click(),M(`${r}.csv exported successfully!`),setTimeout(()=>M(null),3e3),!0},f=a=>{s(null);const r={"billing-summary":()=>{if(g.length===0){s("No invoices found. Create invoices to generate a billing summary report."),setTimeout(()=>s(null),5e3);return}const l=g.map(i=>{var n,m;return{invoice_number:i.number,client:((n=C.find(v=>v.id===i.clientId))==null?void 0:n.name)||"",matter:((m=_.find(v=>v.id===i.matterId))==null?void 0:m.name)||"",issue_date:i.issueDate.split("T")[0],due_date:i.dueDate.split("T")[0],total:i.total,paid:i.amountPaid,balance:i.total-i.amountPaid,status:i.status}});c(l,"billing_summary",["Invoice Number","Client","Matter","Issue Date","Due Date","Total","Paid","Balance","Status"])},"ar-aging":()=>{const l=g.filter(n=>n.status!=="paid");if(l.length===0){s("No outstanding invoices found. All invoices are paid or there are no invoices in the system."),setTimeout(()=>s(null),5e3);return}const i=l.map(n=>{var v;const m=Math.floor((Date.now()-new Date(n.issueDate).getTime())/864e5);return{invoice_number:n.number,client:((v=C.find(B=>B.id===n.clientId))==null?void 0:v.name)||"",issue_date:n.issueDate.split("T")[0],due_date:n.dueDate.split("T")[0],days_outstanding:m,amount:n.total-n.amountPaid,aging_bucket:m<=30?"0-30 days":m<=60?"31-60 days":m<=90?"61-90 days":"90+ days"}});c(i,"ar_aging",["Invoice Number","Client","Issue Date","Due Date","Days Outstanding","Amount","Aging Bucket"])},"timekeeper-summary":()=>{if(b.length===0){s("No time entries found. Log time entries to generate a timekeeper summary report."),setTimeout(()=>s(null),5e3);return}const l=b.map(i=>({timekeeper:i.name,billable_hours:i.billable,non_billable_hours:i.nonBillable,total_hours:i.billable+i.nonBillable,utilization:(i.billable/(i.billable+i.nonBillable)*100).toFixed(1)+"%",target:i.target}));c(l,"timekeeper_summary",["Timekeeper","Billable Hours","Non Billable Hours","Total Hours","Utilization","Target"])},"matter-status":()=>{if(_.length===0){s("No matters found. Create matters to generate a matter status report."),setTimeout(()=>s(null),5e3);return}const l=_.map(i=>{var n;return{number:i.number,name:i.name,client:((n=C.find(m=>m.id===i.clientId))==null?void 0:n.name)||"",type:i.type.replace(/_/g," "),status:i.status.replace(/_/g," "),priority:i.priority,open_date:i.openDate.split("T")[0],billing_type:i.billingType}});c(l,"matter_status",["Number","Name","Client","Type","Status","Priority","Open Date","Billing Type"])},"client-summary":()=>{if(C.length===0){s("No clients found. Add clients to generate a client summary report."),setTimeout(()=>s(null),5e3);return}const l=C.map(i=>({name:i.name,type:i.type==="company"?"Organization":"Individual",email:i.email,phone:i.phone,city:i.addressCity,state:i.addressState,status:i.isActive?"Active":"Inactive",matters_count:_.filter(n=>n.clientId===i.id).length,total_billed:g.filter(n=>n.clientId===i.id).reduce((n,m)=>n+m.total,0)}));c(l,"client_summary",["Name","Type","Email","Phone","City","State","Status","Matters Count","Total Billed"])},"unbilled-time":()=>{const l=N.filter(n=>!n.billed&&n.billable);if(l.length===0){s("No unbilled time entries found. All billable time has been invoiced."),setTimeout(()=>s(null),5e3);return}const i=l.map(n=>{var m;return{date:n.date.split("T")[0],matter:((m=_.find(v=>v.id===n.matterId))==null?void 0:m.name)||"",description:n.description,hours:n.hours,rate:n.rate,amount:n.amount}});c(i,"unbilled_time",["Date","Matter","Description","Hours","Rate","Amount"])},"payment-history":()=>{const l=g.filter(n=>n.amountPaid>0);if(l.length===0){s("No payments found. No invoices have been paid yet."),setTimeout(()=>s(null),5e3);return}const i=l.map(n=>{var m;return{invoice_number:n.number,client:((m=C.find(v=>v.id===n.clientId))==null?void 0:m.name)||"",total:n.total,amount_paid:n.amountPaid,status:n.status}});c(i,"payment_history",["Invoice Number","Client","Total","Amount Paid","Status"])}};r[a]?r[a]():(s(`Export for "${a.replace(/-/g," ")}" is not yet implemented. Please try one of the available reports.`),setTimeout(()=>s(null),5e3))},A=y.useMemo(()=>u?$.map(a=>({...a,reports:a.reports.filter(r=>r.name.toLowerCase().includes(u.toLowerCase())||r.desc.toLowerCase().includes(u.toLowerCase()))})).filter(a=>a.reports.length>0):$,[u]);return e.jsxs("div",{className:t.reportsPage,children:[e.jsxs("div",{className:t.header,children:[e.jsxs("div",{className:t.headerLeft,children:[e.jsx("h1",{children:"Reports"}),e.jsx("p",{children:"Comprehensive reporting and analytics for your firm"})]}),e.jsxs("div",{className:t.headerActions,children:[P&&e.jsxs("span",{className:t.exportSuccess,children:[e.jsx(de,{size:16}),P]}),H&&e.jsxs("span",{className:t.exportError,children:[e.jsx(ce,{size:16}),H]}),e.jsxs("button",{className:t.primaryBtn,onClick:()=>F(!0),children:[e.jsx(ue,{size:18}),"Custom Report"]})]})]}),e.jsxs("div",{className:t.tabs,children:[e.jsxs("button",{className:`${t.tab} ${I==="overview"?t.active:""}`,onClick:()=>R("overview"),children:[e.jsx(pe,{size:18}),"Overview"]}),$.map(a=>e.jsxs("button",{className:`${t.tab} ${I===a.id?t.active:""}`,onClick:()=>R(a.id),children:[e.jsx(a.icon,{size:18}),a.name]},a.id))]}),I==="overview"&&e.jsxs("div",{className:t.overview,children:[e.jsxs("div",{className:t.controlBar,children:[e.jsxs("div",{className:t.dateRangeSelector,children:[e.jsx(me,{size:16}),e.jsxs("select",{value:D,onChange:a=>w(a.target.value),children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"this-week",children:"This Week"}),e.jsx("option",{value:"this-month",children:"This Month"}),e.jsx("option",{value:"last-month",children:"Last Month"}),e.jsx("option",{value:"this-quarter",children:"This Quarter"}),e.jsx("option",{value:"this-year",children:"This Year"})]})]}),e.jsxs("button",{className:t.refreshBtn,onClick:()=>{L.info("Dashboard data refreshed!")},children:[e.jsx(be,{size:16}),"Refresh"]})]}),e.jsxs("div",{className:t.kpiGrid,children:[e.jsxs("div",{className:t.kpiCard,children:[e.jsxs("div",{className:t.kpiHeader,children:[e.jsx("div",{className:t.kpiIcon,style:{background:"rgba(245, 158, 11, 0.15)",color:"#F59E0B"},children:e.jsx(ie,{size:22})}),e.jsxs("span",{className:t.kpiTrend,"data-positive":"true",children:[e.jsx(Z,{size:14})," 12.5%"]})]}),e.jsxs("div",{className:t.kpiValue,children:["$",(o.totalRevenue/1e3).toFixed(0),"k"]}),e.jsx("div",{className:t.kpiLabel,children:"Total Revenue"}),e.jsxs("div",{className:t.kpiSubtext,children:["vs $",(o.totalRevenue*.89/1e3).toFixed(0),"k last period"]})]}),e.jsxs("div",{className:t.kpiCard,children:[e.jsxs("div",{className:t.kpiHeader,children:[e.jsx("div",{className:t.kpiIcon,style:{background:"rgba(16, 185, 129, 0.15)",color:"#10B981"},children:e.jsx(he,{size:22})}),e.jsxs("span",{className:t.kpiTrend,"data-positive":"true",children:[e.jsx(Z,{size:14})," 8.3%"]})]}),e.jsxs("div",{className:t.kpiValue,children:[o.collectionRate,"%"]}),e.jsx("div",{className:t.kpiLabel,children:"Collection Rate"}),e.jsxs("div",{className:t.kpiSubtext,children:["$",(o.totalCollected/1e3).toFixed(0),"k collected"]})]}),e.jsxs("div",{className:t.kpiCard,children:[e.jsx("div",{className:t.kpiHeader,children:e.jsx("div",{className:t.kpiIcon,style:{background:"rgba(59, 130, 246, 0.15)",color:"#3B82F6"},children:e.jsx(xe,{size:22})})}),e.jsxs("div",{className:t.kpiValue,children:[o.utilizationRate,"%"]}),e.jsx("div",{className:t.kpiLabel,children:"Utilization Rate"}),e.jsxs("div",{className:t.kpiSubtext,children:[o.billableHours.toFixed(1),"h billable of ",o.totalHours.toFixed(1),"h"]})]}),e.jsxs("div",{className:t.kpiCard,children:[e.jsx("div",{className:t.kpiHeader,children:e.jsx("div",{className:t.kpiIcon,style:{background:"rgba(139, 92, 246, 0.15)",color:"#8B5CF6"},children:e.jsx(ge,{size:22})})}),e.jsxs("div",{className:t.kpiValue,children:[o.realizationRate,"%"]}),e.jsx("div",{className:t.kpiLabel,children:"Realization Rate"}),e.jsx("div",{className:t.kpiSubtext,children:"Target: 90%"})]}),e.jsxs("div",{className:t.kpiCard,children:[e.jsxs("div",{className:t.kpiHeader,children:[e.jsx("div",{className:t.kpiIcon,style:{background:"rgba(239, 68, 68, 0.15)",color:"#EF4444"},children:e.jsx(fe,{size:22})}),e.jsxs("span",{className:t.kpiTrend,"data-positive":"false",children:[e.jsx(ve,{size:14})," 5.2%"]})]}),e.jsxs("div",{className:t.kpiValue,children:["$",(o.outstandingAR/1e3).toFixed(0),"k"]}),e.jsx("div",{className:t.kpiLabel,children:"Outstanding A/R"}),e.jsxs("div",{className:t.kpiSubtext,children:["$",(o.overdueAR/1e3).toFixed(0),"k overdue"]})]}),e.jsxs("div",{className:t.kpiCard,children:[e.jsx("div",{className:t.kpiHeader,children:e.jsx("div",{className:t.kpiIcon,style:{background:"rgba(20, 184, 166, 0.15)",color:"#14B8A6"},children:e.jsx(re,{size:22})})}),e.jsx("div",{className:t.kpiValue,children:o.activeMatters}),e.jsx("div",{className:t.kpiLabel,children:"Active Matters"}),e.jsxs("div",{className:t.kpiSubtext,children:[o.activeClients," active clients"]})]})]}),e.jsxs("div",{className:t.chartsGrid,children:[e.jsxs("div",{className:t.chartCard,children:[e.jsxs("div",{className:t.chartHeader,children:[e.jsx("h3",{children:"Revenue Trend"}),e.jsxs("div",{className:t.chartLegend,children:[e.jsxs("span",{children:[e.jsx("span",{className:t.dot,style:{background:"#F59E0B"}})," Billed"]}),e.jsxs("span",{children:[e.jsx("span",{className:t.dot,style:{background:"#10B981"}})," Collected"]})]})]}),e.jsx("div",{className:t.chartContainer,children:e.jsx(O,{width:"100%",height:280,children:e.jsxs(ke,{data:d,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"billedGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#F59E0B",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#F59E0B",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"collectedGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10B981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10B981",stopOpacity:0})]})]}),e.jsx(Y,{dataKey:"month",axisLine:!1,tickLine:!1,tick:{fill:"#64748B",fontSize:12}}),e.jsx(Q,{axisLine:!1,tickLine:!1,tick:{fill:"#64748B",fontSize:12},tickFormatter:a=>`$${a/1e3}k`}),e.jsx(G,{contentStyle:{background:"#1E293B",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px",color:"#F1F5F9"},formatter:a=>[`$${a.toLocaleString()}`,""]}),e.jsx(ee,{type:"monotone",dataKey:"billed",stroke:"#F59E0B",fill:"url(#billedGrad)",strokeWidth:2}),e.jsx(ee,{type:"monotone",dataKey:"collected",stroke:"#10B981",fill:"url(#collectedGrad)",strokeWidth:2})]})})})]}),e.jsxs("div",{className:t.chartCard,children:[e.jsxs("div",{className:t.chartHeader,children:[e.jsx("h3",{children:"A/R Aging"}),e.jsxs("button",{className:t.viewReportBtn,onClick:()=>f("ar-aging"),children:["View Report ",e.jsx(X,{size:14})]})]}),e.jsx("div",{className:t.chartContainer,children:e.jsx(O,{width:"100%",height:280,children:e.jsxs(te,{data:h,layout:"vertical",children:[e.jsx(Y,{type:"number",axisLine:!1,tickLine:!1,tick:{fill:"#64748B",fontSize:12},tickFormatter:a=>`$${a/1e3}k`}),e.jsx(Q,{type:"category",dataKey:"bucket",axisLine:!1,tickLine:!1,tick:{fill:"#64748B",fontSize:12},width:80}),e.jsx(G,{contentStyle:{background:"#1E293B",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px",color:"#F1F5F9"},formatter:a=>[`$${a.toLocaleString()}`,"Amount"]}),e.jsx(J,{dataKey:"amount",radius:[0,4,4,0],children:h.map((a,r)=>e.jsx(ae,{fill:a.color},`cell-${r}`))})]})})})]}),e.jsxs("div",{className:t.chartCard,children:[e.jsxs("div",{className:t.chartHeader,children:[e.jsx("h3",{children:"Utilization by Timekeeper"}),e.jsxs("button",{className:t.viewReportBtn,onClick:()=>f("timekeeper-summary"),children:["View Report ",e.jsx(X,{size:14})]})]}),e.jsx("div",{className:t.chartContainer,children:e.jsx(O,{width:"100%",height:280,children:e.jsxs(te,{data:b,layout:"vertical",children:[e.jsx(Y,{type:"number",axisLine:!1,tickLine:!1,tick:{fill:"#64748B",fontSize:12}}),e.jsx(Q,{type:"category",dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#64748B",fontSize:12},width:100}),e.jsx(G,{contentStyle:{background:"#1E293B",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px",color:"#F1F5F9"}}),e.jsx(J,{dataKey:"billable",stackId:"a",fill:"#3B82F6",radius:[0,0,0,0],name:"Billable"}),e.jsx(J,{dataKey:"nonBillable",stackId:"a",fill:"#64748B",radius:[0,4,4,0],name:"Non-Billable"})]})})})]}),e.jsxs("div",{className:t.chartCard,children:[e.jsx("div",{className:t.chartHeader,children:e.jsx("h3",{children:"Matters by Practice Area"})}),e.jsxs("div",{className:t.pieContainer,children:[e.jsx(O,{width:"100%",height:200,children:e.jsxs(Ne,{children:[e.jsx(Ce,{data:k,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:2,dataKey:"value",children:k.map((a,r)=>e.jsx(ae,{fill:q[r%q.length]},`cell-${r}`))}),e.jsx(G,{contentStyle:{background:"#1E293B",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px",color:"#F1F5F9"}})]})}),e.jsx("div",{className:t.pieLegend,children:k.map((a,r)=>e.jsxs("div",{className:t.legendItem,children:[e.jsx("span",{className:t.legendDot,style:{background:q[r%q.length]}}),e.jsx("span",{className:t.legendLabel,children:a.name}),e.jsx("span",{className:t.legendValue,children:a.value})]},a.name))})]})]})]}),e.jsxs("div",{className:t.quickReports,children:[e.jsx("h3",{children:"Quick Reports"}),e.jsx("div",{className:t.quickReportsGrid,children:$.flatMap(a=>a.reports.slice(0,2).map(r=>e.jsxs("div",{className:t.quickReportCard,onClick:()=>f(r.id),children:[e.jsx("div",{className:t.quickReportIcon,style:{color:a.color},children:e.jsx(a.icon,{size:20})}),e.jsxs("div",{className:t.quickReportInfo,children:[e.jsx("span",{className:t.quickReportName,children:r.name}),e.jsx("span",{className:t.quickReportDesc,children:r.desc})]}),e.jsx("button",{className:t.runBtn,children:e.jsx(W,{size:14})})]},r.id)))})]})]}),I!=="overview"&&I!=="saved"&&e.jsxs("div",{className:t.categoryView,children:[e.jsxs("div",{className:t.categoryHeader,children:[e.jsxs("div",{className:t.searchBox,children:[e.jsx(ye,{size:18}),e.jsx("input",{type:"text",placeholder:"Search reports...",value:u,onChange:a=>T(a.target.value)})]}),e.jsx("div",{className:t.categoryActions,children:e.jsxs("button",{className:t.filterBtn,onClick:()=>E(!z),children:[e.jsx(je,{size:16}),"Filters"]})})]}),z&&e.jsxs("div",{className:t.filterPanel,children:[e.jsxs("div",{className:t.filterGroup,children:[e.jsx("label",{children:"Date Range"}),e.jsxs("select",{value:D,onChange:a=>w(a.target.value),children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"this-week",children:"This Week"}),e.jsx("option",{value:"this-month",children:"This Month"}),e.jsx("option",{value:"last-month",children:"Last Month"}),e.jsx("option",{value:"this-quarter",children:"This Quarter"}),e.jsx("option",{value:"this-year",children:"This Year"}),e.jsx("option",{value:"custom",children:"Custom Range"})]})]}),e.jsxs("div",{className:t.filterGroup,children:[e.jsx("label",{children:"Timekeeper"}),e.jsx("select",{children:e.jsx("option",{value:"all",children:"All Timekeepers"})})]}),e.jsxs("div",{className:t.filterGroup,children:[e.jsx("label",{children:"Client"}),e.jsxs("select",{children:[e.jsx("option",{value:"all",children:"All Clients"}),C.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{className:t.filterGroup,children:[e.jsx("label",{children:"Matter"}),e.jsxs("select",{children:[e.jsx("option",{value:"all",children:"All Matters"}),_.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsx("button",{className:t.applyFilters,onClick:()=>{L.info("Filters applied! Reports will be generated with the selected criteria."),E(!1)},children:"Apply Filters"})]}),e.jsx("div",{className:t.reportsList,children:A.filter(a=>a.id===I).map(a=>e.jsx("div",{children:a.reports.map(r=>e.jsxs("div",{className:`${t.reportItem} ${U===r.id?t.selected:""}`,onClick:()=>j(r.id),children:[e.jsx("div",{className:t.reportItemIcon,style:{background:`${a.color}20`,color:a.color},children:e.jsx(a.icon,{size:20})}),e.jsxs("div",{className:t.reportItemInfo,children:[e.jsx("span",{className:t.reportItemName,children:r.name}),e.jsx("span",{className:t.reportItemDesc,children:r.desc})]}),e.jsx("div",{className:t.reportItemActions,children:e.jsxs("button",{className:t.runReportBtn,onClick:l=>{l.stopPropagation(),f(r.id)},children:[e.jsx(W,{size:14}),"Export"]})})]},r.id))},a.id))})]}),K&&e.jsx(Ot,{onClose:()=>F(!1),onExport:(a,r,l)=>{c(a,r,l),F(!1)},matters:_,clients:C,invoices:g,timeEntries:N})]})}const S={matters:[{id:"number",label:"Matter Number",default:!0},{id:"name",label:"Matter Name",default:!0},{id:"clientName",label:"Client Name",default:!0},{id:"type",label:"Matter Type",default:!0},{id:"status",label:"Status",default:!0},{id:"priority",label:"Priority",default:!1},{id:"openDate",label:"Open Date",default:!0},{id:"closeDate",label:"Close Date",default:!1},{id:"billingType",label:"Billing Type",default:!1},{id:"practiceArea",label:"Practice Area",default:!1},{id:"responsibleAttorney",label:"Responsible Attorney",default:!1},{id:"originatingAttorney",label:"Originating Attorney",default:!1},{id:"description",label:"Description",default:!1}],clients:[{id:"name",label:"Client Name",default:!0},{id:"type",label:"Client Type",default:!0},{id:"email",label:"Email",default:!0},{id:"phone",label:"Phone",default:!0},{id:"addressCity",label:"City",default:!1},{id:"addressState",label:"State",default:!1},{id:"addressZip",label:"Zip Code",default:!1},{id:"isActive",label:"Status",default:!0},{id:"matterCount",label:"Matter Count",default:!0},{id:"totalBilled",label:"Total Billed",default:!0},{id:"totalPaid",label:"Total Paid",default:!1},{id:"outstanding",label:"Outstanding",default:!1}],invoices:[{id:"number",label:"Invoice Number",default:!0},{id:"clientName",label:"Client Name",default:!0},{id:"matterName",label:"Matter Name",default:!0},{id:"issueDate",label:"Issue Date",default:!0},{id:"dueDate",label:"Due Date",default:!0},{id:"total",label:"Total Amount",default:!0},{id:"amountPaid",label:"Amount Paid",default:!0},{id:"balance",label:"Balance Due",default:!0},{id:"status",label:"Status",default:!0},{id:"daysOutstanding",label:"Days Outstanding",default:!1},{id:"agingBucket",label:"Aging Bucket",default:!1}],timeEntries:[{id:"date",label:"Date",default:!0},{id:"matterName",label:"Matter Name",default:!0},{id:"clientName",label:"Client Name",default:!0},{id:"description",label:"Description",default:!0},{id:"hours",label:"Hours",default:!0},{id:"rate",label:"Rate",default:!0},{id:"amount",label:"Amount",default:!0},{id:"billable",label:"Billable",default:!0},{id:"billed",label:"Billed",default:!1},{id:"activityType",label:"Activity Type",default:!1},{id:"userId",label:"Timekeeper",default:!1}]};function Ot({onClose:_,onExport:C,matters:N,clients:g,invoices:V,timeEntries:L}){const I=se(),[R,U]=y.useState("matters"),[j,D]=y.useState(S.matters.filter(u=>u.default).map(u=>u.id)),[w,P]=y.useState("Custom Report"),M=u=>{U(u),D(S[u].filter(T=>T.default).map(T=>T.id))},K=u=>{j.includes(u)?D(j.filter(T=>T!==u)):D([...j,u])},F=()=>{D(S[R].map(u=>u.id))},z=()=>{D([])},E=()=>{if(j.length===0){I.info("Please select at least one column");return}let u=[];const T=j.map(s=>{var o;return((o=S[R].find(d=>d.id===s))==null?void 0:o.label)||s});switch(R){case"matters":u=N.map(s=>{const o={};return j.forEach(d=>{var b,k,h,c,f;switch(d){case"number":o[d]=s.number;break;case"name":o[d]=s.name;break;case"clientName":o[d]=((b=g.find(A=>A.id===s.clientId))==null?void 0:b.name)||"";break;case"type":o[d]=(k=s.type)==null?void 0:k.replace(/_/g," ");break;case"status":o[d]=(h=s.status)==null?void 0:h.replace(/_/g," ");break;case"priority":o[d]=s.priority;break;case"openDate":o[d]=(c=s.openDate)==null?void 0:c.split("T")[0];break;case"closeDate":o[d]=((f=s.closeDate)==null?void 0:f.split("T")[0])||"";break;case"billingType":o[d]=s.billingType;break;case"practiceArea":o[d]=s.practiceArea||"";break;case"description":o[d]=s.description||"";break;default:o[d]=s[d]||""}}),o});break;case"clients":u=g.map(s=>{const o=N.filter(c=>c.clientId===s.id),d=V.filter(c=>c.clientId===s.id),b=d.reduce((c,f)=>c+f.total,0),k=d.reduce((c,f)=>c+f.amountPaid,0),h={};return j.forEach(c=>{switch(c){case"name":h[c]=s.name||s.displayName;break;case"type":h[c]=s.type==="company"?"Organization":"Individual";break;case"email":h[c]=s.email||"";break;case"phone":h[c]=s.phone||"";break;case"addressCity":h[c]=s.addressCity||"";break;case"addressState":h[c]=s.addressState||"";break;case"addressZip":h[c]=s.addressZip||"";break;case"isActive":h[c]=s.isActive?"Active":"Inactive";break;case"matterCount":h[c]=o.length;break;case"totalBilled":h[c]=b;break;case"totalPaid":h[c]=k;break;case"outstanding":h[c]=b-k;break;default:h[c]=s[c]||""}}),h});break;case"invoices":u=V.map(s=>{const o=Math.floor((Date.now()-new Date(s.issueDate).getTime())/864e5),d={};return j.forEach(b=>{var k,h,c,f;switch(b){case"number":d[b]=s.number;break;case"clientName":d[b]=((k=g.find(A=>A.id===s.clientId))==null?void 0:k.name)||"";break;case"matterName":d[b]=((h=N.find(A=>A.id===s.matterId))==null?void 0:h.name)||"";break;case"issueDate":d[b]=(c=s.issueDate)==null?void 0:c.split("T")[0];break;case"dueDate":d[b]=(f=s.dueDate)==null?void 0:f.split("T")[0];break;case"total":d[b]=s.total;break;case"amountPaid":d[b]=s.amountPaid;break;case"balance":d[b]=s.total-s.amountPaid;break;case"status":d[b]=s.status;break;case"daysOutstanding":d[b]=o;break;case"agingBucket":d[b]=o<=30?"0-30 days":o<=60?"31-60 days":o<=90?"61-90 days":"90+ days";break;default:d[b]=s[b]||""}}),d});break;case"timeEntries":u=L.map(s=>{const o={};return j.forEach(d=>{var b,k,h;switch(d){case"date":o[d]=(b=s.date)==null?void 0:b.split("T")[0];break;case"matterName":o[d]=((k=N.find(c=>c.id===s.matterId))==null?void 0:k.name)||"";break;case"clientName":{const c=N.find(f=>f.id===s.matterId);o[d]=c&&((h=g.find(f=>f.id===c.clientId))==null?void 0:h.name)||"";break}case"description":o[d]=s.description;break;case"hours":o[d]=s.hours;break;case"rate":o[d]=s.rate;break;case"amount":o[d]=s.amount;break;case"billable":o[d]=s.billable?"Yes":"No";break;case"billed":o[d]=s.billed?"Yes":"No";break;case"activityType":o[d]=s.activityType||"";break;default:o[d]=s[d]||""}}),o});break}const H=w.toLowerCase().replace(/\s+/g,"_");C(u,H,T)};return e.jsx("div",{className:t.modalOverlay,onClick:_,children:e.jsxs("div",{className:t.modal,onClick:u=>u.stopPropagation(),style:{maxWidth:"600px"},children:[e.jsxs("div",{className:t.modalHeader,children:[e.jsx("h2",{children:"Custom Report"}),e.jsx("button",{onClick:_,className:t.closeBtn,children:e.jsx(_e,{size:20})})]}),e.jsxs("div",{className:t.modalBody,children:[e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Report Name"}),e.jsx("input",{type:"text",value:w,onChange:u=>P(u.target.value),placeholder:"Enter report name"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{children:"Data Type"}),e.jsxs("select",{value:R,onChange:u=>M(u.target.value),children:[e.jsx("option",{value:"matters",children:"Matters"}),e.jsx("option",{value:"clients",children:"Clients"}),e.jsx("option",{value:"invoices",children:"Invoices"}),e.jsx("option",{value:"timeEntries",children:"Time Entries"})]})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[e.jsx("label",{style:{marginBottom:0},children:"Select Columns to Include"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{type:"button",onClick:F,style:{padding:"0.25rem 0.5rem",background:"none",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"4px",color:"var(--apex-text)",fontSize:"0.75rem",cursor:"pointer"},children:"Select All"}),e.jsx("button",{type:"button",onClick:z,style:{padding:"0.25rem 0.5rem",background:"none",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"4px",color:"var(--apex-text)",fontSize:"0.75rem",cursor:"pointer"},children:"Clear All"})]})]}),e.jsx("div",{style:{background:"var(--apex-slate)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px",padding:"1rem",maxHeight:"250px",overflowY:"auto"},children:e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"0.5rem"},children:S[R].map(u=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",background:j.includes(u.id)?"rgba(245, 158, 11, 0.1)":"transparent",borderRadius:"4px",cursor:"pointer",transition:"background 0.15s ease"},children:[e.jsx("input",{type:"checkbox",checked:j.includes(u.id),onChange:()=>K(u.id),style:{width:"16px",height:"16px",accentColor:"var(--apex-gold)"}}),e.jsx("span",{style:{fontSize:"0.875rem",color:j.includes(u.id)?"var(--apex-white)":"var(--apex-text)"},children:u.label})]},u.id))})}),e.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.75rem",color:"var(--apex-text)"},children:[j.length," of ",S[R].length," columns selected"]})]})]}),e.jsxs("div",{className:t.modalFooter,children:[e.jsx("button",{className:t.cancelBtn,onClick:_,children:"Cancel"}),e.jsxs("button",{className:t.primaryBtn,onClick:E,disabled:j.length===0,children:[e.jsx(W,{size:16}),"Export CSV"]})]})]})})}export{Zt as ReportsPage};
