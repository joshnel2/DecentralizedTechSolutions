import{r as o,a6 as e,h as B}from"./vendor-DrKzkH4x.js";import{d as se,a as ne}from"./router-CNLU_KyZ.js";import{u as te}from"./aiStore-CKroQOhS.js";import{u as ae}from"./index-CCWWoMiH.js";import{g as C,p as oe}from"./documentParser-BCJJeAJ6.js";import{l as ce,S as w,j as de,F as I,as as ie,P as D,i as le,aY as $,L as M,X as R,f as U,aZ as O,a_ as Y}from"./icons-BtUkkwGS.js";import{f as re,p as me}from"./date-utils-BkNAU8cl.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";import"./state-72d44OIA.js";const ue="_aiPage_dbc1q_1",pe="_leftPanel_dbc1q_10",he="_modeSection_dbc1q_19",xe="_modeButtons_dbc1q_33",_e="_modeBtn_dbc1q_39",ge="_active_dbc1q_58",je="_modeBtnIcon_dbc1q_64",fe="_modeBtnName_dbc1q_93",be="_modeBtnDesc_dbc1q_94",Ne="_modeBtnText_dbc1q_108",ve="_poweredBy_dbc1q_1226",ye="_mainArea_dbc1q_1238",Be="_chatHeader_dbc1q_1246",Ce="_chatHeaderMode_dbc1q_1255",Ie="_documentIndicator_dbc1q_1263",De="_newChatBtn_dbc1q_1275",qe="_messagesContainer_dbc1q_1296",Se="_message_dbc1q_1296",ke="_userMessage_dbc1q_1309",Ae="_aiAvatar_dbc1q_1314",ze="_messageContent_dbc1q_1325",we="_aiMessage_dbc1q_1336",Me="_messageText_dbc1q_1343",Re="_messageTime_dbc1q_1369",Ue="_typingIndicator_dbc1q_1380",Ee="_inputArea_dbc1q_1398",Pe="_inputRow_dbc1q_1406",Te="_attachBtn_dbc1q_1412",Fe="_setupView_dbc1q_1472",He="_documentSetup_dbc1q_1480",Ve="_redlineSetup_dbc1q_1481",Le="_standardSetup_dbc1q_1482",$e="_setupIcon_dbc1q_1487",Oe="_uploadBtn_dbc1q_1521",Ye="_uploadedDoc_dbc1q_1541",Ge="_uploadedDocInfo_dbc1q_1556",Je="_uploadedDocName_dbc1q_1561",Xe="_uploadedDocMeta_dbc1q_1568",Ze="_removeDoc_dbc1q_1573",Ke="_startBtn_dbc1q_1588",Qe="_redlineUploads_dbc1q_1609",We="_redlineUpload_dbc1q_1609",es="_redlineLabel_dbc1q_1620",ss="_redlineUploadBtn_dbc1q_1628",ns="_redlineVs_dbc1q_1659",ts="_suggestions_dbc1q_1667",as="_spinner_dbc1q_1708",s={aiPage:ue,leftPanel:pe,modeSection:he,modeButtons:xe,modeBtn:_e,active:ge,modeBtnIcon:je,modeBtnName:fe,modeBtnDesc:be,modeBtnText:Ne,poweredBy:ve,mainArea:ye,chatHeader:Be,chatHeaderMode:Ce,documentIndicator:Ie,newChatBtn:De,messagesContainer:qe,message:Se,userMessage:ke,aiAvatar:Ae,messageContent:ze,aiMessage:we,messageText:Me,messageTime:Re,typingIndicator:Ue,inputArea:Ee,inputRow:Pe,attachBtn:Te,setupView:Fe,documentSetup:He,redlineSetup:Ve,standardSetup:Le,setupIcon:$e,uploadBtn:Oe,uploadedDoc:Ye,uploadedDocInfo:Ge,uploadedDocName:Je,uploadedDocMeta:Xe,removeDoc:Ze,startBtn:Ke,redlineUploads:Qe,redlineUpload:We,redlineLabel:es,redlineUploadBtn:ss,redlineVs:ns,suggestions:ts,spinner:as},m={document:{id:"document",name:"Document Analyzer",description:"Upload a document and ask questions about it",icon:e.jsx($,{size:24}),color:"#10B981",placeholder:"Ask about this document..."},redline:{id:"redline",name:"Redline AI",description:"Compare two documents and identify changes",icon:e.jsx(O,{size:24}),color:"#EF4444",placeholder:"Compare these documents..."},standard:{id:"standard",name:"Standard Chat",description:"General legal assistant for research and drafting",icon:e.jsx(Y,{size:24}),color:"#8B5CF6",placeholder:"Ask anything..."}};function Ns(){const[p]=se(),E=ne(),{conversations:G,activeConversationId:P,selectedMode:c,isLoading:j,initialMessage:q,documentContext:l,redlineDocuments:d,setSelectedMode:S,setDocumentContext:_,setRedlineDocument:f,setInitialMessage:T,createConversation:i,setActiveConversation:J,generateResponse:k,deleteConversation:cs,clearDocumentContext:F}=te(),{user:ds}=ae(),[b,h]=o.useState(""),[is,ls]=o.useState(!1),X=o.useRef(null),A=o.useRef(null),N=o.useRef(null),H=o.useRef(null),V=o.useRef(null),r=G.find(n=>n.id===P),x=m[c],[z,L]=o.useState(!1);o.useEffect(()=>{const n=p.get("docId"),t=p.get("docName"),a=p.get("docContent");t&&a&&(S("document"),_({id:n||void 0,name:decodeURIComponent(t),content:decodeURIComponent(a)}),i("document"))},[p]),o.useEffect(()=>{const n=sessionStorage.getItem("documentAI_content");if(n)try{const{content:t,templateName:a}=JSON.parse(n);if(t&&a){sessionStorage.removeItem("documentAI_content"),S("document"),_({name:`${a}.txt`,content:t,type:"text/plain"});const u=i("document");k(u.id,`I just generated this ${a} document. Please review it and let me know if there are any issues, missing information, or improvements I should make.`)}}catch(t){console.error("Error parsing document automation content:",t),sessionStorage.removeItem("documentAI_content")}},[]),o.useEffect(()=>{q&&(h(q),T(null))},[q,T]),o.useEffect(()=>{var n;A.current&&((n=r==null?void 0:r.messages)!=null&&n.length)&&A.current.scrollIntoView({behavior:"smooth",block:"start"})},[r==null?void 0:r.messages]);const v=async(n,t)=>{var u;const a=(u=n.target.files)==null?void 0:u[0];if(a){n.target.value="",L(!0);try{const y=await oe(a),g={name:a.name,content:y.content,type:a.type,size:a.size,imageData:y.imageData};c==="redline"&&t?f(t,g):_(g)}catch(y){console.error("Failed to extract document text:",y);const g={name:a.name,content:`[Error extracting text from ${a.name}. Please try again.]`,type:a.type,size:a.size};c==="redline"&&t?f(t,g):_(g)}finally{L(!1)}}},Z=async n=>{if(n.preventDefault(),!b.trim()||j)return;let t=P;t||(t=i(c).id);const a=b;h(""),await k(t,a)},K=n=>{if(n==="redline"){E("/app/ai/redline");return}S(n),F(),J(null)},Q=()=>{F(),i(c)},W=()=>{l&&i("document")},ee=()=>{if(!d.doc1||!d.doc2)return;const n=i("redline");k(n.id,"Please compare these two documents, identify all changes, and highlight the key differences.")};return e.jsxs("div",{className:s.aiPage,children:[e.jsxs("div",{className:s.leftPanel,children:[e.jsxs("div",{className:s.modeSection,children:[e.jsx("h3",{children:"AI Assistant"}),e.jsx("div",{className:s.modeButtons,children:Object.keys(m).map(n=>{const t=m[n];return e.jsxs("button",{className:B(s.modeBtn,c===n&&s.active),onClick:()=>K(n),style:{"--mode-color":t.color},children:[e.jsx("div",{className:s.modeBtnIcon,children:t.icon}),e.jsxs("div",{className:s.modeBtnText,children:[e.jsx("span",{className:s.modeBtnName,children:t.name}),e.jsx("span",{className:s.modeBtnDesc,children:t.description})]})]},n)})}),e.jsxs("button",{className:B(s.modeBtn,s.backgroundAgentBtn),onClick:()=>E("/app/background-agent"),style:{"--mode-color":"#F59E0B"},children:[e.jsx("div",{className:s.modeBtnIcon,children:e.jsx(ce,{size:24})}),e.jsxs("div",{className:s.modeBtnText,children:[e.jsx("span",{className:s.modeBtnName,children:"Background Agent"}),e.jsx("span",{className:s.modeBtnDesc,children:"Autonomous long-running tasks"})]})]})]}),e.jsxs("div",{className:s.poweredBy,children:[e.jsx(w,{size:14}),e.jsx("span",{children:"Powered by Azure OpenAI"})]})]}),e.jsx("div",{className:s.mainArea,children:r?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:s.chatHeader,children:[e.jsxs("div",{className:s.chatHeaderMode,style:{color:x.color},children:[x.icon,e.jsx("span",{children:x.name})]}),l&&c==="document"&&e.jsxs("div",{className:s.documentIndicator,children:[l.imageData?e.jsx(de,{size:14}):e.jsx(I,{size:14}),e.jsx("span",{children:l.name})]}),e.jsxs("button",{className:s.newChatBtn,onClick:Q,children:[e.jsx(ie,{size:16}),"New Chat"]})]}),e.jsxs("div",{className:s.messagesContainer,children:[r.messages.map((n,t)=>{const a=n.role==="user"&&r.messages.slice(t+1).every(u=>u.role!=="user");return e.jsxs("div",{ref:a?A:null,className:B(s.message,n.role==="user"?s.userMessage:s.aiMessage),children:[n.role==="assistant"&&e.jsx("div",{className:s.aiAvatar,style:{background:x.color},children:e.jsx(w,{size:16})}),e.jsxs("div",{className:s.messageContent,children:[e.jsx("div",{className:s.messageText,dangerouslySetInnerHTML:{__html:os(n.content)}}),e.jsx("span",{className:s.messageTime,children:re(me(n.timestamp),"h:mm a")})]})]},n.id)}),j&&e.jsxs("div",{className:B(s.message,s.aiMessage),children:[e.jsx("div",{className:s.aiAvatar,style:{background:x.color},children:e.jsx(w,{size:16})}),e.jsx("div",{className:s.messageContent,children:e.jsxs("div",{className:s.typingIndicator,children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]})})]}),e.jsx("div",{ref:X})]}),e.jsx("form",{onSubmit:Z,className:s.inputArea,children:e.jsxs("div",{className:s.inputRow,children:[c==="document"&&e.jsx("button",{type:"button",className:s.attachBtn,onClick:()=>{var n;return(n=N.current)==null?void 0:n.click()},title:"Attach document",children:e.jsx(D,{size:18})}),e.jsx("input",{type:"hidden"}),e.jsx("input",{type:"file",ref:N,onChange:n=>v(n),style:{display:"none"},accept:C()}),e.jsx("input",{type:"text",value:b,onChange:n=>h(n.target.value),placeholder:x.placeholder,disabled:j}),e.jsx("button",{type:"submit",disabled:j||!b.trim(),children:e.jsx(le,{size:18})})]})})]}):e.jsxs("div",{className:s.setupView,children:[c==="document"&&e.jsxs("div",{className:s.documentSetup,children:[e.jsx("div",{className:s.setupIcon,style:{color:m.document.color},children:e.jsx($,{size:48})}),e.jsx("h2",{children:"Document Analyzer"}),e.jsx("p",{children:"Upload a document or image to analyze. Ask questions, get summaries, extract text from images, or identify key information."}),z?e.jsxs("div",{className:s.uploadedDoc,children:[e.jsx(M,{size:24,className:s.spinner}),e.jsxs("div",{className:s.uploadedDocInfo,children:[e.jsx("span",{className:s.uploadedDocName,children:"Extracting text..."}),e.jsx("span",{className:s.uploadedDocMeta,children:"Please wait while we process your document"})]})]}):l?e.jsxs("div",{className:s.uploadedDoc,children:[e.jsx(I,{size:24}),e.jsxs("div",{className:s.uploadedDocInfo,children:[e.jsx("span",{className:s.uploadedDocName,children:l.name}),e.jsx("span",{className:s.uploadedDocMeta,children:l.imageData?"Image • AI Vision ready":`${l.type} • Ready to analyze`})]}),e.jsx("button",{onClick:()=>_(null),className:s.removeDoc,children:e.jsx(R,{size:16})})]}):e.jsxs("button",{className:s.uploadBtn,onClick:()=>{var n;return(n=N.current)==null?void 0:n.click()},children:[e.jsx(D,{size:20}),"Upload Document"]}),e.jsx("input",{type:"file",ref:N,onChange:n=>v(n),style:{display:"none"},accept:C()}),l&&e.jsxs("button",{className:s.startBtn,onClick:W,style:{background:m.document.color},children:["Start Analysis",e.jsx(U,{size:18})]})]}),c==="redline"&&e.jsxs("div",{className:s.redlineSetup,children:[e.jsx("div",{className:s.setupIcon,style:{color:m.redline.color},children:e.jsx(O,{size:48})}),e.jsx("h2",{children:"Redline AI"}),e.jsx("p",{children:"Upload two versions of a document to compare. I'll identify all changes and highlight key differences."}),e.jsxs("div",{className:s.redlineUploads,children:[e.jsxs("div",{className:s.redlineUpload,children:[e.jsx("span",{className:s.redlineLabel,children:"Original Document"}),z&&!d.doc1?e.jsxs("div",{className:s.uploadedDoc,children:[e.jsx(M,{size:20,className:s.spinner}),e.jsx("span",{children:"Extracting text..."})]}):d.doc1?e.jsxs("div",{className:s.uploadedDoc,children:[e.jsx(I,{size:20}),e.jsx("span",{children:d.doc1.name}),e.jsx("button",{onClick:()=>f("doc1",null),children:e.jsx(R,{size:14})})]}):e.jsxs("button",{className:s.redlineUploadBtn,onClick:()=>{var n;return(n=H.current)==null?void 0:n.click()},children:[e.jsx(D,{size:16}),"Upload Original"]}),e.jsx("input",{type:"file",ref:H,onChange:n=>v(n,"doc1"),style:{display:"none"},accept:C()})]}),e.jsx("div",{className:s.redlineVs,children:"VS"}),e.jsxs("div",{className:s.redlineUpload,children:[e.jsx("span",{className:s.redlineLabel,children:"Revised Document"}),z&&!d.doc2&&d.doc1?e.jsxs("div",{className:s.uploadedDoc,children:[e.jsx(M,{size:20,className:s.spinner}),e.jsx("span",{children:"Extracting text..."})]}):d.doc2?e.jsxs("div",{className:s.uploadedDoc,children:[e.jsx(I,{size:20}),e.jsx("span",{children:d.doc2.name}),e.jsx("button",{onClick:()=>f("doc2",null),children:e.jsx(R,{size:14})})]}):e.jsxs("button",{className:s.redlineUploadBtn,onClick:()=>{var n;return(n=V.current)==null?void 0:n.click()},children:[e.jsx(D,{size:16}),"Upload Revised"]}),e.jsx("input",{type:"file",ref:V,onChange:n=>v(n,"doc2"),style:{display:"none"},accept:C()})]})]}),d.doc1&&d.doc2&&e.jsxs("button",{className:s.startBtn,onClick:ee,style:{background:m.redline.color},children:["Compare Documents",e.jsx(U,{size:18})]})]}),c==="standard"&&e.jsxs("div",{className:s.standardSetup,children:[e.jsx("div",{className:s.setupIcon,style:{color:m.standard.color},children:e.jsx(Y,{size:48})}),e.jsx("h2",{children:"Standard Chat"}),e.jsx("p",{children:"Your AI-powered legal assistant. Ask questions, get research help, or draft documents."}),e.jsxs("div",{className:s.suggestions,children:[e.jsx("button",{onClick:()=>{i("standard"),setTimeout(()=>{h("Research case law on breach of contract")},100)},children:"Research case law on breach of contract"}),e.jsx("button",{onClick:()=>{i("standard"),setTimeout(()=>{h("Draft a confidentiality clause")},100)},children:"Draft a confidentiality clause"}),e.jsx("button",{onClick:()=>{i("standard"),setTimeout(()=>{h("Explain the statute of limitations")},100)},children:"Explain the statute of limitations"})]}),e.jsxs("button",{className:s.startBtn,onClick:()=>i("standard"),style:{background:m.standard.color},children:["Start New Chat",e.jsx(U,{size:18})]})]})]})})]})}function os(p){return p.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`([^`]+)`/g,"<code>$1</code>").replace(/```([\s\S]*?)```/g,"<pre><code>$1</code></pre>").replace(/\n/g,"<br>").replace(/• /g,"&bull; ").replace(/✓/g,'<span style="color: #10B981">✓</span>').replace(/⚠️/g,'<span style="color: #F59E0B">⚠️</span>')}export{Ns as AIAssistantPage};
