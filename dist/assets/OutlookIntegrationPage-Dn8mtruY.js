import{r as i,a6 as e}from"./vendor-DrKzkH4x.js";import{a as We,d as es}from"./router-CNLU_KyZ.js";import{h as ss,i as r,m as ts,q as as,p as ge}from"./index-CCWWoMiH.js";import{t as fe,a as ns,al as is,M as Y,bk as cs,bp as os,aZ as K,i as we,av as ve,s as ls,R as rs,ao as ds,L as I,P as X,an as ms,bq as hs,br as us,bs as _s,v as ps,a2 as js,J as xs,X as ye,U as gs,x as fs,aE as ws}from"./icons-BtUkkwGS.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";import"./state-72d44OIA.js";const vs="_emailClient_5w42r_2",ys="_notification_5w42r_11",Ns="_slideIn_5w42r_1",Ss="_success_5w42r_25",bs="_error_5w42r_30",Cs="_sidebar_5w42r_61",ks="_sidebarHeader_5w42r_69",As="_backBtn_5w42r_76",Bs="_logoSection_5w42r_95",Ds="_composeBtn_5w42r_108",Ls="_folders_5w42r_130",zs="_folder_5w42r_130",Fs="_active_5w42r_157",Is="_badge_5w42r_166",Ms="_count_5w42r_175",$s="_sidebarFooter_5w42r_184",Os="_settingsBtn_5w42r_193",Es="_syncBtn_5w42r_194",Hs="_emailList_5w42r_220",Ps="_listHeader_5w42r_228",Ts="_searchBox_5w42r_240",Rs="_loadingList_5w42r_268",Us="_listItems_5w42r_276",qs="_emptyList_5w42r_281",Js="_emailItem_5w42r_296",Ys="_selected_5w42r_307",Ks="_unread_5w42r_313",Xs="_sender_5w42r_317",Zs="_emailItemSubject_5w42r_322",Gs="_emailItemHeader_5w42r_326",Qs="_date_5w42r_342",Vs="_emailItemPreview_5w42r_365",Ws="_readingPane_5w42r_374",et="_noEmailSelected_5w42r_381",st="_emailHeader_5w42r_401",tt="_closePane_5w42r_410",at="_emailActions_5w42r_422",nt="_deleteAction_5w42r_447",it="_linkAction_5w42r_452",ct="_emailContent_5w42r_461",ot="_emailSubject_5w42r_467",lt="_emailMeta_5w42r_475",rt="_senderInfo_5w42r_484",dt="_avatar_5w42r_490",mt="_senderDetails_5w42r_503",ht="_senderName_5w42r_508",ut="_senderEmail_5w42r_513",_t="_emailDate_5w42r_518",pt="_recipients_5w42r_526",jt="_emailBody_5w42r_536",xt="_loadingBody_5w42r_542",gt="_composeOverlay_5w42r_550",ft="_composeModal_5w42r_564",wt="_slideUp_5w42r_1",vt="_composeHeader_5w42r_586",yt="_composeHeaderActions_5w42r_601",Nt="_composeFields_5w42r_624",St="_composeField_5w42r_624",bt="_composeBody_5w42r_664",Ct="_composeFooter_5w42r_678",kt="_composeTools_5w42r_688",At="_sendBtn_5w42r_712",Bt="_modalOverlay_5w42r_736",Dt="_modal_5w42r_736",Lt="_settingsModal_5w42r_750",zt="_emailSubjectModal_5w42r_772",Ft="_linkTypeToggle_5w42r_778",It="_selectField_5w42r_810",Mt="_settingSection_5w42r_821",$t="_modalActions_5w42r_855",Ot="_cancelBtn_5w42r_861",Et="_confirmBtn_5w42r_862",Ht="_spinning_5w42r_897",Pt="_spin_5w42r_897",Tt="_attachmentsList_5w42r_952",Rt="_attachmentItem_5w42r_961",Ut="_attachmentName_5w42r_973",qt="_attachmentSize_5w42r_980",Jt="_removeAttachment_5w42r_985",Yt="_attachmentDropdown_5w42r_1000",Kt="_attachBtn_5w42r_1004",Xt="_attachmentMenu_5w42r_1022",Zt="_attachmentOption_5w42r_1037",Gt="_attachmentDivider_5w42r_1056",Qt="_attachmentDocuments_5w42r_1062",Vt="_attachmentSectionLabel_5w42r_1066",Wt="_noDocuments_5w42r_1075",ea="_attachmentDocOption_5w42r_1083",sa="_attachedCheck_5w42r_1115",t={emailClient:vs,notification:ys,slideIn:Ns,success:Ss,error:bs,sidebar:Cs,sidebarHeader:ks,backBtn:As,logoSection:Bs,composeBtn:Ds,folders:Ls,folder:zs,active:Fs,badge:Is,count:Ms,sidebarFooter:$s,settingsBtn:Os,syncBtn:Es,emailList:Hs,listHeader:Ps,searchBox:Ts,loadingList:Rs,listItems:Us,emptyList:qs,emailItem:Js,selected:Ys,unread:Ks,sender:Xs,emailItemSubject:Zs,emailItemHeader:Gs,date:Qs,emailItemPreview:Vs,readingPane:Ws,noEmailSelected:et,emailHeader:st,closePane:tt,emailActions:at,deleteAction:nt,linkAction:it,emailContent:ct,emailSubject:ot,emailMeta:lt,senderInfo:rt,avatar:dt,senderDetails:mt,senderName:ht,senderEmail:ut,emailDate:_t,recipients:pt,emailBody:jt,loadingBody:xt,composeOverlay:gt,composeModal:ft,slideUp:wt,composeHeader:vt,composeHeaderActions:yt,composeFields:Nt,composeField:St,composeBody:bt,composeFooter:Ct,composeTools:kt,sendBtn:At,modalOverlay:Bt,modal:Dt,settingsModal:Lt,emailSubjectModal:zt,linkTypeToggle:Ft,selectField:It,settingSection:Mt,modalActions:$t,cancelBtn:Ot,confirmBtn:Et,spinning:Ht,spin:Pt,attachmentsList:Tt,attachmentItem:Rt,attachmentName:Ut,attachmentSize:qt,removeAttachment:Jt,attachmentDropdown:Yt,attachBtn:Kt,attachmentMenu:Xt,attachmentOption:Zt,attachmentDivider:Gt,attachmentDocuments:Qt,attachmentSectionLabel:Vt,noDocuments:Wt,attachmentDocOption:ea,attachedCheck:sa};function da(){const Ne=We(),[Z]=es(),G=i.useRef(null),[d,S]=i.useState("inbox"),[m,M]=i.useState([]),[Q,Se]=i.useState([]),[V,be]=i.useState([]),[Ce,W]=i.useState(!0),[$,ee]=i.useState(!1),[se,ke]=i.useState(""),[c,h]=i.useState(null),[O,b]=i.useState(""),[Ae,te]=i.useState(!1),[Be,C]=i.useState(!1),[De,Le]=i.useState([]),[ze,Fe]=i.useState([]),[_,ae]=i.useState("matter"),[v,Ie]=i.useState(""),[ne,ie]=i.useState(!1),[k,E]=i.useState(null),[y,j]=i.useState(""),[H,x]=i.useState(""),[P,g]=i.useState(""),[N,f]=i.useState(""),[T,ce]=i.useState(!1),[oe,le]=i.useState(!1),[u,A]=i.useState([]),[re,B]=i.useState(!1),[de,Me]=i.useState([]),D=i.useRef(null),[p,me]=i.useState(""),[$e,L]=i.useState(!1),[R,he]=i.useState(""),[z,l]=i.useState(null);i.useEffect(()=>{ue(),U(),q(),Re(),Ue(),Oe()},[]);const Oe=async()=>{try{const s=await ss.getAll();Me((s.documents||[]).map(a=>({id:a.id,name:a.name||a.originalName,size:a.size})))}catch(s){console.error("Failed to load documents:",s)}},Ee=s=>{const a=s.target.files;if(!a)return;const n=Array.from(a).map(o=>({id:`file-${Date.now()}-${Math.random()}`,name:o.name,size:o.size,type:"file"}));A([...u,...n]),D.current&&(D.current.value="")},He=s=>{u.some(a=>a.id===s.id)||(A([...u,{id:s.id,name:s.name,size:s.size,type:"document"}]),B(!1))},Pe=s=>{A(u.filter(a=>a.id!==s))},Te=s=>s?s<1024?`${s} B`:s<1024*1024?`${(s/1024).toFixed(1)} KB`:`${(s/1024/1024).toFixed(2)} MB`:"0 B";i.useEffect(()=>{const s=Z.get("emailId");if(s&&m.length>0){const a=m.find(n=>n.id===s);a&&_e(a)}},[m,Z]);const ue=async()=>{try{W(!0);const s=await r.getOutlookEmails();M(s.emails||[])}catch(s){l({type:"error",message:s.message||"Failed to load emails"})}finally{W(!1)}},U=async()=>{try{const s=await r.getOutlookDrafts();Se(s.drafts||[])}catch(s){console.error("Failed to load drafts:",s)}},q=async()=>{var s,a;try{const n=await((a=(s=r).getOutlookSent)==null?void 0:a.call(s))||{emails:[]};be(n.emails||[])}catch(n){console.error("Failed to load sent emails:",n)}},Re=async()=>{try{const[s,a]=await Promise.all([ts.getAll(),as.getAll()]);Le(s.matters||[]),Fe(a.clients||[])}catch{}},Ue=async()=>{try{const s=await ge.get();s!=null&&s.emailSignature&&(me(s.emailSignature),he(s.emailSignature))}catch(s){console.error("Failed to load signature:",s)}},qe=async()=>{try{await ge.update({emailSignature:R}),me(R),L(!1),l({type:"success",message:"Signature saved"})}catch{l({type:"error",message:"Failed to save signature"})}},Je=async()=>{ee(!0);try{await ue(),await U(),await q(),l({type:"success",message:"Outlook synced successfully"})}catch(s){l({type:"error",message:s.message||"Sync failed"})}finally{ee(!1)}},_e=async s=>{var a,n;h(s),te(!0);try{const o=await((n=(a=r).getOutlookEmailBody)==null?void 0:n.call(a,s.id));b((o==null?void 0:o.body)||s.preview||"")}catch{b(s.preview||"Unable to load email body")}finally{te(!1)}},Ye=async()=>{if(!(!c||!v)){ie(!0);try{await r.linkEmailToMatter(c.id,{matterId:_==="matter"?v:void 0,clientId:_==="client"?v:void 0}),l({type:"success",message:`Email linked to ${_} successfully`}),C(!1)}catch(s){l({type:"error",message:s.message||"Failed to link email"})}finally{ie(!1)}}},F=(s,a)=>{if(E(s),s==="new")j(""),x(""),g(""),f(p?`

${p}`:"");else if(a&&(s==="reply"||s==="replyAll")){j(a.from||""),x(""),g(`Re: ${a.subject}`);const n=`

---
On ${J(a.receivedAt)}, ${a.fromName||a.from} wrote:

${O||a.preview}`;f((p?`

${p}`:"")+n)}else if(a&&s==="forward"){j(""),x(""),g(`Fwd: ${a.subject}`);const n=`

---
---------- Forwarded message ----------
From: ${a.fromName||a.from}
Date: ${J(a.receivedAt)}
Subject: ${a.subject}

${O||a.preview}`;f((p?`

${p}`:"")+n)}setTimeout(()=>{var n;return(n=G.current)==null?void 0:n.focus()},100)},Ke=()=>{N.trim()&&N!==p&&!confirm("Discard this draft?")||(E(null),j(""),x(""),g(""),f(""),A([]),B(!1))},Xe=async()=>{var s,a;if(!y.trim()){l({type:"error",message:"Please enter a recipient"});return}ce(!0);try{await((a=(s=r).sendOutlookEmail)==null?void 0:a.call(s,{to:y,cc:H||void 0,subject:P,body:N})),l({type:"success",message:"Email sent successfully"}),E(null),j(""),x(""),g(""),f(""),q()}catch(n){l({type:"error",message:n.message||"Failed to send email"})}finally{ce(!1)}},Ze=async()=>{var s,a;le(!0);try{await((a=(s=r).saveOutlookDraft)==null?void 0:a.call(s,{to:y,cc:H||void 0,subject:P,body:N})),l({type:"success",message:"Draft saved"}),U()}catch(n){l({type:"error",message:n.message||"Failed to save draft"})}finally{le(!1)}},Ge=async s=>{var a,n;if(confirm("Move this email to trash?"))try{await((n=(a=r).deleteOutlookEmail)==null?void 0:n.call(a,s)),M(m.filter(o=>o.id!==s)),(c==null?void 0:c.id)===s&&(h(null),b("")),l({type:"success",message:"Email moved to trash"})}catch{l({type:"error",message:"Failed to delete email"})}},Qe=async s=>{var a,n;try{await((n=(a=r).archiveOutlookEmail)==null?void 0:n.call(a,s)),M(m.filter(o=>o.id!==s)),(c==null?void 0:c.id)===s&&(h(null),b("")),l({type:"success",message:"Email archived"})}catch{l({type:"error",message:"Failed to archive email"})}},pe=()=>{const s=se.toLowerCase();switch(d){case"inbox":return m.filter(a=>{var n,o,w;return((n=a.subject)==null?void 0:n.toLowerCase().includes(s))||((o=a.from)==null?void 0:o.toLowerCase().includes(s))||((w=a.fromName)==null?void 0:w.toLowerCase().includes(s))});case"drafts":return Q.filter(a=>{var n,o;return((n=a.subject)==null?void 0:n.toLowerCase().includes(s))||((o=a.to)==null?void 0:o.toLowerCase().includes(s))});case"sent":return V.filter(a=>{var n,o;return((n=a.subject)==null?void 0:n.toLowerCase().includes(s))||((o=a.to)==null?void 0:o.toLowerCase().includes(s))});default:return[]}},Ve=s=>{const a=new Date(s),o=new Date().getTime()-a.getTime(),w=Math.floor(o/(1e3*60*60*24));return w===0?a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):w===1?"Yesterday":w<7?a.toLocaleDateString([],{weekday:"short"}):a.toLocaleDateString([],{month:"short",day:"numeric"})},J=s=>new Date(s).toLocaleString([],{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),je={inbox:m.length,drafts:Q.length,sent:V.length},xe=m.filter(s=>!s.isRead).length;return e.jsxs("div",{className:t.emailClient,children:[z&&e.jsxs("div",{className:`${t.notification} ${t[z.type]}`,children:[z.type==="success"?e.jsx(fe,{size:16}):e.jsx(ns,{size:16}),z.message,e.jsx("button",{onClick:()=>l(null),children:"Ã—"})]}),e.jsxs("div",{className:t.sidebar,children:[e.jsxs("div",{className:t.sidebarHeader,children:[e.jsx("button",{className:t.backBtn,onClick:()=>Ne("/app/integrations"),children:e.jsx(is,{size:18})}),e.jsxs("div",{className:t.logoSection,children:[e.jsx(Y,{size:24}),e.jsx("span",{children:"Outlook"})]})]}),e.jsxs("button",{className:t.composeBtn,onClick:()=>F("new"),children:[e.jsx(cs,{size:18}),"Compose"]}),e.jsxs("nav",{className:t.folders,children:[e.jsxs("button",{className:`${t.folder} ${d==="inbox"?t.active:""}`,onClick:()=>{S("inbox"),h(null)},children:[e.jsx(os,{size:18}),e.jsx("span",{children:"Inbox"}),xe>0&&e.jsx("span",{className:t.badge,children:xe})]}),e.jsxs("button",{className:`${t.folder} ${d==="drafts"?t.active:""}`,onClick:()=>{S("drafts"),h(null)},children:[e.jsx(K,{size:18}),e.jsx("span",{children:"Drafts"}),je.drafts>0&&e.jsx("span",{className:t.count,children:je.drafts})]}),e.jsxs("button",{className:`${t.folder} ${d==="sent"?t.active:""}`,onClick:()=>{S("sent"),h(null)},children:[e.jsx(we,{size:18}),e.jsx("span",{children:"Sent"})]}),e.jsxs("button",{className:`${t.folder} ${d==="archive"?t.active:""}`,onClick:()=>{S("archive"),h(null)},children:[e.jsx(ve,{size:18}),e.jsx("span",{children:"Archive"})]})]}),e.jsxs("div",{className:t.sidebarFooter,children:[e.jsxs("button",{className:t.settingsBtn,onClick:()=>L(!0),children:[e.jsx(ls,{size:18}),"Settings"]}),e.jsxs("button",{className:t.syncBtn,onClick:Je,disabled:$,children:[e.jsx(rs,{size:18,className:$?t.spinning:""}),$?"Syncing...":"Sync"]})]})]}),e.jsxs("div",{className:t.emailList,children:[e.jsxs("div",{className:t.listHeader,children:[e.jsx("h2",{children:d.charAt(0).toUpperCase()+d.slice(1)}),e.jsxs("div",{className:t.searchBox,children:[e.jsx(ds,{size:16}),e.jsx("input",{type:"text",placeholder:"Search...",value:se,onChange:s=>ke(s.target.value)})]})]}),Ce?e.jsx("div",{className:t.loadingList,children:e.jsx(I,{size:24,className:t.spinning})}):e.jsx("div",{className:t.listItems,children:pe().length===0?e.jsxs("div",{className:t.emptyList,children:[e.jsx(Y,{size:32}),e.jsx("p",{children:"No emails"})]}):pe().map(s=>e.jsxs("div",{className:`${t.emailItem} ${s.isRead?"":t.unread} ${(c==null?void 0:c.id)===s.id?t.selected:""}`,onClick:()=>_e(s),children:[e.jsxs("div",{className:t.emailItemHeader,children:[e.jsx("span",{className:t.sender,children:d==="sent"?`To: ${s.toName||s.to||"(No recipient)"}`:s.fromName||s.from||"Unknown"}),e.jsx("span",{className:t.date,children:Ve(s.receivedAt||s.lastModified||s.createdAt)})]}),e.jsxs("div",{className:t.emailItemSubject,children:[s.hasAttachments&&e.jsx(X,{size:12}),s.subject||"(No Subject)"]}),e.jsx("div",{className:t.emailItemPreview,children:s.preview||s.bodyPreview||""})]},s.id))})]}),e.jsx("div",{className:t.readingPane,children:c?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:t.emailHeader,children:[e.jsx("button",{className:t.closePane,onClick:()=>h(null),children:e.jsx(ms,{size:20})}),e.jsxs("div",{className:t.emailActions,children:[e.jsx("button",{onClick:()=>F("reply",c),title:"Reply",children:e.jsx(hs,{size:18})}),e.jsx("button",{onClick:()=>F("replyAll",c),title:"Reply All",children:e.jsx(us,{size:18})}),e.jsx("button",{onClick:()=>F("forward",c),title:"Forward",children:e.jsx(_s,{size:18})}),e.jsx("button",{onClick:()=>Qe(c.id),title:"Archive",children:e.jsx(ve,{size:18})}),e.jsx("button",{onClick:()=>Ge(c.id),title:"Delete",className:t.deleteAction,children:e.jsx(ps,{size:18})}),e.jsx("button",{onClick:()=>C(!0),title:"Link to Matter/Client",className:t.linkAction,children:e.jsx(js,{size:18})})]})]}),e.jsxs("div",{className:t.emailContent,children:[e.jsx("h1",{className:t.emailSubject,children:c.subject||"(No Subject)"}),e.jsxs("div",{className:t.emailMeta,children:[e.jsxs("div",{className:t.senderInfo,children:[e.jsx("div",{className:t.avatar,children:(c.fromName||c.from||"?")[0].toUpperCase()}),e.jsxs("div",{className:t.senderDetails,children:[e.jsx("span",{className:t.senderName,children:c.fromName||"Unknown"}),e.jsxs("span",{className:t.senderEmail,children:["<",c.from,">"]})]})]}),e.jsxs("div",{className:t.emailDate,children:[e.jsx(xs,{size:14}),J(c.receivedAt)]})]}),c.to&&e.jsxs("div",{className:t.recipients,children:[e.jsx("span",{children:"To:"})," ",c.toName||c.to]}),e.jsx("div",{className:t.emailBody,children:Ae?e.jsxs("div",{className:t.loadingBody,children:[e.jsx(I,{size:20,className:t.spinning}),"Loading..."]}):e.jsx("div",{dangerouslySetInnerHTML:{__html:O.replace(/\n/g,"<br/>")}})})]})]}):e.jsxs("div",{className:t.noEmailSelected,children:[e.jsx(Y,{size:48}),e.jsx("h3",{children:"Select an email to read"}),e.jsx("p",{children:"Click on an email from the list to view its contents"})]})}),k&&e.jsx("div",{className:t.composeOverlay,children:e.jsxs("div",{className:t.composeModal,children:[e.jsxs("div",{className:t.composeHeader,children:[e.jsx("h3",{children:k==="new"?"New Message":k==="reply"?"Reply":k==="replyAll"?"Reply All":"Forward"}),e.jsxs("div",{className:t.composeHeaderActions,children:[e.jsx("button",{onClick:Ze,disabled:oe,title:"Save Draft",children:oe?e.jsx(I,{size:16,className:t.spinning}):e.jsx(K,{size:16})}),e.jsx("button",{onClick:Ke,title:"Close",children:e.jsx(ye,{size:18})})]})]}),e.jsxs("div",{className:t.composeFields,children:[e.jsxs("div",{className:t.composeField,children:[e.jsx("label",{children:"To:"}),e.jsx("input",{type:"text",value:y,onChange:s=>j(s.target.value)})]}),e.jsxs("div",{className:t.composeField,children:[e.jsx("label",{children:"Cc:"}),e.jsx("input",{type:"text",value:H,onChange:s=>x(s.target.value)})]}),e.jsxs("div",{className:t.composeField,children:[e.jsx("label",{children:"Subject:"}),e.jsx("input",{type:"text",value:P,onChange:s=>g(s.target.value)})]})]}),e.jsx("textarea",{ref:G,className:t.composeBody,value:N,onChange:s=>f(s.target.value)}),u.length>0&&e.jsx("div",{className:t.attachmentsList,children:u.map(s=>e.jsxs("div",{className:t.attachmentItem,children:[e.jsx(X,{size:14}),e.jsx("span",{className:t.attachmentName,children:s.name}),e.jsxs("span",{className:t.attachmentSize,children:["(",Te(s.size),")"]}),e.jsx("button",{onClick:()=>Pe(s.id),className:t.removeAttachment,children:e.jsx(ye,{size:14})})]},s.id))}),e.jsxs("div",{className:t.composeFooter,children:[e.jsxs("div",{className:t.composeTools,children:[e.jsxs("div",{className:t.attachmentDropdown,children:[e.jsxs("button",{onClick:()=>B(!re),title:"Attach file",className:t.attachBtn,children:[e.jsx(X,{size:18}),"Attach"]}),re&&e.jsxs("div",{className:t.attachmentMenu,children:[e.jsxs("button",{onClick:()=>{var s;(s=D.current)==null||s.click(),B(!1)},className:t.attachmentOption,children:[e.jsx(gs,{size:16}),"Upload from Computer"]}),e.jsx("div",{className:t.attachmentDivider}),e.jsxs("div",{className:t.attachmentDocuments,children:[e.jsx("span",{className:t.attachmentSectionLabel,children:"From Documents"}),de.length===0?e.jsx("span",{className:t.noDocuments,children:"No documents available"}):de.slice(0,10).map(s=>e.jsxs("button",{onClick:()=>He(s),className:t.attachmentDocOption,disabled:u.some(a=>a.id===s.id),children:[e.jsx(K,{size:14}),e.jsx("span",{children:s.name}),u.some(a=>a.id===s.id)&&e.jsx(fe,{size:14,className:t.attachedCheck})]},s.id))]})]})]}),e.jsx("input",{ref:D,type:"file",multiple:!0,style:{display:"none"},onChange:Ee})]}),e.jsxs("button",{className:t.sendBtn,onClick:Xe,disabled:T||!y.trim(),children:[T?e.jsx(I,{size:18,className:t.spinning}):e.jsx(we,{size:18}),T?"Sending...":"Send"]})]})]})}),Be&&c&&e.jsx("div",{className:t.modalOverlay,onClick:()=>C(!1),children:e.jsxs("div",{className:t.modal,onClick:s=>s.stopPropagation(),children:[e.jsx("h2",{children:"Link Email"}),e.jsxs("p",{className:t.emailSubjectModal,children:['"',c.subject,'"']}),e.jsxs("div",{className:t.linkTypeToggle,children:[e.jsxs("button",{className:_==="matter"?t.active:"",onClick:()=>ae("matter"),children:[e.jsx(fs,{size:16}),"Matter"]}),e.jsxs("button",{className:_==="client"?t.active:"",onClick:()=>ae("client"),children:[e.jsx(ws,{size:16}),"Client"]})]}),e.jsxs("select",{value:v,onChange:s=>Ie(s.target.value),className:t.selectField,children:[e.jsxs("option",{value:"",children:["Select a ",_,"..."]}),_==="matter"?De.map(s=>e.jsxs("option",{value:s.id,children:[s.number," - ",s.name]},s.id)):ze.map(s=>e.jsx("option",{value:s.id,children:s.displayName||s.name},s.id))]}),e.jsxs("div",{className:t.modalActions,children:[e.jsx("button",{className:t.cancelBtn,onClick:()=>C(!1),children:"Cancel"}),e.jsx("button",{className:t.confirmBtn,onClick:Ye,disabled:!v||ne,children:ne?"Linking...":"Link Email"})]})]})}),$e&&e.jsx("div",{className:t.modalOverlay,onClick:()=>L(!1),children:e.jsxs("div",{className:t.settingsModal,onClick:s=>s.stopPropagation(),children:[e.jsx("h2",{children:"Email Settings"}),e.jsxs("div",{className:t.settingSection,children:[e.jsx("h3",{children:"Email Signature"}),e.jsx("p",{children:"Your signature will be automatically added to new emails"}),e.jsx("textarea",{value:R,onChange:s=>he(s.target.value),placeholder:`Enter your email signature...

Example:
Best regards,
John Smith
Attorney at Law
Apex Legal | (555) 123-4567`,rows:8})]}),e.jsxs("div",{className:t.modalActions,children:[e.jsx("button",{className:t.cancelBtn,onClick:()=>L(!1),children:"Cancel"}),e.jsx("button",{className:t.confirmBtn,onClick:qe,children:"Save Settings"})]})]})})]})}export{da as OutlookIntegrationPage};
