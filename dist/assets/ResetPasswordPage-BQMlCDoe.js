import{r,a6 as s}from"./vendor-DrKzkH4x.js";import{d as A,a as R,L as p}from"./router-CNLU_KyZ.js";import{s as e}from"./AuthPages.module-DbukPY8p.js";import{L as G,o as H,ag as m,al as w,C as q,a as V,aj as v,ak as b}from"./icons-BtUkkwGS.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";const N="https://apexai-api.azurewebsites.net/api";function J(){const[C]=A(),k=R(),n=C.get("token"),[t,S]=r.useState(""),[o,P]=r.useState(""),[c,E]=r.useState(!1),[x,B]=r.useState(!1),[g,f]=r.useState(!1),[z,j]=r.useState(!0),[I,h]=r.useState(!1),[u,F]=r.useState(""),[L,O]=r.useState(!1),[y,d]=r.useState("");r.useEffect(()=>{(async()=>{if(!n){j(!1),h(!1);return}try{const l=await(await fetch(`${N}/auth/verify-reset-token?token=${encodeURIComponent(n)}`)).json();h(l.valid),l.firstName&&F(l.firstName)}catch(a){console.error("Token verification error:",a),h(!1)}finally{j(!1)}})()},[n]);const T=async i=>{if(i.preventDefault(),d(""),t!==o){d("Passwords do not match");return}if(t.length<8){d("Password must be at least 8 characters");return}f(!0);try{const a=await fetch(`${N}/auth/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:n,newPassword:t})}),l=await a.json();if(!a.ok)throw new Error(l.error||"Failed to reset password");O(!0)}catch(a){d(a instanceof Error?a.message:"Something went wrong")}finally{f(!1)}};return z?s.jsxs("div",{className:e.authPage,children:[s.jsxs("div",{className:e.bgEffects,children:[s.jsx("div",{className:e.gradientOrb1}),s.jsx("div",{className:e.gradientOrb2}),s.jsx("div",{className:e.gridOverlay})]}),s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",position:"relative",zIndex:1},children:s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx(G,{size:48,color:"#F59E0B",style:{animation:"spin 1s linear infinite"}}),s.jsx("p",{style:{color:"#94a3b8",marginTop:"16px"},children:"Verifying your reset link..."}),s.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"})]})})]}):!n||!I?s.jsxs("div",{className:e.authPage,children:[s.jsxs("div",{className:e.bgEffects,children:[s.jsx("div",{className:e.gradientOrb1}),s.jsx("div",{className:e.gradientOrb2}),s.jsx("div",{className:e.gridOverlay})]}),s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",position:"relative",zIndex:1,padding:"20px"},children:s.jsxs("div",{style:{textAlign:"center",maxWidth:"400px"},children:[s.jsx("div",{style:{width:"64px",height:"64px",borderRadius:"50%",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 24px"},children:s.jsx(H,{size:32,color:"#EF4444"})}),s.jsx("h2",{style:{color:"#fff",fontSize:"24px",marginBottom:"12px"},children:"Invalid or Expired Link"}),s.jsx("p",{style:{color:"#94a3b8",lineHeight:"1.6",marginBottom:"32px"},children:"This password reset link is invalid or has expired. Reset links are only valid for 1 hour. Please request a new one."}),s.jsxs(p,{to:"/forgot-password",className:e.submitBtn,style:{textDecoration:"none",display:"inline-flex",alignItems:"center",gap:"8px"},children:["Request new link",s.jsx(m,{size:18})]}),s.jsx("div",{style:{marginTop:"24px"},children:s.jsxs(p,{to:"/login",style:{color:"#F59E0B",fontSize:"14px"},children:[s.jsx(w,{size:16,style:{verticalAlign:"middle",marginRight:"6px"}}),"Back to login"]})})]})})]}):L?s.jsxs("div",{className:e.authPage,children:[s.jsxs("div",{className:e.bgEffects,children:[s.jsx("div",{className:e.gradientOrb1}),s.jsx("div",{className:e.gradientOrb2}),s.jsx("div",{className:e.gridOverlay})]}),s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",position:"relative",zIndex:1,padding:"20px"},children:s.jsxs("div",{style:{textAlign:"center",maxWidth:"400px"},children:[s.jsx("div",{style:{width:"64px",height:"64px",borderRadius:"50%",background:"linear-gradient(135deg, rgba(34, 197, 94, 0.15) 0%, rgba(34, 197, 94, 0.05) 100%)",border:"1px solid rgba(34, 197, 94, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 24px"},children:s.jsx(q,{size:32,color:"#22C55E"})}),s.jsx("h2",{style:{color:"#fff",fontSize:"24px",marginBottom:"12px"},children:"Password Reset Complete"}),s.jsx("p",{style:{color:"#94a3b8",lineHeight:"1.6",marginBottom:"32px"},children:"Your password has been reset successfully. You can now log in with your new password."}),s.jsxs("button",{onClick:()=>k("/login"),className:e.submitBtn,style:{display:"inline-flex",alignItems:"center",gap:"8px"},children:["Continue to login",s.jsx(m,{size:18})]})]})})]}):s.jsxs("div",{className:e.authPage,children:[s.jsxs("div",{className:e.bgEffects,children:[s.jsx("div",{className:e.gradientOrb1}),s.jsx("div",{className:e.gradientOrb2}),s.jsx("div",{className:e.gridOverlay})]}),s.jsx("div",{className:e.mobileHeader,children:s.jsxs("div",{className:e.logo,children:[s.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 32 32",fill:"none",children:[s.jsx("path",{d:"M16 4L28 28H4L16 4Z",fill:"url(#mobileGrad)",stroke:"#F59E0B",strokeWidth:"1.5"}),s.jsx("circle",{cx:"16",cy:"19",r:"3",fill:"#0B0F1A"}),s.jsx("defs",{children:s.jsxs("linearGradient",{id:"mobileGrad",x1:"16",y1:"4",x2:"16",y2:"28",children:[s.jsx("stop",{stopColor:"#FBBF24"}),s.jsx("stop",{offset:"1",stopColor:"#F59E0B"})]})})]}),s.jsx("span",{className:e.logoText,children:"Apex"})]})}),s.jsx("div",{className:e.brandSide,children:s.jsxs("div",{className:e.brandContent,children:[s.jsxs("div",{className:e.logo,children:[s.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 32 32",fill:"none",children:[s.jsx("path",{d:"M16 4L28 28H4L16 4Z",fill:"url(#resetGrad)",stroke:"#F59E0B",strokeWidth:"1.5"}),s.jsx("circle",{cx:"16",cy:"19",r:"3",fill:"#0B0F1A"}),s.jsx("defs",{children:s.jsxs("linearGradient",{id:"resetGrad",x1:"16",y1:"4",x2:"16",y2:"28",children:[s.jsx("stop",{stopColor:"#FBBF24"}),s.jsx("stop",{offset:"1",stopColor:"#F59E0B"})]})})]}),s.jsx("span",{className:e.logoText,children:"Apex"})]}),s.jsx("h1",{className:e.brandTitle,children:"Create a new password."}),s.jsx("p",{className:e.brandSubtitle,children:"Choose a strong password that you haven't used before. Your password should be at least 8 characters long."})]})}),s.jsx("div",{className:e.formSide,children:s.jsxs("div",{className:e.formContainer,children:[s.jsxs("div",{className:e.formHeader,children:[s.jsx("h2",{children:"Set new password"}),s.jsxs("p",{children:[u?`Hi ${u}, `:"","Enter your new password below."]})]}),y&&s.jsxs("div",{className:e.errorAlert,children:[s.jsx(V,{size:18}),s.jsx("span",{children:y})]}),s.jsxs("form",{onSubmit:T,className:e.form,children:[s.jsxs("div",{className:e.inputGroup,children:[s.jsx("label",{htmlFor:"password",children:"New password"}),s.jsxs("div",{className:e.passwordInput,children:[s.jsx("input",{type:c?"text":"password",id:"password",value:t,onChange:i=>S(i.target.value),placeholder:"Enter new password",required:!0,minLength:8,autoFocus:!0}),s.jsx("button",{type:"button",className:e.passwordToggle,onClick:()=>E(!c),children:c?s.jsx(v,{size:18}):s.jsx(b,{size:18})})]})]}),s.jsxs("div",{className:e.inputGroup,children:[s.jsx("label",{htmlFor:"confirmPassword",children:"Confirm password"}),s.jsxs("div",{className:e.passwordInput,children:[s.jsx("input",{type:x?"text":"password",id:"confirmPassword",value:o,onChange:i=>P(i.target.value),placeholder:"Confirm new password",required:!0,minLength:8}),s.jsx("button",{type:"button",className:e.passwordToggle,onClick:()=>B(!x),children:x?s.jsx(v,{size:18}):s.jsx(b,{size:18})})]})]}),s.jsxs("div",{style:{padding:"12px",background:"rgba(255, 255, 255, 0.03)",borderRadius:"8px",fontSize:"13px",color:"#64748b"},children:[s.jsx("p",{style:{margin:"0 0 8px",fontWeight:500,color:"#94a3b8"},children:"Password requirements:"}),s.jsxs("ul",{style:{margin:0,paddingLeft:"20px"},children:[s.jsx("li",{style:{color:t.length>=8?"#22C55E":"#64748b"},children:"At least 8 characters"}),s.jsx("li",{style:{color:t===o&&t.length>0?"#22C55E":"#64748b"},children:"Passwords match"})]})]}),s.jsx("button",{type:"submit",className:e.submitBtn,disabled:g||t.length<8||t!==o,children:g?s.jsx("span",{className:e.spinner}):s.jsxs(s.Fragment,{children:["Reset password",s.jsx(m,{size:18})]})})]}),s.jsx("div",{className:e.signupPrompt,children:s.jsxs(p,{to:"/login",style:{display:"inline-flex",alignItems:"center",gap:"6px"},children:[s.jsx(w,{size:16}),"Back to login"]})})]})})]})}export{J as ResetPasswordPage};
