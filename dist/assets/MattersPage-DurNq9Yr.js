import{r as i,a6 as e,h as L}from"./vendor-DrKzkH4x.js";import{a as Oe,d as De,L as he}from"./router-CNLU_KyZ.js";import{a as Fe,u as Ee,b as Le,d as xe,t as Pe,m as He}from"./index-CCWWoMiH.js";import{M as $e}from"./MatterTypesManager-P8eWpN0d.js";import{s as ve,X as ye,aq as Ge,ak as fe,aj as We,ar as Ue,as as Ve,y as ae,x as G,ao as je,at as Xe,S as Je,au as Ke,o as Qe,am as be,av as Ye,v as qe,a4 as Ze,L as et,A as pe,aw as tt}from"./icons-BtUkkwGS.js";import{s as n}from"./ListPages.module-B2P1D6uk.js";import{C as st}from"./ConfirmationModal-X7YGPBKC.js";import{f as nt,p as at}from"./date-utils-BkNAU8cl.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";import"./state-72d44OIA.js";const lt="_overlay_1yr9v_1",it="_modal_1yr9v_18",rt="_header_1yr9v_30",ot="_headerTitle_1yr9v_38",ct="_closeBtn_1yr9v_53",dt="_content_1yr9v_71",ut="_description_1yr9v_77",mt="_columnsList_1yr9v_84",ht="_columnItem_1yr9v_91",pt="_hidden_1yr9v_107",gt="_dragging_1yr9v_112",xt="_dragOver_1yr9v_118",vt="_dragHandle_1yr9v_123",yt="_columnLabel_1yr9v_137",ft="_columnActions_1yr9v_144",jt="_moveBtn_1yr9v_150",bt="_visibilityBtn_1yr9v_175",Ct="_visible_1yr9v_193",Nt="_resetBtn_1yr9v_197",St="_footer_1yr9v_219",wt="_stats_1yr9v_228",_t="_footerActions_1yr9v_233",At="_cancelBtn_1yr9v_238",kt="_saveBtn_1yr9v_254",d={overlay:lt,modal:it,header:rt,headerTitle:ot,closeBtn:ct,content:dt,description:ut,columnsList:mt,columnItem:ht,hidden:pt,dragging:gt,dragOver:xt,dragHandle:vt,columnLabel:yt,columnActions:ft,moveBtn:jt,visibilityBtn:bt,visible:Ct,resetBtn:Nt,footer:St,stats:wt,footerActions:_t,cancelBtn:At,saveBtn:kt},Tt=[{id:"matter",label:"Matter",visible:!0,order:0},{id:"client",label:"Client",visible:!0,order:1},{id:"responsibleAttorney",label:"Responsible Attorney",visible:!0,order:2},{id:"type",label:"Type",visible:!0,order:3},{id:"status",label:"Status",visible:!0,order:4},{id:"billing",label:"Billing",visible:!0,order:5},{id:"opened",label:"Opened",visible:!0,order:6}];function le(){return Tt.map(v=>({...v}))}function Mt(v){try{const p=localStorage.getItem(v);if(p){const N=JSON.parse(p);return le().map(m=>{const g=N.find(j=>j.id===m.id);return g?{...m,visible:g.visible,order:g.order}:m}).sort((m,g)=>m.order-g.order)}}catch(p){console.error("Failed to load column settings:",p)}return le()}function It(v,p){try{localStorage.setItem(v,JSON.stringify(p))}catch(N){console.error("Failed to save column settings:",N)}}function Bt({isOpen:v,onClose:p,columns:N,onSave:C,storageKey:R}){const[m,g]=i.useState(N),[j,b]=i.useState(null),[k,o]=i.useState(null);if(i.useEffect(()=>{g(N)},[N]),!v)return null;const S=l=>{g(r=>r.map(x=>x.id===l?{...x,visible:!x.visible}:x))},f=l=>{b(l)},T=(l,r)=>{l.preventDefault(),o(r)},_=()=>{if(j!==null&&k!==null&&j!==k){const l=[...m],[r]=l.splice(j,1);l.splice(k,0,r);const x=l.map((w,h)=>({...w,order:h}));g(x)}b(null),o(null)},M=l=>{if(l===0)return;const r=[...m],x=r[l];r[l]=r[l-1],r[l-1]=x;const w=r.map((h,z)=>({...h,order:z}));g(w)},O=l=>{if(l===m.length-1)return;const r=[...m],x=r[l];r[l]=r[l+1],r[l+1]=x;const w=r.map((h,z)=>({...h,order:z}));g(w)},I=()=>{const l=le();g(l)},c=()=>{It(R,m),C(m),p()},B=m.filter(l=>l.visible).length;return e.jsx("div",{className:d.overlay,onClick:p,children:e.jsxs("div",{className:d.modal,onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:d.header,children:[e.jsxs("div",{className:d.headerTitle,children:[e.jsx(ve,{size:20}),e.jsx("h2",{children:"Column Settings"})]}),e.jsx("button",{onClick:p,className:d.closeBtn,children:e.jsx(ye,{size:20})})]}),e.jsxs("div",{className:d.content,children:[e.jsx("p",{className:d.description,children:"Toggle columns on/off and drag to reorder. Changes will be saved for your account."}),e.jsx("div",{className:d.columnsList,children:m.map((l,r)=>e.jsxs("div",{className:L(d.columnItem,!l.visible&&d.hidden,j===r&&d.dragging,k===r&&d.dragOver),draggable:!0,onDragStart:()=>f(r),onDragOver:x=>T(x,r),onDragEnd:_,children:[e.jsx("div",{className:d.dragHandle,children:e.jsx(Ge,{size:16})}),e.jsx("span",{className:d.columnLabel,children:l.label}),e.jsxs("div",{className:d.columnActions,children:[e.jsx("button",{className:d.moveBtn,onClick:()=>M(r),disabled:r===0,title:"Move up",children:"↑"}),e.jsx("button",{className:d.moveBtn,onClick:()=>O(r),disabled:r===m.length-1,title:"Move down",children:"↓"}),e.jsx("button",{className:L(d.visibilityBtn,l.visible&&d.visible),onClick:()=>S(l.id),title:l.visible?"Hide column":"Show column",children:l.visible?e.jsx(fe,{size:16}):e.jsx(We,{size:16})})]})]},l.id))}),e.jsxs("button",{onClick:I,className:d.resetBtn,children:[e.jsx(Ue,{size:14}),"Reset to Defaults"]})]}),e.jsxs("div",{className:d.footer,children:[e.jsxs("span",{className:d.stats,children:[B," of ",m.length," columns visible"]}),e.jsxs("div",{className:d.footerActions,children:[e.jsx("button",{onClick:p,className:d.cancelBtn,children:"Cancel"}),e.jsx("button",{onClick:c,className:d.saveBtn,children:"Save Changes"})]})]})]})})}const ge="matters-column-settings",Rt=[{value:"all",label:"All Statuses"},{value:"active",label:"Active"},{value:"pending",label:"Pending"},{value:"on_hold",label:"On Hold"},{value:"closed",label:"Closed"},{value:"archived",label:"Archived"}],zt=v=>{const p=[{value:"my",label:"My Matters"}];return v&&p.push({value:"all",label:"All Matters"}),p};function Kt(){const{matters:v,clients:p,addMatter:N,fetchMatters:C,fetchClients:R,updateMatter:m,deleteMatter:g,matterTypes:j}=Fe(),{user:b,hasPermission:k}=Ee(),{openChat:o}=Le(),S=Oe(),f=xe(),[T,_]=De(),[M,O]=i.useState(""),[I,c]=i.useState([]),[B,l]=i.useState(null),r=i.useRef(null),[x,w]=i.useState(null),[h,z]=i.useState("my"),Y=i.useRef(null),[q,Z]=i.useState(0),D=60,W=5,s=(b==null?void 0:b.role)==="owner"||(b==null?void 0:b.role)==="admin",u=k("matters:delete"),y=i.useMemo(()=>{const t=j.filter(a=>a.active).map(a=>({value:a.value,label:a.label}));return[{value:"all",label:"All Types"},...t]},[j]);i.useEffect(()=>{function t(a){r.current&&!r.current.contains(a.target)&&l(null)}return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]),i.useEffect(()=>{C({view:h}),R(),Pe.getAttorneys().then(t=>c(t.attorneys||[])).catch(t=>console.log("Could not fetch attorneys:",t))},[h]);const[F,Ce]=i.useState("active"),[U,Ne]=i.useState("all"),[Se,V]=i.useState(!1),[we,ie]=i.useState(!1),[_e,re]=i.useState(!1),[ee,Ae]=i.useState(()=>Mt(ge)),[oe,X]=i.useState(!1),te=i.useRef(null);i.useEffect(()=>{function t(a){te.current&&!te.current.contains(a.target)&&X(!1)}return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const J=i.useMemo(()=>ee.filter(t=>t.visible).sort((t,a)=>t.order-a.order),[ee]),[se,E]=i.useState({isOpen:!1,matterId:"",matterName:"",action:"delete"});i.useEffect(()=>{const t=T.get("action"),a=T.get("clientId");t==="new"&&(V(!0),a&&w(a),_({}))},[T,_]);const P=async(t,a)=>{try{await m(t,{status:a}),l(null),C()}catch(A){console.error("Failed to update matter status:",A),f.error("Failed to update matter status")}},ke=async t=>{try{await g(t),E({isOpen:!1,matterId:"",matterName:"",action:"delete"}),l(null),C()}catch(a){console.error("Failed to delete matter:",a),f.error("Failed to delete matter")}},Te=async()=>{const{action:t,matterId:a}=se;switch(t){case"delete":await ke(a);break;case"archive":await P(a,"closed_other"),E({isOpen:!1,matterId:"",matterName:"",action:"delete"});break;case"hold":await P(a,"on_hold"),E({isOpen:!1,matterId:"",matterName:"",action:"delete"});break;case"reactivate":await P(a,"active"),E({isOpen:!1,matterId:"",matterName:"",action:"delete"});break}},K=(t,a,A)=>{E({isOpen:!0,matterId:t,matterName:a,action:A}),l(null)},Me=()=>{const{action:t,matterName:a}=se;switch(t){case"delete":return{title:"Delete Matter",message:`Are you sure you want to delete "${a}"? This action cannot be undone and will remove all associated time entries, documents, and invoices.`,confirmText:"Delete Matter",type:"danger"};case"archive":return{title:"Archive Matter",message:`Are you sure you want to archive "${a}"? The matter will be closed and moved to your archives.`,confirmText:"Archive Matter",type:"warning"};case"hold":return{title:"Put on Hold",message:`Are you sure you want to put "${a}" on hold? No work should be done on this matter until it's reactivated.`,confirmText:"Put on Hold",type:"warning"};case"reactivate":return{title:"Reactivate Matter",message:`Are you sure you want to reactivate "${a}"? The matter will be moved back to active status.`,confirmText:"Reactivate",type:"success"};default:return{title:"Confirm Action",message:"Are you sure you want to proceed?",confirmText:"Confirm",type:"info"}}},H=i.useMemo(()=>v.filter(t=>{const a=(t.name||"").toLowerCase().includes(M.toLowerCase())||(t.number||"").toLowerCase().includes(M.toLowerCase()),A=F==="all"||t.status===F,Q=U==="all"||(t.type||"other")===U;return a&&A&&Q}).sort((t,a)=>new Date(a.createdAt||0).getTime()-new Date(t.createdAt||0).getTime()),[v,M,F,U]),Ie=Math.ceil(600/D)+W*2,ne=Math.max(0,Math.floor(q/D)-W),ce=Math.min(H.length,ne+Ie),Be=h==="all"?H.slice(ne,ce):H,de=h==="all"?ne*D:0,ue=h==="all"?Math.max(0,(H.length-ce)*D):0,Re=i.useCallback(t=>{h==="all"&&Z(t.currentTarget.scrollTop)},[h]),ze=t=>{var a;return((a=p.find(A=>A.id===t))==null?void 0:a.name)||"Unknown Client"};return e.jsxs("div",{className:n.page,children:[e.jsxs("div",{className:n.header,children:[e.jsxs("div",{className:n.headerLeft,children:[e.jsx("h1",{children:h==="my"?"My Matters":"All Matters"}),e.jsxs("span",{className:n.count,children:[v.length," total"]})]}),e.jsx("div",{className:n.headerActions,children:e.jsxs("button",{className:n.primaryBtn,onClick:()=>V(!0),children:[e.jsx(Ve,{size:18}),"New Matter"]})})]}),e.jsxs("div",{className:n.filters,children:[e.jsx("div",{className:n.viewToggle,children:zt(s).map(t=>e.jsxs("button",{className:L(n.viewToggleBtn,h===t.value&&n.active),onClick:()=>z(t.value),children:[t.value==="my"?e.jsx(ae,{size:14}):e.jsx(G,{size:14}),t.label]},t.value))}),e.jsxs("div",{className:n.searchBox,children:[e.jsx(je,{size:18}),e.jsx("input",{type:"text",placeholder:"Search matters...",value:M,onChange:t=>O(t.target.value)})]}),e.jsx("select",{value:F,onChange:t=>Ce(t.target.value),className:n.filterSelect,children:Rt.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),e.jsx("select",{value:U,onChange:t=>Ne(t.target.value),className:n.filterSelect,children:y.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),e.jsxs("div",{className:n.menuWrapper,ref:te,children:[e.jsx("button",{className:n.settingsBtn,onClick:()=>X(!oe),title:"Settings",children:e.jsx(ve,{size:16})}),oe&&e.jsxs("div",{className:n.dropdown,children:[e.jsxs("button",{className:n.dropdownItem,onClick:()=>{re(!0),X(!1)},children:[e.jsx(Xe,{size:14}),"Column Settings"]}),e.jsxs("button",{className:n.dropdownItem,onClick:()=>{ie(!0),X(!1)},children:[e.jsx(G,{size:14}),"Manage Matter Types"]})]})]})]}),e.jsxs("div",{ref:Y,className:n.tableContainer,onScroll:Re,children:[e.jsxs("table",{className:n.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[J.map(t=>e.jsx("th",{children:t.label},t.id)),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[de>0&&e.jsx("tr",{style:{height:de},"aria-hidden":"true",children:e.jsx("td",{colSpan:J.length+1,style:{padding:0,border:"none"}})}),Be.map(t=>e.jsxs("tr",{children:[J.map(a=>{var A,Q,me;switch(a.id){case"matter":return e.jsx("td",{children:e.jsxs(he,{to:`/app/matters/${t.id}`,className:n.nameCell,children:[e.jsx("div",{className:n.icon,children:e.jsx(G,{size:16})}),e.jsxs("div",{children:[e.jsx("span",{className:n.name,children:t.name}),e.jsx("span",{className:n.subtitle,children:t.number})]}),t.aiSummary&&e.jsx("span",{className:n.aiTag,children:e.jsx(Je,{size:12})})]})},a.id);case"client":return e.jsx("td",{children:e.jsx(he,{to:`/app/clients/${t.clientId}`,className:n.link,children:ze(t.clientId)})},a.id);case"responsibleAttorney":return e.jsx("td",{children:t.responsibleAttorney?e.jsx("span",{className:n.attorneyName,children:((A=I.find($=>$.id===t.responsibleAttorney))==null?void 0:A.name)||"Assigned"}):e.jsx("span",{className:n.unassigned,children:"Unassigned"})},a.id);case"type":return e.jsx("td",{children:e.jsx("span",{className:n.typeTag,children:(t.type||"other").replace(/_/g," ")})},a.id);case"status":return e.jsx("td",{children:e.jsxs("select",{className:L(n.statusSelect,n[t.status]),value:t.status,onChange:$=>P(t.id,$.target.value),onClick:$=>$.stopPropagation(),children:[e.jsx("option",{value:"intake",children:"Intake"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"on_hold",children:"On Hold"}),e.jsx("option",{value:"closed",children:"Closed"}),e.jsx("option",{value:"closed_won",children:"Closed - Won"}),e.jsx("option",{value:"closed_lost",children:"Closed - Lost"}),e.jsx("option",{value:"closed_settled",children:"Closed - Settled"}),e.jsx("option",{value:"closed_other",children:"Closed - Other"})]})},a.id);case"billing":return e.jsx("td",{children:e.jsxs("div",{className:n.billingInfo,children:[t.billingType==="hourly"&&e.jsxs(e.Fragment,{children:["$",t.billingRate,"/hr"]}),t.billingType==="flat"&&e.jsxs(e.Fragment,{children:["$",(Q=t.flatFee)==null?void 0:Q.toLocaleString()," flat"]}),t.billingType==="contingency"&&e.jsxs(e.Fragment,{children:[t.contingencyPercent,"% contingency"]}),t.billingType==="retainer"&&e.jsxs(e.Fragment,{children:["$",(me=t.retainerAmount)==null?void 0:me.toLocaleString()," retainer"]})]})},a.id);case"opened":return e.jsx("td",{className:n.dateCell,children:t.openDate?nt(at(t.openDate),"MMM d, yyyy"):"—"},a.id);default:return null}}),e.jsx("td",{children:e.jsxs("div",{className:n.menuWrapper,ref:B===t.id?r:null,children:[e.jsx("button",{className:n.menuBtn,onClick:()=>l(B===t.id?null:t.id),children:e.jsx(Ke,{size:16})}),B===t.id&&e.jsxs("div",{className:n.dropdown,children:[e.jsxs("button",{className:n.dropdownItem,onClick:()=>{l(null),S(`/app/matters/${t.id}`)},children:[e.jsx(fe,{size:14}),"View Details"]}),t.status==="active"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:n.dropdownItem,onClick:()=>K(t.id,t.name,"hold"),children:[e.jsx(Qe,{size:14}),"Put On Hold"]}),e.jsxs("button",{className:L(n.dropdownItem,n.success),onClick:()=>P(t.id,"closed_won"),children:[e.jsx(be,{size:14}),"Close - Won"]})]}),t.status==="on_hold"&&e.jsxs("button",{className:n.dropdownItem,onClick:()=>K(t.id,t.name,"reactivate"),children:[e.jsx(G,{size:14}),"Reactivate"]}),!t.status.startsWith("closed")&&e.jsxs("button",{className:n.dropdownItem,onClick:()=>K(t.id,t.name,"archive"),children:[e.jsx(Ye,{size:14}),"Archive / Close"]}),u&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:n.dropdownDivider}),e.jsxs("button",{className:L(n.dropdownItem,n.danger),onClick:()=>K(t.id,t.name,"delete"),children:[e.jsx(qe,{size:14}),"Delete Matter"]})]})]})]})})]},t.id)),ue>0&&e.jsx("tr",{style:{height:ue},"aria-hidden":"true",children:e.jsx("td",{colSpan:J.length+1,style:{padding:0,border:"none"}})})]})]}),H.length===0&&e.jsxs("div",{className:n.emptyState,children:[e.jsx(G,{size:48}),e.jsx("h3",{children:"No matters found"}),e.jsx("p",{children:"Try adjusting your search or filters"})]})]}),Se&&e.jsx(Ot,{onClose:()=>{V(!1),w(null)},onSave:async t=>{try{await N(t),V(!1),w(null),C()}catch(a){console.error("Failed to create matter:",a),f.error("Failed to create matter","Please try again.")}},clients:p,attorneys:I,isAdmin:s,prefilledClientId:x,typeOptions:y.filter(t=>t.value!=="all")}),e.jsx(st,{isOpen:se.isOpen,onClose:()=>E({isOpen:!1,matterId:"",matterName:"",action:"delete"}),onConfirm:Te,...Me()}),e.jsx($e,{isOpen:we,onClose:()=>ie(!1)}),e.jsx(Bt,{isOpen:_e,onClose:()=>re(!1),columns:ee,onSave:Ae,storageKey:ge})]})}function Ot({onClose:v,onSave:p,clients:N,attorneys:C,isAdmin:R,prefilledClientId:m,typeOptions:g}){const j=xe(),[b,k]=i.useState(!1),[o,S]=i.useState({name:"",description:"",clientId:m||"",type:g.length>0?g[0].value:"other",status:"active",priority:"medium",billingType:"hourly",billingRate:450,openDate:new Date().toISOString(),responsibleAttorney:"",originatingAttorney:"",tags:[]}),[f,T]=i.useState([]),[_,M]=i.useState(""),[O,I]=i.useState(0),[c,B]=i.useState(null),[l,r]=i.useState(!1),[x,w]=i.useState(!1),[h,z]=i.useState(""),Y=()=>{if(!_)return;const s=C.find(u=>u.id===_);if(s){if(f.some(u=>u.userId===_)){j.warning("This attorney is already assigned");return}T([...f,{userId:s.id,name:s.name,billingRate:O||s.hourlyRate||0}]),M(""),I(0)}},q=s=>{T(f.filter(u=>u.userId!==s))},Z=(s,u)=>{T(f.map(y=>y.userId===s?{...y,billingRate:u}:y))},D=async()=>{const s=N.find(y=>y.id===o.clientId),u=(s==null?void 0:s.name)||(s==null?void 0:s.displayName)||o.name;if(!u&&!h){j.warning("Please enter a client or matter name to check for conflicts");return}r(!0),B(null),w(!1);try{const y=h?[h]:[],F=await He.checkConflicts({clientName:u||void 0,partyNames:y,matterName:o.name||void 0});B(F)}catch(y){console.error("Conflict check failed:",y),j.error("Failed to run conflict check")}finally{r(!1)}},W=async s=>{var u;if(s.preventDefault(),!b){if(((u=c==null?void 0:c.summary)==null?void 0:u.high)>0&&!x){j.warning("Please acknowledge the conflict warnings before proceeding");return}k(!0);try{await p({...o,name:o.name||"Untitled Matter",clientId:o.clientId||void 0,responsibleAttorney:o.responsibleAttorney||void 0,originatingAttorney:o.originatingAttorney||void 0,teamAssignments:R?f:void 0,conflictCleared:c?!c.hasConflicts||x:!1})}finally{k(!1)}}};return e.jsx("div",{className:n.modalOverlay,onClick:v,children:e.jsxs("div",{className:n.modal,onClick:s=>s.stopPropagation(),style:{maxWidth:"600px"},children:[e.jsxs("div",{className:n.modalHeader,children:[e.jsx("h2",{children:"New Matter"}),e.jsx("button",{onClick:v,className:n.closeBtn,children:"×"})]}),e.jsxs("form",{onSubmit:W,className:n.modalForm,children:[e.jsxs("div",{className:n.formGroup,children:[e.jsx("label",{children:"Matter Name (optional)"}),e.jsx("input",{type:"text",value:o.name,onChange:s=>S({...o,name:s.target.value}),placeholder:"Enter matter name"})]}),e.jsxs("div",{className:n.formRow,children:[e.jsxs("div",{className:n.formGroup,children:[e.jsx("label",{children:"Client"}),e.jsxs("select",{value:o.clientId,onChange:s=>S({...o,clientId:s.target.value}),children:[e.jsx("option",{value:"",children:"Select a client (optional)"}),N.map(s=>e.jsx("option",{value:s.id,children:s.name||s.displayName},s.id))]})]}),e.jsxs("div",{className:n.formGroup,children:[e.jsx("label",{children:"Type"}),e.jsx("select",{value:o.type,onChange:s=>S({...o,type:s.target.value}),children:g.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:n.formRow,children:[e.jsxs("div",{className:n.formGroup,children:[e.jsx("label",{children:"Responsible Attorney"}),e.jsxs("select",{value:o.responsibleAttorney,onChange:s=>S({...o,responsibleAttorney:s.target.value}),children:[e.jsx("option",{value:"",children:"Select responsible attorney..."}),C.map(s=>e.jsxs("option",{value:s.id,children:[s.name," ",s.role?`(${s.role})`:""]},s.id))]})]}),e.jsxs("div",{className:n.formGroup,children:[e.jsx("label",{children:"Originating Attorney"}),e.jsxs("select",{value:o.originatingAttorney,onChange:s=>S({...o,originatingAttorney:s.target.value}),children:[e.jsx("option",{value:"",children:"Select originating attorney..."}),C.map(s=>e.jsxs("option",{value:s.id,children:[s.name," ",s.role?`(${s.role})`:""]},s.id))]})]})]}),e.jsxs("div",{className:n.formRow,children:[e.jsxs("div",{className:n.formGroup,children:[e.jsx("label",{children:"Billing Type"}),e.jsxs("select",{value:o.billingType,onChange:s=>S({...o,billingType:s.target.value}),children:[e.jsx("option",{value:"hourly",children:"Hourly"}),e.jsx("option",{value:"flat",children:"Flat Fee"}),e.jsx("option",{value:"contingency",children:"Contingency"}),e.jsx("option",{value:"retainer",children:"Retainer"})]})]}),e.jsxs("div",{className:n.formGroup,children:[e.jsx("label",{children:"Default Rate/Amount"}),e.jsx("input",{type:"number",value:o.billingRate,onChange:s=>S({...o,billingRate:Number(s.target.value)})})]})]}),e.jsxs("div",{className:n.formGroup,children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{value:o.description,onChange:s=>S({...o,description:s.target.value}),placeholder:"Brief description of the matter",rows:3})]}),e.jsxs("div",{className:n.formGroup,style:{background:"rgba(245, 158, 11, 0.05)",border:"1px solid rgba(245, 158, 11, 0.2)",borderRadius:"8px",padding:"16px",marginTop:"8px"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[e.jsx(Ze,{size:16,style:{color:"#F59E0B"}}),"Conflict Check"]}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[e.jsx("input",{type:"text",value:h,onChange:s=>z(s.target.value),placeholder:"Opposing party name (optional)",style:{flex:1}}),e.jsx("button",{type:"button",onClick:D,disabled:l,style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 16px",background:"var(--apex-gold)",border:"none",borderRadius:"6px",color:"var(--apex-midnight)",fontWeight:600,fontSize:"0.875rem",cursor:"pointer",whiteSpace:"nowrap"},children:l?e.jsxs(e.Fragment,{children:[e.jsx(et,{size:14,className:"spinning"})," Checking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(je,{size:14})," Check Conflicts"]})})]}),c&&e.jsxs("div",{style:{marginTop:"12px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px 14px",borderRadius:"6px",marginBottom:"12px",background:c.summary.high>0?"rgba(239, 68, 68, 0.15)":c.summary.medium>0?"rgba(245, 158, 11, 0.15)":"rgba(16, 185, 129, 0.15)",border:`1px solid ${c.summary.high>0?"rgba(239, 68, 68, 0.3)":c.summary.medium>0?"rgba(245, 158, 11, 0.3)":"rgba(16, 185, 129, 0.3)"}`},children:[c.summary.high>0?e.jsx(pe,{size:18,style:{color:"#EF4444"}}):c.summary.medium>0?e.jsx(pe,{size:18,style:{color:"#F59E0B"}}):e.jsx(be,{size:18,style:{color:"#10B981"}}),e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:500,color:c.summary.high>0?"#EF4444":c.summary.medium>0?"#F59E0B":"#10B981"},children:c.recommendation})]}),c.conflicts.length>0&&e.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto",display:"flex",flexDirection:"column",gap:"8px"},children:[c.conflicts.slice(0,10).map((s,u)=>e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px",padding:"10px 12px",background:"rgba(0,0,0,0.2)",borderRadius:"6px",borderLeft:`3px solid ${s.severity==="high"?"#EF4444":s.severity==="medium"?"#F59E0B":"#64748B"}`},children:[s.matchType==="client"?e.jsx(ae,{size:14,style:{marginTop:"2px",flexShrink:0,color:"#94A3B8"}}):e.jsx(tt,{size:14,style:{marginTop:"2px",flexShrink:0,color:"#94A3B8"}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{fontSize:"0.8125rem",fontWeight:500,color:"var(--apex-light)"},children:[s.matchName,s.role&&e.jsx("span",{style:{marginLeft:"8px",fontSize:"0.6875rem",padding:"2px 6px",background:"rgba(255,255,255,0.1)",borderRadius:"4px",textTransform:"uppercase"},children:s.role})]}),e.jsx("div",{style:{fontSize:"0.75rem",color:"#94A3B8",marginTop:"2px"},children:s.description})]})]},u)),c.conflicts.length>10&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"#64748B",textAlign:"center",padding:"8px"},children:["+ ",c.conflicts.length-10," more results"]})]}),c.hasConflicts&&e.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginTop:"12px",padding:"10px 12px",background:"rgba(0,0,0,0.2)",borderRadius:"6px",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:x,onChange:s=>w(s.target.checked),style:{marginTop:"2px",accentColor:"var(--apex-gold)"}}),e.jsx("span",{style:{fontSize:"0.8125rem",color:"var(--apex-light)"},children:"I have reviewed the potential conflicts and confirm it is appropriate to proceed with this matter"})]})]}),!c&&e.jsx("p",{style:{fontSize:"0.75rem",color:"#64748B",margin:0},children:"Run a conflict check to search for existing clients and matter parties that may create a conflict of interest."})]}),R&&e.jsxs("div",{className:n.formGroup,children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(ae,{size:16}),"Assign Team Members"]}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[e.jsxs("select",{value:_,onChange:s=>{M(s.target.value);const u=C.find(y=>y.id===s.target.value);u&&I(u.hourlyRate||0)},style:{flex:2},children:[e.jsx("option",{value:"",children:"Select attorney..."}),C.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.role,")"]},s.id))]}),e.jsx("input",{type:"number",placeholder:"Rate",value:O||"",onChange:s=>I(Number(s.target.value)),style:{flex:1,width:"100px"}}),e.jsx("button",{type:"button",onClick:Y,className:n.saveBtn,style:{padding:"8px 16px"},disabled:!_,children:"Add"})]}),f.length>0&&e.jsx("div",{style:{border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px",overflow:"hidden"},children:f.map((s,u)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"10px 12px",borderBottom:u<f.length-1?"1px solid rgba(255,255,255,0.1)":"none",background:"rgba(255,255,255,0.02)"},children:[e.jsx("span",{style:{flex:1},children:s.name}),e.jsx("span",{style:{color:"#94A3B8",fontSize:"14px"},children:"$"}),e.jsx("input",{type:"number",value:s.billingRate,onChange:y=>Z(s.userId,Number(y.target.value)),style:{width:"80px",padding:"4px 8px"}}),e.jsx("span",{style:{color:"#94A3B8",fontSize:"14px"},children:"/hr"}),e.jsx("button",{type:"button",onClick:()=>q(s.userId),style:{background:"transparent",border:"none",cursor:"pointer",color:"#EF4444",padding:"4px"},children:e.jsx(ye,{size:16})})]},s.userId))}),f.length===0&&e.jsx("p",{style:{color:"#64748B",fontSize:"14px",margin:"8px 0"},children:"No team members assigned yet. Add attorneys above."})]}),e.jsxs("div",{className:n.modalActions,children:[e.jsx("button",{type:"button",onClick:v,className:n.cancelBtn,disabled:b,children:"Cancel"}),e.jsx("button",{type:"submit",className:n.saveBtn,disabled:b,children:b?"Creating...":"Create Matter"})]})]})]})})}export{Kt as MattersPage};
