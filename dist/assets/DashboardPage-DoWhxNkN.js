import{r as d,a6 as e,h as he}from"./vendor-DrKzkH4x.js";import{a as ye,L as P}from"./router-CNLU_KyZ.js";import{u as ie,a as Le,b as Pe,c as Ee,d as He,e as Oe,f as be,s as Ge}from"./index-CCWWoMiH.js";import{y as ce,a0 as $e,a2 as Ve,x as te,K as qe,S as U,X as ae,b as fe,am as ue,f as pe,t as _e,ag as ne,an as Ue,J as Y,D as X,a as Ye,z as ve,ao as We,aa as xe,ab as Je,n as Ke,Q as Qe,F as Z,ap as Xe}from"./icons-BtUkkwGS.js";import{p as je}from"./dateUtils-Bq7Z0P5c.js";import{s as Ze,e as es,p as D,i as ge,f as z}from"./date-utils-BkNAU8cl.js";import{R as ee,A as ss,X as Ne,Y as ke,T as se,a as ts,P as as,b as ns,C as is,B as cs,c as rs,d as ls}from"./charts-CBxIs53B.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";import"./state-72d44OIA.js";const os="_welcomeCard_5jlc9_2",ds="_welcomeIcon_5jlc9_25",ms="_closeBtn_5jlc9_37",hs="_progressBar_5jlc9_55",us="_progressFill_5jlc9_63",ps="_progressText_5jlc9_70",_s="_quickSteps_5jlc9_75",vs="_quickStep_5jlc9_75",xs="_complete_5jlc9_115",js="_welcomeActions_5jlc9_124",gs="_expandBtn_5jlc9_129",Ns="_skipBtn_5jlc9_147",ks="_overlay_5jlc9_163",ys="_wizard_5jlc9_180",bs="_wizardHeader_5jlc9_204",fs="_wizardContent_5jlc9_216",Cs="_stepsList_5jlc9_222",Is="_stepItem_5jlc9_231",Ss="_current_5jlc9_252",Bs="_stepIcon_5jlc9_261",ws="_stepTitle_5jlc9_282",As="_checkIcon_5jlc9_286",Ts="_stepDetail_5jlc9_290",Ds="_stepDetailIcon_5jlc9_299",zs="_actionBtn_5jlc9_327",Ms="_stepNavigation_5jlc9_348",Fs="_navBtn_5jlc9_353",Rs="_wizardFooter_5jlc9_377",Ls="_completeBtn_5jlc9_384",i={welcomeCard:os,welcomeIcon:ds,closeBtn:ms,progressBar:hs,progressFill:us,progressText:ps,quickSteps:_s,quickStep:vs,complete:xs,welcomeActions:js,expandBtn:gs,skipBtn:Ns,overlay:ks,wizard:ys,wizardHeader:bs,wizardContent:fs,stepsList:Cs,stepItem:Is,current:Ss,stepIcon:Bs,stepTitle:ws,checkIcon:As,stepDetail:Ts,stepDetailIcon:Ds,actionBtn:zs,stepNavigation:Ms,navBtn:Fs,wizardFooter:Rs,completeBtn:Ls},b=[{id:"profile",title:"Complete Your Profile",description:"Add your name, photo, and contact information",icon:ce,action:"Update Profile",actionPath:"/app/settings/profile"},{id:"firm",title:"Set Up Your Firm",description:"Configure firm name, logo, and practice areas",icon:$e,action:"Firm Settings",actionPath:"/app/settings/firm"},{id:"integrations",title:"Connect Your Tools",description:"Link Outlook, QuickBooks, OneDrive, and more",icon:Ve,action:"View Integrations",actionPath:"/app/settings/integrations"},{id:"matter",title:"Create Your First Matter",description:"Set up a client and matter to start tracking work",icon:te,action:"Create Matter",actionPath:"/app/matters"},{id:"documents",title:"Upload Documents",description:"Add documents to your Apex Drive",icon:qe,action:"Go to Documents",actionPath:"/app/documents"},{id:"ai",title:"Try the AI Assistant",description:"Ask a question or run a background task",icon:U,action:"Open AI Assistant",actionPath:"/app/ai"}];function Ps({onClose:c,onComplete:o}){const v=ye(),{user:r}=ie(),[p,_]=d.useState(0),[j,M]=d.useState(new Set),[I,l]=d.useState(!1);d.useEffect(()=>{const a=localStorage.getItem(`onboarding-${r==null?void 0:r.id}`);if(a)try{const u=JSON.parse(a);M(new Set(u.completed||[]))}catch{}},[r==null?void 0:r.id]);const N=a=>{const u=new Set(j);u.add(a),M(u),localStorage.setItem(`onboarding-${r==null?void 0:r.id}`,JSON.stringify({completed:Array.from(u)}))},F=a=>{N(a.id),a.actionPath&&(v(a.actionPath),c())},R=()=>{localStorage.setItem(`onboarding-${r==null?void 0:r.id}`,JSON.stringify({completed:b.map(a=>a.id),skipped:!0})),c()},f=Math.round(j.size/b.length*100),x=b[p];return I?e.jsx("div",{className:i.overlay,children:e.jsxs("div",{className:i.wizard,children:[e.jsx("button",{className:i.closeBtn,onClick:c,children:e.jsx(ae,{size:20})}),e.jsxs("div",{className:i.wizardHeader,children:[e.jsx("h2",{children:"Getting Started"}),e.jsx("div",{className:i.progressBar,children:e.jsx("div",{className:i.progressFill,style:{width:`${f}%`}})}),e.jsxs("span",{className:i.progressText,children:[f,"% complete"]})]}),e.jsxs("div",{className:i.wizardContent,children:[e.jsx("div",{className:i.stepsList,children:b.map((a,u)=>{const k=a.icon,S=j.has(a.id),O=u===p;return e.jsxs("button",{className:he(i.stepItem,S&&i.complete,O&&i.current),onClick:()=>_(u),children:[e.jsx("div",{className:i.stepIcon,children:S?e.jsx(_e,{size:16}):e.jsx(k,{size:16})}),e.jsx("span",{className:i.stepTitle,children:a.title}),S&&e.jsx(ue,{size:14,className:i.checkIcon})]},a.id)})}),e.jsxs("div",{className:i.stepDetail,children:[e.jsx("div",{className:i.stepDetailIcon,children:e.jsx(x.icon,{size:40})}),e.jsx("h3",{children:x.title}),e.jsx("p",{children:x.description}),x.action&&e.jsxs("button",{className:i.actionBtn,onClick:()=>F(x),children:[x.action,e.jsx(ne,{size:16})]}),e.jsxs("div",{className:i.stepNavigation,children:[e.jsxs("button",{className:i.navBtn,onClick:()=>_(Math.max(0,p-1)),disabled:p===0,children:[e.jsx(Ue,{size:16}),"Previous"]}),e.jsxs("button",{className:i.navBtn,onClick:()=>_(Math.min(b.length-1,p+1)),disabled:p===b.length-1,children:["Next",e.jsx(pe,{size:16})]})]})]})]}),e.jsxs("div",{className:i.wizardFooter,children:[e.jsx("button",{className:i.skipBtn,onClick:R,children:"Skip Setup"}),j.size===b.length&&e.jsxs("button",{className:i.completeBtn,onClick:()=>{o==null||o(),c()},children:[e.jsx(_e,{size:16}),"All Done!"]})]})]})}):e.jsxs("div",{className:i.welcomeCard,children:[e.jsx("button",{className:i.closeBtn,onClick:c,children:e.jsx(ae,{size:18})}),e.jsx("div",{className:i.welcomeIcon,children:e.jsx(fe,{size:28})}),e.jsx("h2",{children:"Welcome to Apex Legal! ðŸ‘‹"}),e.jsx("p",{children:"Let's get you set up. Complete these quick steps to get the most out of your practice management."}),e.jsx("div",{className:i.progressBar,children:e.jsx("div",{className:i.progressFill,style:{width:`${f}%`}})}),e.jsxs("span",{className:i.progressText,children:[j.size," of ",b.length," steps complete"]}),e.jsx("div",{className:i.quickSteps,children:b.slice(0,3).map(a=>{const u=a.icon,k=j.has(a.id);return e.jsxs("button",{className:he(i.quickStep,k&&i.complete),onClick:()=>F(a),children:[k?e.jsx(ue,{size:18}):e.jsx(u,{size:18}),e.jsx("span",{children:a.title}),e.jsx(pe,{size:14})]},a.id)})}),e.jsxs("div",{className:i.welcomeActions,children:[e.jsx("button",{className:i.expandBtn,onClick:()=>l(!0),children:"View All Steps"}),e.jsx("button",{className:i.skipBtn,onClick:R,children:"I'll explore on my own"})]})]})}function Es(){const{user:c}=ie(),[o,v]=d.useState(!1);return d.useEffect(()=>{var p;if(!(c!=null&&c.id))return;const r=localStorage.getItem(`onboarding-${c.id}`);if(!r)v(!0);else try{const _=JSON.parse(r);!_.skipped&&((p=_.completed)==null?void 0:p.length)<6&&v(!0)}catch{}},[c==null?void 0:c.id]),{shouldShow:o,setShouldShow:v}}const Hs="_dashboard_15ksv_1",Os="_fadeIn_15ksv_1",Gs="_welcome_15ksv_9",$s="_greeting_15ksv_17",Vs="_date_15ksv_25",qs="_aiPrompt_15ksv_30",Us="_statsGrid_15ksv_51",Ys="_statCard_15ksv_57",Ws="_statIcon_15ksv_73",Js="_statContent_15ksv_83",Ks="_statValue_15ksv_88",Qs="_statLabel_15ksv_95",Xs="_timerSection_15ksv_102",Zs="_activeTimer_15ksv_109",et="_activeTimerInfo_15ksv_120",st="_timerPulse_15ksv_126",tt="_pulse_15ksv_1",at="_timerDetails_15ksv_143",nt="_timerMatterName_15ksv_148",it="_timerElapsed_15ksv_154",ct="_timerActions_15ksv_161",rt="_pauseBtn_15ksv_167",lt="_resumeBtn_15ksv_167",ot="_stopBtn_15ksv_200",dt="_discardBtn_15ksv_219",mt="_quickTimer_15ksv_237",ht="_quickTimerHeader_15ksv_244",ut="_matterButtons_15ksv_267",pt="_matterTimerBtn_15ksv_273",_t="_viewMoreBtn_15ksv_297",vt="_timerClientName_15ksv_312",xt="_timerSelects_15ksv_317",jt="_timerSelect_15ksv_317",gt="_startTimerBtn_15ksv_362",Nt="_modalOverlay_15ksv_391",kt="_modal_15ksv_391",yt="_slideUp_15ksv_1",bt="_modalHeader_15ksv_413",ft="_closeBtn_15ksv_434",Ct="_modalForm_15ksv_448",It="_timerSummary_15ksv_454",St="_timerSummaryItem_15ksv_465",Bt="_formGroup_15ksv_474",wt="_formRow_15ksv_546",At="_clientInfo_15ksv_552",Tt="_entryTotal_15ksv_567",Dt="_modalActions_15ksv_578",zt="_cancelBtn_15ksv_584",Mt="_saveBtn_15ksv_606",Ft="_chartsRow_15ksv_639",Rt="_chartCard_15ksv_645",Lt="_cardHeader_15ksv_652",Pt="_cardBadge_15ksv_665",Et="_chartContainer_15ksv_677",Ht="_pieChartContainer_15ksv_681",Ot="_pieLegend_15ksv_687",Gt="_legendItem_15ksv_694",$t="_legendDot_15ksv_700",Vt="_legendLabel_15ksv_707",qt="_legendValue_15ksv_714",Ut="_viewAll_15ksv_720",Yt="_bottomRow_15ksv_731",Wt="_listCard_15ksv_737",Jt="_listContent_15ksv_744",Kt="_listItem_15ksv_749",Qt="_listItemIcon_15ksv_771",Xt="_listItemContent_15ksv_783",Zt="_listItemTitle_15ksv_788",ea="_listItemMeta_15ksv_798",sa="_statusBadge_15ksv_805",ta="_active_15ksv_109",aa="_pending_15ksv_820",na="_intake_15ksv_825",ia="_on_hold_15ksv_830",ca="_closed_15ksv_835",ra="_eventItem_15ksv_841",la="_eventDate_15ksv_853",oa="_eventMonth_15ksv_866",da="_eventDay_15ksv_874",ma="_eventType_15ksv_881",ha="_invoiceItem_15ksv_891",ua="_invoiceAmount_15ksv_903",pa="_amount_15ksv_908",_a="_invoiceStatus_15ksv_915",va="_sent_15ksv_921",xa="_overdue_15ksv_925",ja="_paid_15ksv_929",ga="_aiBanner_15ksv_934",Na="_aiBannerContent_15ksv_944",ka="_aiBannerIcon_15ksv_950",ya="_aiBannerBtn_15ksv_973",ba="_aiActionsSection_15ksv_1173",fa="_aiActionsHeader_15ksv_1181",Ca="_aiActionsGrid_15ksv_1195",Ia="_aiActionCard_15ksv_1201",Sa="_aiActionIcon_15ksv_1223",s={dashboard:Hs,fadeIn:Os,welcome:Gs,greeting:$s,date:Vs,aiPrompt:qs,statsGrid:Us,statCard:Ys,statIcon:Ws,statContent:Js,statValue:Ks,statLabel:Qs,timerSection:Xs,activeTimer:Zs,activeTimerInfo:et,timerPulse:st,pulse:tt,timerDetails:at,timerMatterName:nt,timerElapsed:it,timerActions:ct,pauseBtn:rt,resumeBtn:lt,stopBtn:ot,discardBtn:dt,quickTimer:mt,quickTimerHeader:ht,matterButtons:ut,matterTimerBtn:pt,viewMoreBtn:_t,timerClientName:vt,timerSelects:xt,timerSelect:jt,startTimerBtn:gt,modalOverlay:Nt,modal:kt,slideUp:yt,modalHeader:bt,closeBtn:ft,modalForm:Ct,timerSummary:It,timerSummaryItem:St,formGroup:Bt,formRow:wt,clientInfo:At,entryTotal:Tt,modalActions:Dt,cancelBtn:zt,saveBtn:Mt,chartsRow:Ft,chartCard:Rt,cardHeader:Lt,cardBadge:Pt,chartContainer:Et,pieChartContainer:Ht,pieLegend:Ot,legendItem:Gt,legendDot:$t,legendLabel:Vt,legendValue:qt,viewAll:Ut,bottomRow:Yt,listCard:Wt,listContent:Jt,listItem:Kt,listItemIcon:Qt,listItemContent:Xt,listItemTitle:Zt,listItemMeta:ea,statusBadge:sa,active:ta,pending:aa,intake:na,on_hold:ia,closed:ca,eventItem:ra,eventDate:la,eventMonth:oa,eventDay:da,eventType:ma,invoiceItem:ha,invoiceAmount:ua,amount:pa,invoiceStatus:_a,sent:va,overdue:xa,paid:ja,aiBanner:ga,aiBannerContent:Na,aiBannerIcon:ka,aiBannerBtn:ya,aiActionsSection:ba,aiActionsHeader:fa,aiActionsGrid:Ca,aiActionCard:Ia,aiActionIcon:Sa},q=["#F59E0B","#3B82F6","#10B981","#8B5CF6","#EF4444"];function Ha(){var oe,de,me;const{user:c}=ie(),{matters:o,clients:v,timeEntries:r,invoices:p,events:_,documents:j,fetchMatters:M,fetchClients:I,fetchTimeEntries:l,fetchInvoices:N,fetchEvents:F,fetchDocuments:R,addTimeEntry:f}=Le(),{openChat:x}=Pe(),{timer:a,startTimer:u,pauseTimer:k,resumeTimer:S,stopTimer:O,discardTimer:W}=Ee();He();const[G,re]=d.useState(""),[B,Ce]=d.useState(""),[Ie,J]=d.useState(!1),[E,Se]=d.useState(null),{shouldShow:Be,setShouldShow:we}=Es(),$=ye(),Ae=d.useMemo(()=>B?o.filter(t=>t.status==="active"&&t.clientId===B):o.filter(t=>t.status==="active"),[o,B]),Te=()=>{const t=G?o.find(m=>m.id===G):null,n=B?v.find(m=>m.id===B):null;u({matterId:G||void 0,matterName:t==null?void 0:t.name,clientId:B||void 0,clientName:(n==null?void 0:n.name)||(n==null?void 0:n.displayName)})},De=()=>{O(),J(!0)};d.useEffect(()=>{I(),M(),l({limit:500}),N(),F({}),R(),Oe.getAttorneyProduction().then(t=>{t.success&&Se(t.data)}).catch(t=>console.error("Failed to fetch attorney production:",t))},[]);const L=d.useMemo(()=>{const t=new Date,n=Ze(t),m=es(t),y=o.filter(h=>h.status==="active").length,w=v.filter(h=>h.isActive).length,A=r.filter(h=>{const g=je(h.date);return g>=n&&g<=m}),Q=A.filter(h=>h.billable).reduce((h,g)=>h+g.hours,0),T=A.reduce((h,g)=>h+g.amount,0),C=p.filter(h=>h.status==="sent"||h.status==="overdue").reduce((h,g)=>h+(g.total-g.amountPaid),0),Re=_.filter(h=>{const g=D(h.startTime);return ge(g,t)&&h.type==="deadline"}).length;return{activeMatters:y,totalClients:w,billableHours:Q,monthlyRevenue:T,outstandingAmount:C,upcomingDeadlines:Re}},[o,v,r,p,_]),ze=d.useMemo(()=>[...o].sort((t,n)=>new Date(n.createdAt).getTime()-new Date(t.createdAt).getTime()).slice(0,5),[o]),le=d.useMemo(()=>[...j].sort((t,n)=>new Date(n.uploadedAt||0).getTime()-new Date(t.uploadedAt||0).getTime()).slice(0,5),[j]),Me=d.useMemo(()=>{const t=new Date;return _.filter(n=>ge(D(n.startTime),t)).sort((n,m)=>new Date(n.startTime).getTime()-new Date(m.startTime).getTime()).slice(0,5)},[_]),K=d.useMemo(()=>{const t={};return o.forEach(n=>{t[n.type]=(t[n.type]||0)+1}),Object.entries(t).map(([n,m])=>({name:n.replace(/_/g," "),value:m})).sort((n,m)=>m.value-n.value).slice(0,5)},[o]),V=d.useMemo(()=>{const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=new Date().getFullYear();return t.map((m,y)=>{const w=r.filter(T=>{const C=je(T.date);return C.getMonth()===y&&C.getFullYear()===n}),A=w.reduce((T,C)=>T+(C.amount||0),0),Q=w.reduce((T,C)=>T+(C.hours||0),0);return{month:m,revenue:Math.round(A),hours:Math.round(Q)}})},[r]),H=d.useMemo(()=>{var w,A;const t=new Date().getMonth(),n=t===0?11:t-1,m=((w=V[t])==null?void 0:w.revenue)||0,y=((A=V[n])==null?void 0:A.revenue)||0;return y===0?m>0?100:0:(m-y)/y*100},[V]),Fe=d.useMemo(()=>p.filter(t=>t.status==="sent"||t.status==="overdue").sort((t,n)=>new Date(t.dueDate).getTime()-new Date(n.dueDate).getTime()).slice(0,4),[p]);return e.jsxs("div",{className:s.dashboard,children:[Be&&e.jsx(Ps,{onClose:()=>we(!1)}),e.jsxs("section",{className:s.welcome,children:[e.jsxs("div",{children:[e.jsxs("h1",{className:s.greeting,children:["Good ",new Date().getHours()<12?"morning":new Date().getHours()<17?"afternoon":"evening",", ",c==null?void 0:c.firstName]}),e.jsx("p",{className:s.date,children:z(new Date,"EEEE, MMMM d, yyyy")})]}),e.jsxs("button",{onClick:()=>x({label:"Dashboard",contextType:"dashboard",suggestedQuestions:["Give me a summary of my practice today","What matters need my attention this week?","Analyze my billing and collection trends","What deadlines are coming up?","Summarize my workload by client"]}),className:s.aiPrompt,children:[e.jsx(U,{size:20}),e.jsx("span",{children:"Ask AI Assistant"}),e.jsx(ne,{size:16})]})]}),e.jsxs("section",{className:s.statsGrid,children:[e.jsxs("div",{className:s.statCard,children:[e.jsx("div",{className:s.statIcon,style:{background:"rgba(245, 158, 11, 0.1)",color:"#F59E0B"},children:e.jsx(te,{size:22})}),e.jsxs("div",{className:s.statContent,children:[e.jsx("span",{className:s.statValue,children:L.activeMatters}),e.jsx("span",{className:s.statLabel,children:"Active Matters"})]})]}),e.jsxs("div",{className:s.statCard,children:[e.jsx("div",{className:s.statIcon,style:{background:"rgba(59, 130, 246, 0.1)",color:"#3B82F6"},children:e.jsx(ce,{size:22})}),e.jsxs("div",{className:s.statContent,children:[e.jsx("span",{className:s.statValue,children:L.totalClients}),e.jsx("span",{className:s.statLabel,children:"Active Clients"})]})]}),e.jsxs("div",{className:s.statCard,children:[e.jsx("div",{className:s.statIcon,style:{background:"rgba(16, 185, 129, 0.1)",color:"#10B981"},children:e.jsx(Y,{size:22})}),e.jsxs("div",{className:s.statContent,children:[e.jsx("span",{className:s.statValue,children:L.billableHours.toFixed(1)}),e.jsx("span",{className:s.statLabel,children:"Billable Hours (MTD)"})]})]}),e.jsxs("div",{className:s.statCard,children:[e.jsx("div",{className:s.statIcon,style:{background:"rgba(139, 92, 246, 0.1)",color:"#8B5CF6"},children:e.jsx(X,{size:22})}),e.jsxs("div",{className:s.statContent,children:[e.jsxs("span",{className:s.statValue,children:["$",(L.monthlyRevenue/1e3).toFixed(1),"k"]}),e.jsx("span",{className:s.statLabel,children:"Revenue (MTD)"})]})]}),e.jsxs("div",{className:s.statCard,children:[e.jsx("div",{className:s.statIcon,style:{background:"rgba(239, 68, 68, 0.1)",color:"#EF4444"},children:e.jsx(Ye,{size:22})}),e.jsxs("div",{className:s.statContent,children:[e.jsxs("span",{className:s.statValue,children:["$",(L.outstandingAmount/1e3).toFixed(1),"k"]}),e.jsx("span",{className:s.statLabel,children:"Outstanding"})]})]}),e.jsxs("div",{className:s.statCard,children:[e.jsx("div",{className:s.statIcon,style:{background:"rgba(16, 185, 129, 0.1)",color:"#10B981"},children:e.jsx(ve,{size:22})}),e.jsxs("div",{className:s.statContent,children:[e.jsx("span",{className:s.statValue,children:L.upcomingDeadlines}),e.jsx("span",{className:s.statLabel,children:"Upcoming Deadlines"})]})]})]}),e.jsxs("section",{className:s.aiActionsSection,children:[e.jsxs("div",{className:s.aiActionsHeader,children:[e.jsx(U,{size:18}),e.jsx("h3",{children:"AI Quick Actions"})]}),e.jsxs("div",{className:s.aiActionsGrid,children:[e.jsxs("button",{className:s.aiActionCard,onClick:()=>$("/app/background-agent",{state:{autoStart:"Audit all my active matters and create a status report"}}),children:[e.jsx("div",{className:s.aiActionIcon,style:{background:"rgba(251, 191, 36, 0.1)",color:"#FBBF24"},children:e.jsx(We,{size:18})}),e.jsx("span",{children:"Matter Audit"})]}),e.jsxs("button",{className:s.aiActionCard,onClick:()=>$("/app/background-agent",{state:{autoStart:"Review unbilled time and prepare invoicing recommendations"}}),children:[e.jsx("div",{className:s.aiActionIcon,style:{background:"rgba(34, 197, 94, 0.1)",color:"#22C55E"},children:e.jsx(X,{size:18})}),e.jsx("span",{children:"Billing Review"})]}),e.jsxs("button",{className:s.aiActionCard,onClick:()=>$("/app/background-agent",{state:{autoStart:"Review all upcoming deadlines and flag any that need attention"}}),children:[e.jsx("div",{className:s.aiActionIcon,style:{background:"rgba(239, 68, 68, 0.1)",color:"#EF4444"},children:e.jsx(ve,{size:18})}),e.jsx("span",{children:"Deadline Check"})]}),e.jsxs("button",{className:s.aiActionCard,onClick:()=>$("/app/background-agent"),children:[e.jsx("div",{className:s.aiActionIcon,style:{background:"rgba(139, 92, 246, 0.1)",color:"#8B5CF6"},children:e.jsx(fe,{size:18})}),e.jsx("span",{children:"Open Agent"})]})]})]}),e.jsx("section",{className:s.timerSection,children:a.isRunning||a.elapsed>0?e.jsxs("div",{className:s.activeTimer,children:[e.jsxs("div",{className:s.activeTimerInfo,children:[e.jsx("div",{className:s.timerPulse,children:e.jsx(Y,{size:20})}),e.jsxs("div",{className:s.timerDetails,children:[e.jsxs("span",{className:s.timerMatterName,children:[a.matterName||"General Time",a.clientName&&e.jsxs("span",{className:s.timerClientName,children:[" â€¢ ",a.clientName]})]}),e.jsx("span",{className:s.timerElapsed,children:be(a.elapsed)})]})]}),e.jsxs("div",{className:s.timerActions,children:[a.isPaused?e.jsxs("button",{onClick:S,className:s.resumeBtn,children:[e.jsx(xe,{size:18}),"Resume"]}):a.isRunning?e.jsxs("button",{onClick:k,className:s.pauseBtn,children:[e.jsx(Je,{size:18}),"Pause"]}):null,e.jsxs("button",{onClick:De,className:s.stopBtn,title:"Stop & Save",children:[e.jsx(Ke,{size:18}),"Stop"]}),e.jsx("button",{onClick:W,className:s.discardBtn,title:"Discard",children:e.jsx(ae,{size:18})})]})]}):e.jsxs("div",{className:s.quickTimer,children:[e.jsxs("div",{className:s.quickTimerHeader,children:[e.jsx(Y,{size:16}),e.jsx("h3",{children:"Quick Timer"})]}),e.jsxs("div",{className:s.timerSelects,children:[e.jsxs("select",{value:B,onChange:t=>{Ce(t.target.value),re("")},className:s.timerSelect,children:[e.jsx("option",{value:"",children:"All Clients"}),v.filter(t=>t.isActive).map(t=>e.jsx("option",{value:t.id,children:t.name||t.displayName},t.id))]}),e.jsxs("select",{value:G,onChange:t=>re(t.target.value),className:s.timerSelect,children:[e.jsx("option",{value:"",children:"No matter (general time)"}),Ae.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("button",{className:s.startTimerBtn,onClick:Te,children:[e.jsx(xe,{size:14}),"Start"]})]})]})}),Ie&&e.jsx(Ba,{timer:a,matters:o,clients:v,onClose:()=>{J(!1),W()},onSave:async t=>{try{await f(t),J(!1),W(),await l({limit:500})}catch(n){console.error("Failed to save time entry:",n),alert("Failed to save time entry. Please try again.")}}}),e.jsxs("section",{className:s.chartsRow,children:[e.jsxs("div",{className:s.chartCard,children:[e.jsxs("div",{className:s.cardHeader,children:[e.jsx("h3",{children:"Revenue & Hours"}),H!==0&&e.jsxs("div",{className:s.cardBadge,style:{color:H>=0?"#10B981":"#EF4444"},children:[e.jsx(Qe,{size:14,style:{transform:H<0?"rotate(180deg)":"none"}}),H>=0?"+":"",H.toFixed(1),"%"]})]}),e.jsx("div",{className:s.chartContainer,children:e.jsx(ee,{width:"100%",height:240,children:e.jsxs(ss,{data:V,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"revenueGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#F59E0B",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#F59E0B",stopOpacity:0})]})}),e.jsx(Ne,{dataKey:"month",axisLine:!1,tickLine:!1,tick:{fill:"#64748B",fontSize:12}}),e.jsx(ke,{axisLine:!1,tickLine:!1,tick:{fill:"#64748B",fontSize:12},tickFormatter:t=>`$${t/1e3}k`}),e.jsx(se,{contentStyle:{background:"#1E293B",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px",color:"#F1F5F9"},formatter:t=>[`$${t.toLocaleString()}`,"Revenue"]}),e.jsx(ts,{type:"monotone",dataKey:"revenue",stroke:"#F59E0B",strokeWidth:2,fill:"url(#revenueGradient)"})]})})})]}),e.jsxs("div",{className:s.chartCard,children:[e.jsx("div",{className:s.cardHeader,children:e.jsx("h3",{children:"Matters by Type"})}),e.jsxs("div",{className:s.pieChartContainer,children:[e.jsx(ee,{width:"100%",height:200,children:e.jsxs(as,{children:[e.jsx(ns,{data:K,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:2,dataKey:"value",children:K.map((t,n)=>e.jsx(is,{fill:q[n%q.length]},`cell-${n}`))}),e.jsx(se,{contentStyle:{background:"#1E293B",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px",color:"#F1F5F9"}})]})}),e.jsx("div",{className:s.pieLegend,children:K.map((t,n)=>e.jsxs("div",{className:s.legendItem,children:[e.jsx("span",{className:s.legendDot,style:{background:q[n%q.length]}}),e.jsx("span",{className:s.legendLabel,children:t.name}),e.jsx("span",{className:s.legendValue,children:t.value})]},t.name))})]})]})]}),E&&e.jsx("section",{className:s.chartsRow,children:e.jsxs("div",{className:s.chartCard,style:{flex:1},children:[e.jsxs("div",{className:s.cardHeader,children:[e.jsx("h3",{children:"Production Value by Attorney"}),e.jsxs("span",{style:{fontSize:"13px",color:"var(--text-tertiary)"},children:["Last 12 months â€¢ Total: $",((de=(oe=E.summary)==null?void 0:oe.total_production_value)==null?void 0:de.toLocaleString())||"0"]})]}),e.jsx("div",{className:s.chartContainer,children:((me=E.by_attorney)==null?void 0:me.length)>0?e.jsx(ee,{width:"100%",height:Math.max(240,E.by_attorney.length*40),children:e.jsxs(cs,{data:E.by_attorney,layout:"vertical",margin:{left:10,right:30},children:[e.jsx(rs,{strokeDasharray:"3 3",stroke:"var(--border-primary)"}),e.jsx(Ne,{type:"number",stroke:"var(--text-tertiary)",fontSize:12,tickFormatter:t=>`$${(t/1e3).toFixed(0)}k`}),e.jsx(ke,{type:"category",dataKey:"name",stroke:"var(--text-tertiary)",fontSize:12,width:120,tick:{fill:"var(--text-secondary)"}}),e.jsx(se,{contentStyle:{background:"var(--bg-secondary)",border:"1px solid var(--border-primary)",borderRadius:"8px"},formatter:t=>[`$${t.toLocaleString()}`,"Production Value"]}),e.jsx(ls,{dataKey:"production_value",fill:"#D4AF37",radius:[0,4,4,0],name:"Production Value"})]})}):e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"200px",color:"var(--text-tertiary)",flexDirection:"column",gap:"8px"},children:[e.jsx(X,{size:32}),e.jsx("span",{children:"No billable time entries in the last 12 months"}),e.jsx("span",{style:{fontSize:"12px"},children:"Run Clio migration to import time entries"})]})}),e.jsx("div",{style:{padding:"8px 16px",borderTop:"1px solid var(--border-primary)",fontSize:"12px",color:"var(--text-tertiary)"},children:"Billable Hours Ã— Hourly Rate = Production Value"})]})}),e.jsxs("section",{className:s.bottomRow,children:[e.jsxs("div",{className:s.listCard,children:[e.jsxs("div",{className:s.cardHeader,children:[e.jsx("h3",{children:"Recent Matters"}),e.jsx(P,{to:"/app/matters",className:s.viewAll,children:"View all"})]}),e.jsx("div",{className:s.listContent,children:ze.map(t=>{var n;return e.jsxs(P,{to:`/app/matters/${t.id}`,className:s.listItem,children:[e.jsx("div",{className:s.listItemIcon,children:e.jsx(te,{size:16})}),e.jsxs("div",{className:s.listItemContent,children:[e.jsx("span",{className:s.listItemTitle,children:t.name}),e.jsxs("span",{className:s.listItemMeta,children:[t.number," Â· ",(n=v.find(m=>m.id===t.clientId))==null?void 0:n.name]})]}),e.jsx("span",{className:`${s.statusBadge} ${s[t.status]}`,children:t.status.replace("_"," ")})]},t.id)})})]}),e.jsxs("div",{className:s.listCard,children:[e.jsxs("div",{className:s.cardHeader,children:[e.jsx("h3",{children:"Upcoming Events"}),e.jsx(P,{to:"/app/calendar",className:s.viewAll,children:"View all"})]}),e.jsx("div",{className:s.listContent,children:Me.map(t=>e.jsxs("div",{className:s.eventItem,children:[e.jsxs("div",{className:s.eventDate,style:{borderColor:t.color},children:[e.jsx("span",{className:s.eventMonth,children:z(D(t.startTime),"MMM")}),e.jsx("span",{className:s.eventDay,children:z(D(t.startTime),"d")})]}),e.jsxs("div",{className:s.listItemContent,children:[e.jsx("span",{className:s.listItemTitle,children:t.title}),e.jsxs("span",{className:s.listItemMeta,children:[z(D(t.startTime),"h:mm a"),t.location&&` Â· ${t.location}`]})]}),e.jsx("span",{className:s.eventType,style:{background:`${t.color}20`,color:t.color},children:t.type.replace("_"," ")})]},t.id))})]}),e.jsxs("div",{className:s.listCard,children:[e.jsxs("div",{className:s.cardHeader,children:[e.jsx("h3",{children:"Pending Invoices"}),e.jsx(P,{to:"/app/billing",className:s.viewAll,children:"View all"})]}),e.jsx("div",{className:s.listContent,children:Fe.map(t=>e.jsxs("div",{className:s.invoiceItem,children:[e.jsx("div",{className:s.listItemIcon,children:e.jsx(Z,{size:16})}),e.jsxs("div",{className:s.listItemContent,children:[e.jsx("span",{className:s.listItemTitle,children:t.number}),e.jsxs("span",{className:s.listItemMeta,children:["Due ",z(D(t.dueDate),"MMM d, yyyy")]})]}),e.jsxs("div",{className:s.invoiceAmount,children:[e.jsxs("span",{className:s.amount,children:["$",t.total.toLocaleString()]}),e.jsx("span",{className:`${s.invoiceStatus} ${s[t.status]}`,children:t.status})]})]},t.id))})]}),e.jsxs("div",{className:s.listCard,children:[e.jsxs("div",{className:s.cardHeader,children:[e.jsx("h3",{children:"Recent Documents"}),e.jsx(P,{to:"/app/documents",className:s.viewAll,children:"View all"})]}),e.jsx("div",{className:s.listContent,children:le.length===0?e.jsxs("div",{className:s.emptyState,children:[e.jsx(Z,{size:24,style:{opacity:.5}}),e.jsx("p",{style:{margin:"8px 0 0",opacity:.7,fontSize:"13px"},children:"No documents yet"})]}):le.map(t=>{var m;const n=t.matterId?(m=o.find(y=>y.id===t.matterId))==null?void 0:m.name:null;return e.jsxs(P,{to:"/app/documents",className:s.listItem,children:[e.jsx("div",{className:s.listItemIcon,children:e.jsx(Z,{size:16})}),e.jsxs("div",{className:s.listItemContent,children:[e.jsx("span",{className:s.listItemTitle,children:t.originalName||t.name}),e.jsxs("span",{className:s.listItemMeta,children:[n||"Unassigned"," Â· ",t.uploadedAt?z(D(t.uploadedAt),"MMM d"):""]})]})]},t.id)})})]})]}),e.jsxs("section",{className:s.aiBanner,children:[e.jsxs("div",{className:s.aiBannerContent,children:[e.jsx("div",{className:s.aiBannerIcon,children:e.jsx(U,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{children:"AI-Powered Insights Available"}),e.jsx("p",{children:"Get intelligent analysis of your matters, billing trends, and upcoming deadlines."})]})]}),e.jsxs("button",{onClick:()=>x({label:"AI Insights",contextType:"dashboard",suggestedQuestions:["Analyze my practice performance this month","What are my biggest opportunities for growth?","Which clients generate the most revenue?","Identify any at-risk matters","Suggest ways to improve efficiency"]}),className:s.aiBannerBtn,children:["Open AI Assistant",e.jsx(ne,{size:16})]})]})]})}function Ba({timer:c,matters:o,clients:v,onClose:r,onSave:p}){const[_,j]=d.useState(!1),M=Ge(c.elapsed),I=c.matterId?o.find(a=>a.id===c.matterId):null,[l,N]=d.useState({matterId:c.matterId||"",date:z(new Date,"yyyy-MM-dd"),hours:Math.max(.01,M),description:"",billable:!0,rate:(I==null?void 0:I.billingRate)||450}),F=a=>{const[u,k,S]=a.split("-").map(Number);return new Date(u,k-1,S,12,0,0).toISOString()},R=async a=>{if(a.preventDefault(),!_){j(!0);try{await p({...l,matterId:l.matterId||void 0,date:F(l.date),billed:!1,aiGenerated:!1})}finally{j(!1)}}},f=l.matterId?o.find(a=>a.id===l.matterId):null,x=f?v.find(a=>a.id===f.clientId):null;return e.jsx("div",{className:s.modalOverlay,onClick:r,children:e.jsxs("div",{className:s.modal,onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:s.modalHeader,children:[e.jsxs("h2",{children:[e.jsx(Xe,{size:20}),"Save Time Entry"]}),e.jsx("button",{onClick:r,className:s.closeBtn,children:"Ã—"})]}),e.jsxs("form",{onSubmit:R,className:s.modalForm,children:[e.jsxs("div",{className:s.timerSummary,children:[e.jsxs("div",{className:s.timerSummaryItem,children:[e.jsx(Y,{size:16}),e.jsxs("span",{children:["Timer: ",be(c.elapsed)]})]}),c.matterName&&e.jsx("div",{className:s.timerSummaryItem,children:e.jsxs("span",{children:["Matter: ",c.matterName]})}),c.clientName&&e.jsx("div",{className:s.timerSummaryItem,children:e.jsxs("span",{children:["Client: ",c.clientName]})})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Matter (optional)"}),e.jsxs("select",{value:l.matterId,onChange:a=>{const u=o.find(k=>k.id===a.target.value);N({...l,matterId:a.target.value,rate:(u==null?void 0:u.billingRate)||450})},children:[e.jsx("option",{value:"",children:"No matter selected"}),o.filter(a=>a.status==="active").map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),x&&e.jsxs("div",{className:s.clientInfo,children:[e.jsx(ce,{size:14}),e.jsxs("span",{children:["Client: ",x.name||x.displayName]})]}),e.jsxs("div",{className:s.formRow,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Date"}),e.jsx("input",{type:"date",value:l.date,onChange:a=>N({...l,date:a.target.value})})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Hours"}),e.jsx("input",{type:"number",value:l.hours,onChange:a=>N({...l,hours:parseFloat(a.target.value)}),min:"0.01",step:"0.01"})]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{value:l.description,onChange:a=>N({...l,description:a.target.value}),placeholder:"Describe the work performed...",rows:3})]}),e.jsxs("div",{className:s.formRow,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Rate ($/hr)"}),e.jsx("input",{type:"number",value:l.rate,onChange:a=>N({...l,rate:parseInt(a.target.value)})})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Billable"}),e.jsxs("select",{value:l.billable?"yes":"no",onChange:a=>N({...l,billable:a.target.value==="yes"}),children:[e.jsx("option",{value:"yes",children:"Yes"}),e.jsx("option",{value:"no",children:"No"})]})]})]}),e.jsxs("div",{className:s.entryTotal,children:["Total: $",(l.hours*l.rate).toLocaleString()]}),e.jsxs("div",{className:s.modalActions,children:[e.jsx("button",{type:"button",onClick:r,className:s.cancelBtn,disabled:_,children:"Discard"}),e.jsx("button",{type:"submit",className:s.saveBtn,disabled:_,children:_?"Saving...":"Save Entry"})]})]})]})})}export{Ha as DashboardPage};
