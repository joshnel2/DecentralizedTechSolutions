import{r as n,a6 as e}from"./vendor-DrKzkH4x.js";import{a as H,d as W}from"./router-CNLU_KyZ.js";import{y as l}from"./index-CCWWoMiH.js";import{s}from"./SettingsPage.module-DZhI6nyr.js";import{L as m,al as F,o as N,Z as G,a4 as O,a0 as z,G as x,D as Y,am as M,E as $,bU as U,A as w,t as P,$ as Z,bc as _,F as q}from"./icons-BtUkkwGS.js";import"./doc-parsers-U1nJMjtM.js";import"./react-dom-DfB-QKj2.js";import"./pdf-worker-CVmCB3lP.js";import"./state-72d44OIA.js";function te(){const o=H(),[d]=W(),[T,v]=n.useState(!1),[B,b]=n.useState(!0),[h,p]=n.useState(!1),[S,C]=n.useState(!1),[k,i]=n.useState(null),[t,u]=n.useState(null),[y,j]=n.useState(!1),[a,c]=n.useState({defaultToTrust:!1,trustAccountLabel:"Client Trust Account (IOLTA)",operatingAccountLabel:"Operating Account",acceptCards:!0,acceptAch:!0,acceptApplePay:!1,acceptGooglePay:!1});n.useEffect(()=>{A()},[]),n.useEffect(()=>{const r=d.get("code"),g=d.get("state");if(d.get("error")){i("Connection was cancelled or failed. Please try again."),o("/app/settings/apex-pay",{replace:!0});return}r&&g&&L(r,g)},[d]);const A=async()=>{try{b(!0);const r=await l.getConnectionStatus();r.connected&&r.connection&&(u(r.connection),c(r.connection.settings),j(!!r.connection.complianceAcceptedAt))}catch(r){console.error("Error loading connection status:",r)}finally{b(!1)}},L=async(r,g)=>{try{p(!0),i(null),(await l.handleCallback(r,g)).success&&(await A(),o("/app/settings/apex-pay",{replace:!0}))}catch(f){i(f.message||"Failed to connect Stripe account"),o("/app/settings/apex-pay",{replace:!0})}finally{p(!1)}},I=async()=>{try{p(!0),i(null);const r=await l.getOAuthUrl();r.url&&(window.location.href=r.url)}catch(r){i(r.message||"Failed to start connection"),p(!1)}},R=async()=>{if(confirm("Are you sure you want to disconnect your Stripe account? You will no longer be able to accept payments."))try{C(!0),await l.disconnect(),u(null),j(!1)}catch(r){i(r.message||"Failed to disconnect")}finally{C(!1)}},D=async()=>{try{await l.acceptCompliance(),j(!0),t&&u({...t,complianceAcceptedAt:new Date().toISOString()})}catch(r){i(r.message||"Failed to accept compliance terms")}},E=async()=>{try{await l.updateSettings(a),v(!0),setTimeout(()=>v(!1),3e3)}catch(r){i(r.message||"Failed to save settings")}};return B?e.jsx("div",{className:s.settingsPage,children:e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"50vh"},children:e.jsx(m,{size:32,style:{animation:"spin 1s linear infinite",color:"var(--gold-primary)"}})})}):e.jsxs("div",{className:s.settingsPage,children:[e.jsxs("button",{className:s.backButton,onClick:()=>o("/app/apex-pay"),children:[e.jsx(F,{size:16}),"Back to Apex Pay"]}),e.jsxs("div",{className:s.header,children:[e.jsx("h1",{children:"Apex Pay Configuration"}),e.jsx("p",{children:"Connect your Stripe account to start accepting payments from clients"})]}),e.jsx("div",{className:s.settingsContent,style:{maxWidth:"900px"},children:e.jsxs("div",{className:s.tabContent,children:[k&&e.jsxs("div",{style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"var(--radius-md)",padding:"var(--spacing-md)",marginBottom:"var(--spacing-lg)",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(N,{size:20,style:{color:"#ef4444",flexShrink:0}}),e.jsx("span",{style:{color:"var(--text-primary)",flex:1},children:k}),e.jsx("button",{onClick:()=>i(null),style:{background:"none",border:"none",color:"#ef4444",cursor:"pointer"},children:e.jsx(N,{size:16})})]}),e.jsxs("div",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx(G,{size:20}),e.jsxs("div",{children:[e.jsx("h2",{children:"What is Apex Pay?"}),e.jsx("p",{children:"Understanding how payments work in Apex"})]})]}),e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.05))",border:"1px solid rgba(99, 102, 241, 0.2)",borderRadius:"var(--radius-lg)",padding:"var(--spacing-lg)",marginBottom:"var(--spacing-lg)"},children:[e.jsxs("p",{style:{color:"var(--text-primary)",marginBottom:"1rem",lineHeight:1.7},children:[e.jsx("strong",{children:"Apex Pay"})," lets your clients pay invoices online securely. Simply connect your Stripe account (or create one) and you're ready to accept payments."]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem"},children:[e.jsx(O,{size:18,style:{color:"#6366f1",flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"var(--text-primary)",fontSize:"0.875rem"},children:"PCI Compliant"}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.8125rem",margin:0},children:"Card data never touches your servers"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem"},children:[e.jsx(z,{size:18,style:{color:"#6366f1",flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"var(--text-primary)",fontSize:"0.875rem"},children:"Trust Account Ready"}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.8125rem",margin:0},children:"Route funds to operating or trust accounts"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem"},children:[e.jsx(x,{size:18,style:{color:"#6366f1",flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"var(--text-primary)",fontSize:"0.875rem"},children:"Multiple Methods"}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.8125rem",margin:0},children:"Cards, ACH, Apple Pay, Google Pay"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem"},children:[e.jsx(Y,{size:18,style:{color:"#6366f1",flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"var(--text-primary)",fontSize:"0.875rem"},children:"Competitive Rates"}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.8125rem",margin:0},children:"2.9% + $0.30 for cards, 0.8% for ACH"})]})]})]})]})]}),e.jsxs("div",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx(x,{size:20}),e.jsxs("div",{children:[e.jsx("h2",{children:"Stripe Connection"}),e.jsx("p",{children:"Connect your Stripe account to accept payments"})]})]}),h?e.jsxs("div",{style:{background:"rgba(99, 102, 241, 0.1)",border:"1px solid rgba(99, 102, 241, 0.3)",borderRadius:"var(--radius-md)",padding:"var(--spacing-xl)",textAlign:"center"},children:[e.jsx(m,{size:32,style:{animation:"spin 1s linear infinite",color:"#6366f1",marginBottom:"1rem"}}),e.jsx("p",{style:{color:"var(--text-primary)",margin:0},children:"Connecting to Stripe..."})]}):t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"var(--radius-md)",padding:"var(--spacing-lg)",marginBottom:"var(--spacing-lg)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(M,{size:24,style:{color:"#10b981"}}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"var(--text-primary)",display:"block"},children:"Connected to Stripe"}),e.jsxs("span",{style:{color:"var(--text-secondary)",fontSize:"0.875rem"},children:[t.businessName," (",t.email,")"]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("a",{href:"https://dashboard.stripe.com",target:"_blank",rel:"noopener noreferrer",className:s.secondaryBtn,children:[e.jsx($,{size:16}),"Stripe Dashboard"]}),e.jsxs("button",{className:s.secondaryBtn,onClick:R,disabled:S,style:{color:"#ef4444"},children:[S?e.jsx(m,{size:16,style:{animation:"spin 1s linear infinite"}}):e.jsx(U,{size:16}),"Disconnect"]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"1rem",flexWrap:"wrap"},children:[e.jsx("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"999px",fontSize:"0.75rem",fontWeight:500,background:t.chargesEnabled?"rgba(16, 185, 129, 0.15)":"rgba(245, 158, 11, 0.15)",color:t.chargesEnabled?"#10b981":"var(--gold-primary)"},children:t.chargesEnabled?"✓ Charges Enabled":"⏳ Charges Pending"}),e.jsx("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"999px",fontSize:"0.75rem",fontWeight:500,background:t.payoutsEnabled?"rgba(16, 185, 129, 0.15)":"rgba(245, 158, 11, 0.15)",color:t.payoutsEnabled?"#10b981":"var(--gold-primary)"},children:t.payoutsEnabled?"✓ Payouts Enabled":"⏳ Payouts Pending"})]})]}),!y&&e.jsxs("div",{style:{background:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.3)",borderRadius:"var(--radius-md)",padding:"var(--spacing-lg)",marginBottom:"var(--spacing-lg)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",marginBottom:"1rem"},children:[e.jsx(w,{size:20,style:{color:"var(--gold-primary)",flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"var(--text-primary)"},children:"Accept Compliance Terms"}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.875rem",margin:"0.25rem 0 0 0"},children:"Before accepting payments, please acknowledge your compliance responsibilities."})]})]}),e.jsxs("div",{style:{background:"var(--bg-tertiary)",borderRadius:"var(--radius-md)",padding:"var(--spacing-md)",marginBottom:"1rem",fontSize:"0.8125rem",color:"var(--text-secondary)",lineHeight:1.7},children:[e.jsx("p",{style:{margin:"0 0 0.75rem 0"},children:'By clicking "I Accept" below, you acknowledge that:'}),e.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem"},children:[e.jsx("li",{children:"You are responsible for compliance with your jurisdiction's bar rules regarding client funds"}),e.jsx("li",{children:"Client trust funds must be properly segregated and handled according to IOLTA/trust account rules"}),e.jsx("li",{children:"Apex provides tools to help with compliance but does not guarantee compliance"}),e.jsx("li",{children:"You have read and agree to Stripe's terms of service"})]})]}),e.jsxs("button",{onClick:D,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1.5rem",background:"linear-gradient(135deg, #6366f1, #8b5cf6)",border:"none",borderRadius:"var(--radius-md)",color:"white",fontSize:"0.9375rem",fontWeight:600,cursor:"pointer"},children:[e.jsx(P,{size:18}),"I Accept These Terms"]})]})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{style:{background:"rgba(99, 102, 241, 0.05)",border:"1px solid rgba(99, 102, 241, 0.2)",borderRadius:"var(--radius-lg)",padding:"var(--spacing-xl)",textAlign:"center",marginBottom:"var(--spacing-lg)"},children:[e.jsx("div",{style:{width:"64px",height:"64px",margin:"0 auto 1rem",background:"linear-gradient(135deg, #6366f1, #8b5cf6)",borderRadius:"16px",display:"flex",alignItems:"center",justifyContent:"center",color:"white"},children:e.jsx(x,{size:32})}),e.jsx("h3",{style:{color:"var(--text-primary)",margin:"0 0 0.5rem 0",fontSize:"1.25rem"},children:"Connect Your Stripe Account"}),e.jsx("p",{style:{color:"var(--text-secondary)",margin:"0 0 1.5rem 0",maxWidth:"400px",marginLeft:"auto",marginRight:"auto"},children:"Sign in to your existing Stripe account or create a new one. You'll be redirected to Stripe to authorize the connection."}),e.jsxs("button",{onClick:I,disabled:h,style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.875rem 2rem",background:"linear-gradient(135deg, #6366f1, #8b5cf6)",border:"none",borderRadius:"var(--radius-md)",color:"white",fontSize:"1rem",fontWeight:600,cursor:"pointer",boxShadow:"0 4px 15px rgba(99, 102, 241, 0.3)"},children:[h?e.jsx(m,{size:20,style:{animation:"spin 1s linear infinite"}}):e.jsx(x,{size:20}),"Connect with Stripe"]}),e.jsxs("p",{style:{color:"var(--text-tertiary)",fontSize:"0.75rem",marginTop:"1rem"},children:[e.jsx(Z,{size:12,style:{display:"inline",marginRight:"0.25rem"}}),"Secure connection powered by Stripe Connect"]})]})})]}),t&&y&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx(_,{size:20}),e.jsxs("div",{children:[e.jsx("h2",{children:"Payment Methods"}),e.jsx("p",{children:"Choose which payment methods to accept"})]})]}),e.jsxs("div",{className:s.toggleGroup,children:[e.jsxs("div",{className:s.toggle,children:[e.jsxs("div",{children:[e.jsx("span",{className:s.toggleLabel,children:"Credit & Debit Cards"}),e.jsx("span",{className:s.toggleDesc,children:"Visa, Mastercard, American Express, Discover (2.9% + $0.30)"})]}),e.jsxs("label",{className:s.switch,children:[e.jsx("input",{type:"checkbox",checked:a.acceptCards,onChange:r=>c({...a,acceptCards:r.target.checked})}),e.jsx("span",{className:s.slider})]})]}),e.jsxs("div",{className:s.toggle,children:[e.jsxs("div",{children:[e.jsx("span",{className:s.toggleLabel,children:"ACH Bank Transfers"}),e.jsx("span",{className:s.toggleDesc,children:"Direct bank transfers - lower fees (0.8%, max $5)"})]}),e.jsxs("label",{className:s.switch,children:[e.jsx("input",{type:"checkbox",checked:a.acceptAch,onChange:r=>c({...a,acceptAch:r.target.checked})}),e.jsx("span",{className:s.slider})]})]}),e.jsxs("div",{className:s.toggle,children:[e.jsxs("div",{children:[e.jsx("span",{className:s.toggleLabel,children:"Apple Pay"}),e.jsx("span",{className:s.toggleDesc,children:"Accept payments from Apple Pay wallets"})]}),e.jsxs("label",{className:s.switch,children:[e.jsx("input",{type:"checkbox",checked:a.acceptApplePay,onChange:r=>c({...a,acceptApplePay:r.target.checked})}),e.jsx("span",{className:s.slider})]})]}),e.jsxs("div",{className:s.toggle,children:[e.jsxs("div",{children:[e.jsx("span",{className:s.toggleLabel,children:"Google Pay"}),e.jsx("span",{className:s.toggleDesc,children:"Accept payments from Google Pay wallets"})]}),e.jsxs("label",{className:s.switch,children:[e.jsx("input",{type:"checkbox",checked:a.acceptGooglePay,onChange:r=>c({...a,acceptGooglePay:r.target.checked})}),e.jsx("span",{className:s.slider})]})]})]})]}),e.jsxs("div",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx(z,{size:20}),e.jsxs("div",{children:[e.jsx("h2",{children:"Trust Account Routing"}),e.jsx("p",{children:"Configure how payments are routed to operating vs trust accounts"})]})]}),e.jsxs("div",{style:{background:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.3)",borderRadius:"var(--radius-md)",padding:"var(--spacing-md)",marginBottom:"var(--spacing-lg)",display:"flex",alignItems:"flex-start",gap:"0.75rem"},children:[e.jsx(w,{size:18,style:{color:"var(--gold-primary)",flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{style:{fontSize:"0.875rem"},children:[e.jsx("strong",{style:{color:"var(--text-primary)"},children:"Important for Bar Compliance"}),e.jsx("p",{style:{color:"var(--text-secondary)",margin:"0.25rem 0 0 0"},children:"Most state bar rules require client funds to be deposited into an IOLTA trust account. You are responsible for proper fund handling."})]})]}),e.jsxs("div",{className:s.toggle,style:{marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("span",{className:s.toggleLabel,children:"Default to Trust Account"}),e.jsx("span",{className:s.toggleDesc,children:"New payments default to trust account (safer for compliance)"})]}),e.jsxs("label",{className:s.switch,children:[e.jsx("input",{type:"checkbox",checked:a.defaultToTrust,onChange:r=>c({...a,defaultToTrust:r.target.checked})}),e.jsx("span",{className:s.slider})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginTop:"var(--spacing-md)"},children:[e.jsxs("div",{className:s.formGroup,style:{margin:0},children:[e.jsx("label",{children:"Trust Account Label"}),e.jsx("input",{type:"text",value:a.trustAccountLabel,onChange:r=>c({...a,trustAccountLabel:r.target.value})})]}),e.jsxs("div",{className:s.formGroup,style:{margin:0},children:[e.jsx("label",{children:"Operating Account Label"}),e.jsx("input",{type:"text",value:a.operatingAccountLabel,onChange:r=>c({...a,operatingAccountLabel:r.target.value})})]})]})]})]}),e.jsxs("div",{className:s.section,style:{borderBottom:"none"},children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx(q,{size:20}),e.jsxs("div",{children:[e.jsx("h2",{children:"Compliance & Legal Disclosures"}),e.jsx("p",{children:"Important information about payment processing"})]})]}),e.jsxs("div",{style:{background:"var(--bg-tertiary)",borderRadius:"var(--radius-lg)",padding:"var(--spacing-lg)",marginBottom:"var(--spacing-lg)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 1rem 0"},children:"Payment Processing Disclosure"}),e.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",lineHeight:1.7},children:[e.jsxs("p",{style:{marginBottom:"1rem"},children:["Payment processing services for Apex Pay are provided by ",e.jsx("strong",{children:"Stripe, Inc."}),` ("Stripe"). By using Apex Pay, you agree to be bound by Stripe's`," ",e.jsx("a",{href:"https://stripe.com/legal/connect-account",target:"_blank",rel:"noopener noreferrer",style:{color:"#6366f1"},children:"Connected Account Agreement"}),"."]}),e.jsxs("p",{style:{marginBottom:"1rem"},children:[e.jsx("strong",{children:"Fee Disclosure:"})," Standard processing fees are 2.9% + $0.30 per successful card transaction and 0.8% (capped at $5.00) per ACH transaction."]}),e.jsxs("p",{style:{marginBottom:0},children:[e.jsx("strong",{children:"Your Responsibility:"})," You are solely responsible for compliance with your jurisdiction's rules of professional conduct regarding client funds, trust accounts, and fee handling."]})]})]}),e.jsxs("div",{style:{background:"var(--bg-tertiary)",borderRadius:"var(--radius-lg)",padding:"var(--spacing-lg)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 1rem 0"},children:"Data Security & Privacy"}),e.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",lineHeight:1.7},children:[e.jsxs("p",{style:{marginBottom:"1rem"},children:[e.jsx("strong",{children:"PCI DSS Compliance:"})," Stripe is a certified PCI Level 1 Service Provider. All card data is encrypted and processed on Stripe's secure servers."]}),e.jsxs("p",{style:{marginBottom:0},children:[e.jsx("strong",{children:"Data Handling:"})," Apex does not store credit card numbers or bank account credentials. We only store transaction references for record-keeping."]})]})]})]}),t&&y&&e.jsxs("div",{className:s.saveBar,children:[T&&e.jsxs("span",{className:s.savedMessage,children:[e.jsx(P,{size:16}),"Settings saved successfully!"]}),e.jsx("button",{className:s.saveBtn,onClick:E,children:"Save Changes"})]})]})}),e.jsx("style",{children:`
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      `})]})}export{te as ApexPaySettingsPage};
